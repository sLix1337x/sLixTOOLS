var He=Object.defineProperty;var Ae=ot=>{throw TypeError(ot)};var qe=(ot,m,Q)=>m in ot?He(ot,m,{enumerable:!0,configurable:!0,writable:!0,value:Q}):ot[m]=Q;var St=(ot,m,Q)=>qe(ot,typeof m!="symbol"?m+"":m,Q),Qt=(ot,m,Q)=>m.has(ot)||Ae("Cannot "+Q);var _=(ot,m,Q)=>(Qt(ot,m,"read from private field"),Q?Q.call(ot):m.get(ot)),ut=(ot,m,Q)=>m.has(ot)?Ae("Cannot add the same private member more than once"):m instanceof WeakSet?m.add(ot):m.set(ot,Q),pt=(ot,m,Q,b)=>(Qt(ot,m,"write to private field"),b?b.call(ot,Q):m.set(ot,Q),Q),lt=(ot,m,Q)=>(Qt(ot,m,"access private method"),Q);var Zt=(ot,m,Q,b)=>({set _(w){pt(ot,m,w,Q)},get _(){return _(ot,m,b)}});import{g as getAugmentedNamespace,a as getDefaultExportFromCjs}from"./index-DOphOOpp.js";import{c as commonjsRequire}from"./_commonjs-dynamic-modules-TDtrdbi3.js";function _mergeNamespaces(ot,m){for(var Q=0;Q<m.length;Q++){const b=m[Q];if(typeof b!="string"&&!Array.isArray(b)){for(const w in b)if(w!=="default"&&!(w in ot)){const Y=Object.getOwnPropertyDescriptor(b,w);Y&&Object.defineProperty(ot,w,Y.get?Y:{enumerable:!0,get:()=>b[w]})}}}return Object.freeze(Object.defineProperty(ot,Symbol.toStringTag,{value:"Module"}))}var pdf$2={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports){(function(m,Q){module.exports=Q()})(globalThis,()=>(()=>{var __webpack_modules__=[,(ot,m)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.VerbosityLevel=m.Util=m.UnknownErrorException=m.UnexpectedResponseException=m.UNSUPPORTED_FEATURES=m.TextRenderingMode=m.RenderingIntentFlag=m.PermissionFlag=m.PasswordResponses=m.PasswordException=m.PageActionEventType=m.OPS=m.MissingPDFException=m.LINE_FACTOR=m.LINE_DESCENT_FACTOR=m.InvalidPDFException=m.ImageKind=m.IDENTITY_MATRIX=m.FormatError=m.FeatureTest=m.FONT_IDENTITY_MATRIX=m.DocumentActionEventType=m.CMapCompressionType=m.BaseException=m.BASELINE_FACTOR=m.AnnotationType=m.AnnotationStateModelType=m.AnnotationReviewState=m.AnnotationReplyType=m.AnnotationMode=m.AnnotationMarkedState=m.AnnotationFlag=m.AnnotationFieldFlag=m.AnnotationEditorType=m.AnnotationEditorPrefix=m.AnnotationEditorParamsType=m.AnnotationBorderStyleType=m.AnnotationActionEventType=m.AbortException=void 0,m.assert=M,m.bytesToString=l,m.createPromiseCapability=vt,m.createValidAbsoluteUrl=o,m.getModificationDate=yt,m.getVerbosityLevel=H,m.info=G,m.isArrayBuffer=bt,m.isArrayEqual=_t,m.objectFromMap=F,m.objectSize=d,m.setVerbosityLevel=K,m.shadow=v,m.string32=C,m.stringToBytes=E,m.stringToPDFString=it,m.stringToUTF8String=dt,m.unreachable=ht,m.utf8StringToString=ft,m.warn=st;const Q=[1,0,0,1,0,0];m.IDENTITY_MATRIX=Q;const b=[.001,0,0,.001,0,0];m.FONT_IDENTITY_MATRIX=b;const w=1.35;m.LINE_FACTOR=w;const Y=.35;m.LINE_DESCENT_FACTOR=Y;const z=Y/w;m.BASELINE_FACTOR=z;const et={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};m.RenderingIntentFlag=et;const B={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};m.AnnotationMode=B;const S="pdfjs_internal_editor_";m.AnnotationEditorPrefix=S;const P={DISABLE:-1,NONE:0,FREETEXT:3,INK:15};m.AnnotationEditorType=P;const L={FREETEXT_SIZE:1,FREETEXT_COLOR:2,FREETEXT_OPACITY:3,INK_COLOR:11,INK_THICKNESS:12,INK_OPACITY:13};m.AnnotationEditorParamsType=L;const T={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};m.PermissionFlag=T;const A={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};m.TextRenderingMode=A;const g={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};m.ImageKind=g;const f={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};m.AnnotationType=f;const r={MARKED:"Marked",REVIEW:"Review"};m.AnnotationStateModelType=r;const c={MARKED:"Marked",UNMARKED:"Unmarked"};m.AnnotationMarkedState=c;const u={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"};m.AnnotationReviewState=u;const i={GROUP:"Group",REPLY:"R"};m.AnnotationReplyType=i;const n={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};m.AnnotationFlag=n;const t={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};m.AnnotationFieldFlag=t;const s={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};m.AnnotationBorderStyleType=s;const p={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};m.AnnotationActionEventType=p;const e={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};m.DocumentActionEventType=e;const y={O:"PageOpen",C:"PageClose"};m.PageActionEventType=y;const O={ERRORS:0,WARNINGS:1,INFOS:5};m.VerbosityLevel=O;const W={NONE:0,BINARY:1};m.CMapCompressionType=W;const tt={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};m.OPS=tt;const gt={forms:"forms",javaScript:"javaScript",signatures:"signatures",smask:"smask",shadingPattern:"shadingPattern",errorTilingPattern:"errorTilingPattern",errorExtGState:"errorExtGState",errorXObject:"errorXObject",errorFontLoadType3:"errorFontLoadType3",errorFontState:"errorFontState",errorFontMissing:"errorFontMissing",errorFontTranslate:"errorFontTranslate",errorColorSpace:"errorColorSpace",errorOperatorList:"errorOperatorList",errorFontToUnicode:"errorFontToUnicode",errorFontLoadNative:"errorFontLoadNative",errorFontBuildPath:"errorFontBuildPath",errorFontGetPath:"errorFontGetPath",errorMarkedContent:"errorMarkedContent",errorContentSubStream:"errorContentSubStream"};m.UNSUPPORTED_FEATURES=gt;const rt={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};m.PasswordResponses=rt;let ct=O.WARNINGS;function K(at){Number.isInteger(at)&&(ct=at)}function H(){return ct}function G(at){ct>=O.INFOS&&console.log(`Info: ${at}`)}function st(at){ct>=O.WARNINGS&&console.log(`Warning: ${at}`)}function ht(at){throw new Error(at)}function M(at,V){at||ht(V)}function h(at){if(!at)return!1;switch(at.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function o(at,V=null,X=null){if(!at)return null;try{if(X&&typeof at=="string"){if(X.addDefaultProtocol&&at.startsWith("www.")){const At=at.match(/\./g);At&&At.length>=2&&(at=`http://${at}`)}if(X.tryConvertEncoding)try{at=dt(at)}catch{}}const mt=V?new URL(at,V):new URL(at);if(h(mt))return mt}catch{}return null}function v(at,V,X,mt=!1){return Object.defineProperty(at,V,{value:X,enumerable:!mt,configurable:!0,writable:!1}),X}const R=function(){function V(X,mt){this.constructor===V&&ht("Cannot initialize BaseException."),this.message=X,this.name=mt}return V.prototype=new Error,V.constructor=V,V}();m.BaseException=R;class D extends R{constructor(V,X){super(V,"PasswordException"),this.code=X}}m.PasswordException=D;class k extends R{constructor(V,X){super(V,"UnknownErrorException"),this.details=X}}m.UnknownErrorException=k;class q extends R{constructor(V){super(V,"InvalidPDFException")}}m.InvalidPDFException=q;class J extends R{constructor(V){super(V,"MissingPDFException")}}m.MissingPDFException=J;class nt extends R{constructor(V,X){super(V,"UnexpectedResponseException"),this.status=X}}m.UnexpectedResponseException=nt;class $ extends R{constructor(V){super(V,"FormatError")}}m.FormatError=$;class a extends R{constructor(V){super(V,"AbortException")}}m.AbortException=a;function l(at){(typeof at!="object"||at===null||at.length===void 0)&&ht("Invalid argument for bytesToString");const V=at.length,X=8192;if(V<X)return String.fromCharCode.apply(null,at);const mt=[];for(let At=0;At<V;At+=X){const Et=Math.min(At+X,V),Ct=at.subarray(At,Et);mt.push(String.fromCharCode.apply(null,Ct))}return mt.join("")}function E(at){typeof at!="string"&&ht("Invalid argument for stringToBytes");const V=at.length,X=new Uint8Array(V);for(let mt=0;mt<V;++mt)X[mt]=at.charCodeAt(mt)&255;return X}function C(at){return String.fromCharCode(at>>24&255,at>>16&255,at>>8&255,at&255)}function d(at){return Object.keys(at).length}function F(at){const V=Object.create(null);for(const[X,mt]of at)V[X]=mt;return V}function N(){const at=new Uint8Array(4);return at[0]=1,new Uint32Array(at.buffer,0,1)[0]===1}function j(){try{return new Function(""),!0}catch{return!1}}class Z{static get isLittleEndian(){return v(this,"isLittleEndian",N())}static get isEvalSupported(){return v(this,"isEvalSupported",j())}static get isOffscreenCanvasSupported(){return v(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?v(this,"platform",{isWin:!1,isMac:!1}):v(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}}m.FeatureTest=Z;const x=[...Array(256).keys()].map(at=>at.toString(16).padStart(2,"0"));class U{static makeHexColor(V,X,mt){return`#${x[V]}${x[X]}${x[mt]}`}static scaleMinMax(V,X){let mt;V[0]?(V[0]<0&&(mt=X[0],X[0]=X[1],X[1]=mt),X[0]*=V[0],X[1]*=V[0],V[3]<0&&(mt=X[2],X[2]=X[3],X[3]=mt),X[2]*=V[3],X[3]*=V[3]):(mt=X[0],X[0]=X[2],X[2]=mt,mt=X[1],X[1]=X[3],X[3]=mt,V[1]<0&&(mt=X[2],X[2]=X[3],X[3]=mt),X[2]*=V[1],X[3]*=V[1],V[2]<0&&(mt=X[0],X[0]=X[1],X[1]=mt),X[0]*=V[2],X[1]*=V[2]),X[0]+=V[4],X[1]+=V[4],X[2]+=V[5],X[3]+=V[5]}static transform(V,X){return[V[0]*X[0]+V[2]*X[1],V[1]*X[0]+V[3]*X[1],V[0]*X[2]+V[2]*X[3],V[1]*X[2]+V[3]*X[3],V[0]*X[4]+V[2]*X[5]+V[4],V[1]*X[4]+V[3]*X[5]+V[5]]}static applyTransform(V,X){const mt=V[0]*X[0]+V[1]*X[2]+X[4],At=V[0]*X[1]+V[1]*X[3]+X[5];return[mt,At]}static applyInverseTransform(V,X){const mt=X[0]*X[3]-X[1]*X[2],At=(V[0]*X[3]-V[1]*X[2]+X[2]*X[5]-X[4]*X[3])/mt,Et=(-V[0]*X[1]+V[1]*X[0]+X[4]*X[1]-X[5]*X[0])/mt;return[At,Et]}static getAxialAlignedBoundingBox(V,X){const mt=U.applyTransform(V,X),At=U.applyTransform(V.slice(2,4),X),Et=U.applyTransform([V[0],V[3]],X),Ct=U.applyTransform([V[2],V[1]],X);return[Math.min(mt[0],At[0],Et[0],Ct[0]),Math.min(mt[1],At[1],Et[1],Ct[1]),Math.max(mt[0],At[0],Et[0],Ct[0]),Math.max(mt[1],At[1],Et[1],Ct[1])]}static inverseTransform(V){const X=V[0]*V[3]-V[1]*V[2];return[V[3]/X,-V[1]/X,-V[2]/X,V[0]/X,(V[2]*V[5]-V[4]*V[3])/X,(V[4]*V[1]-V[5]*V[0])/X]}static singularValueDecompose2dScale(V){const X=[V[0],V[2],V[1],V[3]],mt=V[0]*X[0]+V[1]*X[2],At=V[0]*X[1]+V[1]*X[3],Et=V[2]*X[0]+V[3]*X[2],Ct=V[2]*X[1]+V[3]*X[3],kt=(mt+Ct)/2,Rt=Math.sqrt((mt+Ct)**2-4*(mt*Ct-Et*At))/2,Ft=kt+Rt||1,Pt=kt-Rt||1;return[Math.sqrt(Ft),Math.sqrt(Pt)]}static normalizeRect(V){const X=V.slice(0);return V[0]>V[2]&&(X[0]=V[2],X[2]=V[0]),V[1]>V[3]&&(X[1]=V[3],X[3]=V[1]),X}static intersect(V,X){const mt=Math.max(Math.min(V[0],V[2]),Math.min(X[0],X[2])),At=Math.min(Math.max(V[0],V[2]),Math.max(X[0],X[2]));if(mt>At)return null;const Et=Math.max(Math.min(V[1],V[3]),Math.min(X[1],X[3])),Ct=Math.min(Math.max(V[1],V[3]),Math.max(X[1],X[3]));return Et>Ct?null:[mt,Et,At,Ct]}static bezierBoundingBox(V,X,mt,At,Et,Ct,kt,Rt){const Ft=[],Pt=[[],[]];let It,Dt,Ht,Tt,qt,Gt,Yt,Kt;for(let Jt=0;Jt<2;++Jt){if(Jt===0?(Dt=6*V-12*mt+6*Et,It=-3*V+9*mt-9*Et+3*kt,Ht=3*mt-3*V):(Dt=6*X-12*At+6*Ct,It=-3*X+9*At-9*Ct+3*Rt,Ht=3*At-3*X),Math.abs(It)<1e-12){if(Math.abs(Dt)<1e-12)continue;Tt=-Ht/Dt,0<Tt&&Tt<1&&Ft.push(Tt);continue}Yt=Dt*Dt-4*Ht*It,Kt=Math.sqrt(Yt),!(Yt<0)&&(qt=(-Dt+Kt)/(2*It),0<qt&&qt<1&&Ft.push(qt),Gt=(-Dt-Kt)/(2*It),0<Gt&&Gt<1&&Ft.push(Gt))}let Ut=Ft.length,xt;const jt=Ut;for(;Ut--;)Tt=Ft[Ut],xt=1-Tt,Pt[0][Ut]=xt*xt*xt*V+3*xt*xt*Tt*mt+3*xt*Tt*Tt*Et+Tt*Tt*Tt*kt,Pt[1][Ut]=xt*xt*xt*X+3*xt*xt*Tt*At+3*xt*Tt*Tt*Ct+Tt*Tt*Tt*Rt;return Pt[0][jt]=V,Pt[1][jt]=X,Pt[0][jt+1]=kt,Pt[1][jt+1]=Rt,Pt[0].length=Pt[1].length=jt+2,[Math.min(...Pt[0]),Math.min(...Pt[1]),Math.max(...Pt[0]),Math.max(...Pt[1])]}}m.Util=U;const I=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function it(at){if(at[0]>="ï"){let X;if(at[0]==="þ"&&at[1]==="ÿ"?X="utf-16be":at[0]==="ÿ"&&at[1]==="þ"?X="utf-16le":at[0]==="ï"&&at[1]==="»"&&at[2]==="¿"&&(X="utf-8"),X)try{const mt=new TextDecoder(X,{fatal:!0}),At=E(at);return mt.decode(At)}catch(mt){st(`stringToPDFString: "${mt}".`)}}const V=[];for(let X=0,mt=at.length;X<mt;X++){const At=I[at.charCodeAt(X)];V.push(At?String.fromCharCode(At):at.charAt(X))}return V.join("")}function dt(at){return decodeURIComponent(escape(at))}function ft(at){return unescape(encodeURIComponent(at))}function bt(at){return typeof at=="object"&&at!==null&&at.byteLength!==void 0}function _t(at,V){if(at.length!==V.length)return!1;for(let X=0,mt=at.length;X<mt;X++)if(at[X]!==V[X])return!1;return!0}function yt(at=new Date){return[at.getUTCFullYear().toString(),(at.getUTCMonth()+1).toString().padStart(2,"0"),at.getUTCDate().toString().padStart(2,"0"),at.getUTCHours().toString().padStart(2,"0"),at.getUTCMinutes().toString().padStart(2,"0"),at.getUTCSeconds().toString().padStart(2,"0")].join("")}function vt(){const at=Object.create(null);let V=!1;return Object.defineProperty(at,"settled",{get(){return V}}),at.promise=new Promise(function(X,mt){at.resolve=function(At){V=!0,X(At)},at.reject=function(At){V=!0,mt(At)}}),at}},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var ot,m,b,w,Y,z,et,B,S,P,te,T,A,ee,f,r;Object.defineProperty(exports,"__esModule",{value:!0}),exports.build=exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_is_node=__w_pdfjs_require__(10),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_xfa_text=__w_pdfjs_require__(19);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100;let DefaultCanvasFactory=_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;let DefaultCMapReaderFactory=_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;let DefaultStandardFontDataFactory=_display_utils.DOMStandardFontDataFactory;if(exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory,_is_node.isNodeJS){const{NodeCanvasFactory:u,NodeCMapReaderFactory:i,NodeStandardFontDataFactory:n}=__w_pdfjs_require__(20);exports.DefaultCanvasFactory=DefaultCanvasFactory=u,exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory=i,exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory=n}let createPDFNetworkStream;if(_is_node.isNodeJS){const{PDFNodeStream:u}=__w_pdfjs_require__(21);createPDFNetworkStream=i=>new u(i)}else{const{PDFNetworkStream:u}=__w_pdfjs_require__(24),{PDFFetchStream:i}=__w_pdfjs_require__(25);createPDFNetworkStream=n=>(0,_display_utils.isValidFetchUrl)(n.url)?new i(n):new u(n)}function getDocument(u){if(typeof u=="string"||u instanceof URL)u={url:u};else if((0,_util.isArrayBuffer)(u))u={data:u};else if(u instanceof PDFDataRangeTransport)(0,_display_utils.deprecated)("`PDFDataRangeTransport`-instance, please use a parameter object with `range`-property instead."),u={range:u};else if(typeof u!="object")throw new Error("Invalid parameter in getDocument, need either string, URL, TypedArray, or parameter object.");if(!u.url&&!u.data&&!u.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const i=new PDFDocumentLoadingTask,n=u.url?getUrlProp(u.url):null,t=u.data?getDataProp(u.data):null,s=u.httpHeaders||null,p=u.withCredentials===!0,e=u.password??null,y=u.range instanceof PDFDataRangeTransport?u.range:null,O=Number.isInteger(u.rangeChunkSize)&&u.rangeChunkSize>0?u.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let W=u.worker instanceof PDFWorker?u.worker:null;const tt=u.verbosity,gt=typeof u.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(u.docBaseUrl)?u.docBaseUrl:null,rt=typeof u.cMapUrl=="string"?u.cMapUrl:null,ct=u.cMapPacked!==!1,K=u.CMapReaderFactory||DefaultCMapReaderFactory,H=typeof u.standardFontDataUrl=="string"?u.standardFontDataUrl:null,G=u.StandardFontDataFactory||DefaultStandardFontDataFactory,st=u.stopAtErrors!==!0,ht=Number.isInteger(u.maxImageSize)&&u.maxImageSize>-1?u.maxImageSize:-1,M=u.isEvalSupported!==!1,h=typeof u.isOffscreenCanvasSupported=="boolean"?u.isOffscreenCanvasSupported:!_is_node.isNodeJS,o=typeof u.disableFontFace=="boolean"?u.disableFontFace:_is_node.isNodeJS,v=u.fontExtraProperties===!0,R=u.enableXfa===!0,D=u.ownerDocument||globalThis.document,k=u.disableRange===!0,q=u.disableStream===!0,J=u.disableAutoFetch===!0,nt=u.pdfBug===!0,$=y?y.length:u.length??NaN,a=typeof u.useSystemFonts=="boolean"?u.useSystemFonts:!_is_node.isNodeJS&&!o,l=typeof u.useWorkerFetch=="boolean"?u.useWorkerFetch:K===_display_utils.DOMCMapReaderFactory&&G===_display_utils.DOMStandardFontDataFactory&&(0,_display_utils.isValidFetchUrl)(rt,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(H,document.baseURI),E=null;(0,_util.setVerbosityLevel)(tt);const C=l?null:{cMapReaderFactory:new K({baseUrl:rt,isCompressed:ct}),standardFontDataFactory:new G({baseUrl:H})};if(!W){const j={verbosity:tt,port:_worker_options.GlobalWorkerOptions.workerPort};W=j.port?PDFWorker.fromPort(j):new PDFWorker(j),i._worker=W}const d=i.docId,F={docId:d,apiVersion:"3.4.120",data:t,password:e,disableAutoFetch:J,rangeChunkSize:O,length:$,docBaseUrl:gt,enableXfa:R,evaluatorOptions:{maxImageSize:ht,disableFontFace:o,ignoreErrors:st,isEvalSupported:M,isOffscreenCanvasSupported:h,fontExtraProperties:v,useSystemFonts:a,cMapUrl:l?rt:null,standardFontDataUrl:l?H:null}},N={ignoreErrors:st,isEvalSupported:M,disableFontFace:o,fontExtraProperties:v,enableXfa:R,ownerDocument:D,disableAutoFetch:J,pdfBug:nt,styleElement:E};return W.promise.then(function(){if(i.destroyed)throw new Error("Loading aborted");const j=_fetchDocument(W,F),Z=new Promise(function(x){let U;y?U=new _transport_stream.PDFDataTransportStream({length:$,initialData:y.initialData,progressiveDone:y.progressiveDone,contentDispositionFilename:y.contentDispositionFilename,disableRange:k,disableStream:q},y):t||(U=createPDFNetworkStream({url:n,length:$,httpHeaders:s,withCredentials:p,rangeChunkSize:O,disableRange:k,disableStream:q})),x(U)});return Promise.all([j,Z]).then(function([x,U]){if(i.destroyed)throw new Error("Loading aborted");const I=new _message_handler.MessageHandler(d,x,W.port),it=new WorkerTransport(I,i,U,N,C);i._transport=it,I.send("Ready",null)})}).catch(i._capability.reject),i}async function _fetchDocument(u,i){if(u.destroyed)throw new Error("Worker was destroyed");const n=await u.messageHandler.sendWithPromise("GetDocRequest",i,i.data?[i.data.buffer]:null);if(u.destroyed)throw new Error("Worker was destroyed");return n}function getUrlProp(u){if(u instanceof URL)return u.href;try{return new URL(u,window.location).href}catch{if(_is_node.isNodeJS&&typeof u=="string")return u}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(u){if(_is_node.isNodeJS&&typeof Buffer<"u"&&u instanceof Buffer)return(0,_display_utils.deprecated)("Please provide binary data as `Uint8Array`, rather than `Buffer`."),new Uint8Array(u);if(u instanceof Uint8Array&&u.byteLength===u.buffer.byteLength)return u;if(typeof u=="string")return(0,_util.stringToBytes)(u);if(typeof u=="object"&&!isNaN(u==null?void 0:u.length)||(0,_util.isArrayBuffer)(u))return new Uint8Array(u);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}const Q=class Q{constructor(){ut(this,m,null);this._capability=(0,_util.createPromiseCapability)(),this._transport=null,this._worker=null,this.docId=`d${Zt(Q,ot)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get onUnsupportedFeature(){return _(this,m)}set onUnsupportedFeature(i){(0,_display_utils.deprecated)("The PDFDocumentLoadingTask onUnsupportedFeature property will be removed in the future."),pt(this,m,i)}get promise(){return this._capability.promise}async destroy(){var i;this.destroyed=!0,await((i=this._transport)==null?void 0:i.destroy()),this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}};ot=new WeakMap,m=new WeakMap,ut(Q,ot,0);let PDFDocumentLoadingTask=Q;exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(i,n,t=!1,s=null){this.length=i,this.initialData=n,this.progressiveDone=t,this.contentDispositionFilename=s,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=(0,_util.createPromiseCapability)()}addRangeListener(i){this._rangeListeners.push(i)}addProgressListener(i){this._progressListeners.push(i)}addProgressiveReadListener(i){this._progressiveReadListeners.push(i)}addProgressiveDoneListener(i){this._progressiveDoneListeners.push(i)}onDataRange(i,n){for(const t of this._rangeListeners)t(i,n)}onDataProgress(i,n){this._readyCapability.promise.then(()=>{for(const t of this._progressListeners)t(i,n)})}onDataProgressiveRead(i){this._readyCapability.promise.then(()=>{for(const n of this._progressiveReadListeners)n(i)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const i of this._progressiveDoneListeners)i()})}transportReady(){this._readyCapability.resolve()}requestDataRange(i,n){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(i,n){this._pdfInfo=i,this._transport=n}get annotationStorage(){return this._transport.annotationStorage}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(i){return this._transport.getPage(i)}getPageIndex(i){return this._transport.getPageIndex(i)}getDestinations(){return this._transport.getDestinations()}getDestination(i){return this._transport.getDestination(i)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(i=!1){return this._transport.startCleanup(i||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(i,n,t,s,p=!1){this._pageIndex=i,this._pageInfo=n,this._ownerDocument=s,this._transport=t,this._stats=p?new _display_utils.StatTimer:null,this._pdfBug=p,this.commonObjs=t.commonObjs,this.objs=new PDFObjects,this.cleanupAfterRender=!1,this.pendingCleanup=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:i,rotation:n=this.rotate,offsetX:t=0,offsetY:s=0,dontFlip:p=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:i,rotation:n,offsetX:t,offsetY:s,dontFlip:p})}getAnnotations({intent:i="display"}={}){const n=this._transport.getRenderingIntent(i);return this._transport.getAnnotations(this._pageIndex,n.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var i;return((i=this._transport._htmlForXfa)==null?void 0:i.children[this._pageIndex])||null}render({canvasContext:i,viewport:n,intent:t="display",annotationMode:s=_util.AnnotationMode.ENABLE,transform:p=null,canvasFactory:e=null,background:y=null,optionalContentConfigPromise:O=null,annotationCanvasMap:W=null,pageColors:tt=null,printAnnotationStorage:gt=null}){var M,h;(M=this._stats)==null||M.time("Overall");const rt=this._transport.getRenderingIntent(t,s,gt);this.pendingCleanup=!1,O||(O=this._transport.getOptionalContentConfig());let ct=this._intentStates.get(rt.cacheKey);ct||(ct=Object.create(null),this._intentStates.set(rt.cacheKey,ct)),ct.streamReaderCancelTimeout&&(clearTimeout(ct.streamReaderCancelTimeout),ct.streamReaderCancelTimeout=null);const K=e||new DefaultCanvasFactory({ownerDocument:this._ownerDocument}),H=!!(rt.renderingIntent&_util.RenderingIntentFlag.PRINT);ct.displayReadyCapability||(ct.displayReadyCapability=(0,_util.createPromiseCapability)(),ct.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(h=this._stats)==null||h.time("Page Request"),this._pumpOperatorList(rt));const G=o=>{var v,R;ct.renderTasks.delete(st),(this.cleanupAfterRender||H)&&(this.pendingCleanup=!0),this._tryCleanup(),o?(st.capability.reject(o),this._abortOperatorList({intentState:ct,reason:o instanceof Error?o:new Error(o)})):st.capability.resolve(),(v=this._stats)==null||v.timeEnd("Rendering"),(R=this._stats)==null||R.timeEnd("Overall")},st=new InternalRenderTask({callback:G,params:{canvasContext:i,viewport:n,transform:p,background:y},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:W,operatorList:ct.operatorList,pageIndex:this._pageIndex,canvasFactory:K,useRequestAnimationFrame:!H,pdfBug:this._pdfBug,pageColors:tt});(ct.renderTasks||(ct.renderTasks=new Set)).add(st);const ht=st.task;return Promise.all([ct.displayReadyCapability.promise,O]).then(([o,v])=>{var R;if(this.pendingCleanup){G();return}(R=this._stats)==null||R.time("Rendering"),st.initializeGraphics({transparency:o,optionalContentConfig:v}),st.operatorListChanged()}).catch(G),ht}getOperatorList({intent:i="display",annotationMode:n=_util.AnnotationMode.ENABLE,printAnnotationStorage:t=null}={}){var O;function s(){e.operatorList.lastChunk&&(e.opListReadCapability.resolve(e.operatorList),e.renderTasks.delete(y))}const p=this._transport.getRenderingIntent(i,n,t,!0);let e=this._intentStates.get(p.cacheKey);e||(e=Object.create(null),this._intentStates.set(p.cacheKey,e));let y;return e.opListReadCapability||(y=Object.create(null),y.operatorListChanged=s,e.opListReadCapability=(0,_util.createPromiseCapability)(),(e.renderTasks||(e.renderTasks=new Set)).add(y),e.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(O=this._stats)==null||O.time("Page Request"),this._pumpOperatorList(p)),e.opListReadCapability.promise}streamTextContent({disableCombineTextItems:i=!1,includeMarkedContent:n=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,combineTextItems:i!==!0,includeMarkedContent:n===!0},{highWaterMark:100,size(s){return s.items.length}})}getTextContent(i={}){if(this._transport._htmlForXfa)return this.getXfa().then(t=>_xfa_text.XfaText.textContent(t));const n=this.streamTextContent(i);return new Promise(function(t,s){function p(){e.read().then(function({value:O,done:W}){if(W){t(y);return}Object.assign(y.styles,O.styles),y.items.push(...O.items),p()},s)}const e=n.getReader(),y={items:[],styles:Object.create(null)};p()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const i=[];for(const n of this._intentStates.values())if(this._abortOperatorList({intentState:n,reason:new Error("Page was destroyed."),force:!0}),!n.opListReadCapability)for(const t of n.renderTasks)i.push(t.completed),t.cancel();return this.objs.clear(),this.pendingCleanup=!1,Promise.all(i)}cleanup(i=!1){return this.pendingCleanup=!0,this._tryCleanup(i)}_tryCleanup(i=!1){if(!this.pendingCleanup)return!1;for(const{renderTasks:n,operatorList:t}of this._intentStates.values())if(n.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),i&&this._stats&&(this._stats=new _display_utils.StatTimer),this.pendingCleanup=!1,!0}_startRenderPage(i,n){var s,p;const t=this._intentStates.get(n);t&&((s=this._stats)==null||s.timeEnd("Page Request"),(p=t.displayReadyCapability)==null||p.resolve(i))}_renderPageChunk(i,n){for(let t=0,s=i.length;t<s;t++)n.operatorList.fnArray.push(i.fnArray[t]),n.operatorList.argsArray.push(i.argsArray[t]);n.operatorList.lastChunk=i.lastChunk,n.operatorList.separateAnnots=i.separateAnnots;for(const t of n.renderTasks)t.operatorListChanged();i.lastChunk&&this._tryCleanup()}_pumpOperatorList({renderingIntent:i,cacheKey:n,annotationStorageMap:t}){const p=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:i,cacheKey:n,annotationStorage:t}).getReader(),e=this._intentStates.get(n);e.streamReader=p;const y=()=>{p.read().then(({value:O,done:W})=>{if(W){e.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(O,e),y())},O=>{if(e.streamReader=null,!this._transport.destroyed){if(e.operatorList){e.operatorList.lastChunk=!0;for(const W of e.renderTasks)W.operatorListChanged();this._tryCleanup()}if(e.displayReadyCapability)e.displayReadyCapability.reject(O);else if(e.opListReadCapability)e.opListReadCapability.reject(O);else throw O}})};y()}_abortOperatorList({intentState:i,reason:n,force:t=!1}){if(i.streamReader){if(i.streamReaderCancelTimeout&&(clearTimeout(i.streamReaderCancelTimeout),i.streamReaderCancelTimeout=null),!t){if(i.renderTasks.size>0)return;if(n instanceof _display_utils.RenderingCancelledException){let s=RENDERING_CANCELLED_TIMEOUT;n.extraDelay>0&&n.extraDelay<1e3&&(s+=n.extraDelay),i.streamReaderCancelTimeout=setTimeout(()=>{i.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:i,reason:n,force:!0})},s);return}}if(i.streamReader.cancel(new _util.AbortException(n.message)).catch(()=>{}),i.streamReader=null,!this._transport.destroyed){for(const[s,p]of this._intentStates)if(p===i){this._intentStates.delete(s);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){ut(this,b,new Set);ut(this,w,Promise.resolve())}postMessage(i,n){const t={data:structuredClone(i,n)};_(this,w).then(()=>{for(const s of _(this,b))s.call(this,t)})}addEventListener(i,n){_(this,b).add(n)}removeEventListener(i,n){_(this,b).delete(n)}terminate(){_(this,b).clear()}}b=new WeakMap,w=new WeakMap,exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_is_node.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const u=(Y=document==null?void 0:document.currentScript)==null?void 0:Y.src;u&&(PDFWorkerUtil.fallbackWorkerSrc=u.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(u,i){let n;try{if(n=new URL(u),!n.origin||n.origin==="null")return!1}catch{return!1}const t=new URL(i,n);return n.origin===t.origin},PDFWorkerUtil.createCDNWrapper=function(u){const i=`importScripts("${u}");`;return URL.createObjectURL(new Blob([i]))}}const _PDFWorker=class _PDFWorker{constructor({name:u=null,port:i=null,verbosity:n=(0,_util.getVerbosityLevel)()}={}){if(i&&_(_PDFWorker,z).has(i))throw new Error("Cannot use more than one PDFWorker per port.");if(this.name=u,this.destroyed=!1,this.verbosity=n,this._readyCapability=(0,_util.createPromiseCapability)(),this._port=null,this._webWorker=null,this._messageHandler=null,i){_(_PDFWorker,z).set(i,this),this._initializeFromPort(i);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(u){this._port=u,this._messageHandler=new _message_handler.MessageHandler("main","worker",u),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!_PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:u}=_PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,u)||(u=PDFWorkerUtil.createCDNWrapper(new URL(u,window.location).href));const i=new Worker(u),n=new _message_handler.MessageHandler("main","worker",i),t=()=>{i.removeEventListener("error",s),n.destroy(),i.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},s=()=>{this._webWorker||t()};i.addEventListener("error",s),n.on("test",e=>{if(i.removeEventListener("error",s),this.destroyed){t();return}e?(this._messageHandler=n,this._port=i,this._webWorker=i,this._readyCapability.resolve(),n.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),n.destroy(),i.terminate())}),n.on("ready",e=>{if(i.removeEventListener("error",s),this.destroyed){t();return}try{p()}catch{this._setupFakeWorker()}});const p=()=>{const e=new Uint8Array;n.send("test",e,[e.buffer])};p();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),_PDFWorker._setupFakeWorkerGlobal.then(u=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const i=new LoopbackPort;this._port=i;const n=`fake${PDFWorkerUtil.fakeWorkerId++}`,t=new _message_handler.MessageHandler(n+"_worker",n,i);u.setup(t,i);const s=new _message_handler.MessageHandler(n,n+"_worker",i);this._messageHandler=s,this._readyCapability.resolve(),s.send("configure",{verbosity:this.verbosity})}).catch(u=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${u.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),_(_PDFWorker,z).delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(u){if(!(u!=null&&u.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return _(this,z).has(u.port)?_(this,z).get(u.port):new _PDFWorker(u)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var u;try{return((u=globalThis.pdfjsWorker)==null?void 0:u.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}};z=new WeakMap,ut(_PDFWorker,z,new WeakMap);let PDFWorker=_PDFWorker;exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(i,n,t,s,p){ut(this,P);ut(this,et,new Map);ut(this,B,new Map);ut(this,S,new Map);this.messageHandler=i,this.loadingTask=n,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({onUnsupportedFeature:this._onUnsupportedFeature.bind(this),ownerDocument:s.ownerDocument,styleElement:s.styleElement}),this._params=s,this.cMapReaderFactory=p==null?void 0:p.cMapReaderFactory,this.standardFontDataFactory=p==null?void 0:p.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=t,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=(0,_util.createPromiseCapability)(),this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(i,n=_util.AnnotationMode.ENABLE,t=null,s=!1){let p=_util.RenderingIntentFlag.DISPLAY,e=null;switch(i){case"any":p=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":p=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${i}`)}switch(n){case _util.AnnotationMode.DISABLE:p+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:p+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:p+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,e=(p&_util.RenderingIntentFlag.PRINT&&t instanceof _annotation_storage.PrintAnnotationStorage?t:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${n}`)}return s&&(p+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:p,cacheKey:`${p}_${_annotation_storage.AnnotationStorage.getHash(e)}`,annotationStorageMap:e}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=(0,_util.createPromiseCapability)(),this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));const i=[];for(const t of _(this,B).values())i.push(t._destroy());_(this,B).clear(),_(this,S).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const n=this.messageHandler.sendWithPromise("Terminate",null);return i.push(n),Promise.all(i).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),_(this,et).clear(),this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:i,loadingTask:n}=this;i.on("GetReader",(t,s)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=p=>{this._lastProgress={loaded:p.loaded,total:p.total}},s.onPull=()=>{this._fullReader.read().then(function({value:p,done:e}){if(e){s.close();return}(0,_util.assert)(p instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(p),1,[p])}).catch(p=>{s.error(p)})},s.onCancel=p=>{this._fullReader.cancel(p),s.ready.catch(e=>{if(!this.destroyed)throw e})}}),i.on("ReaderHeadersReady",t=>{const s=(0,_util.createPromiseCapability)(),p=this._fullReader;return p.headersReady.then(()=>{var e;(!p.isStreamingSupported||!p.isRangeSupported)&&(this._lastProgress&&((e=n.onProgress)==null||e.call(n,this._lastProgress)),p.onProgress=y=>{var O;(O=n.onProgress)==null||O.call(n,{loaded:y.loaded,total:y.total})}),s.resolve({isStreamingSupported:p.isStreamingSupported,isRangeSupported:p.isRangeSupported,contentLength:p.contentLength})},s.reject),s.promise}),i.on("GetRangeReader",(t,s)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const p=this._networkStream.getRangeReader(t.begin,t.end);if(!p){s.close();return}s.onPull=()=>{p.read().then(function({value:e,done:y}){if(y){s.close();return}(0,_util.assert)(e instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(e),1,[e])}).catch(e=>{s.error(e)})},s.onCancel=e=>{p.cancel(e),s.ready.catch(y=>{if(!this.destroyed)throw y})}}),i.on("GetDoc",({pdfInfo:t})=>{this._numPages=t.numPages,this._htmlForXfa=t.htmlForXfa,delete t.htmlForXfa,n._capability.resolve(new PDFDocumentProxy(t,this))}),i.on("DocException",function(t){let s;switch(t.name){case"PasswordException":s=new _util.PasswordException(t.message,t.code);break;case"InvalidPDFException":s=new _util.InvalidPDFException(t.message);break;case"MissingPDFException":s=new _util.MissingPDFException(t.message);break;case"UnexpectedResponseException":s=new _util.UnexpectedResponseException(t.message,t.status);break;case"UnknownErrorException":s=new _util.UnknownErrorException(t.message,t.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}n._capability.reject(s)}),i.on("PasswordRequest",t=>{if(this._passwordCapability=(0,_util.createPromiseCapability)(),n.onPassword){const s=p=>{p instanceof Error?this._passwordCapability.reject(p):this._passwordCapability.resolve({password:p})};try{n.onPassword(s,t.code)}catch(p){this._passwordCapability.reject(p)}}else this._passwordCapability.reject(new _util.PasswordException(t.message,t.code));return this._passwordCapability.promise}),i.on("DataLoaded",t=>{var s;(s=n.onProgress)==null||s.call(n,{loaded:t.length,total:t.length}),this.downloadInfoCapability.resolve(t)}),i.on("StartRenderPage",t=>{if(this.destroyed)return;_(this,B).get(t.pageIndex)._startRenderPage(t.transparency,t.cacheKey)}),i.on("commonobj",([t,s,p])=>{var e;if(!this.destroyed&&!this.commonObjs.has(t))switch(s){case"Font":const y=this._params;if("error"in p){const tt=p.error;(0,_util.warn)(`Error during font loading: ${tt}`),this.commonObjs.resolve(t,tt);break}let O=null;y.pdfBug&&((e=globalThis.FontInspector)!=null&&e.enabled)&&(O={registerFont(tt,gt){globalThis.FontInspector.fontAdded(tt,gt)}});const W=new _font_loader.FontFaceObject(p,{isEvalSupported:y.isEvalSupported,disableFontFace:y.disableFontFace,ignoreErrors:y.ignoreErrors,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),fontRegistry:O});this.fontLoader.bind(W).catch(tt=>i.sendWithPromise("FontFallback",{id:t})).finally(()=>{!y.fontExtraProperties&&W.data&&(W.data=null),this.commonObjs.resolve(t,W)});break;case"FontPath":case"Image":this.commonObjs.resolve(t,p);break;default:throw new Error(`Got unknown common object type ${s}`)}}),i.on("obj",([t,s,p,e])=>{var O;if(this.destroyed)return;const y=_(this,B).get(s);if(!y.objs.has(t))switch(p){case"Image":y.objs.resolve(t,e);const W=8e6;if(e){let tt;if(e.bitmap){const{width:gt,height:rt}=e;tt=gt*rt*4}else tt=((O=e.data)==null?void 0:O.length)||0;tt>W&&(y.cleanupAfterRender=!0)}break;case"Pattern":y.objs.resolve(t,e);break;default:throw new Error(`Got unknown object type ${p}`)}}),i.on("DocProgress",t=>{var s;this.destroyed||(s=n.onProgress)==null||s.call(n,{loaded:t.loaded,total:t.total})}),i.on("UnsupportedFeature",this._onUnsupportedFeature.bind(this)),i.on("FetchBuiltInCMap",t=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(t):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),i.on("FetchStandardFontData",t=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(t):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}_onUnsupportedFeature({featureId:i}){var n,t;this.destroyed||(t=(n=this.loadingTask).onUnsupportedFeature)==null||t.call(n,i)}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var i;return this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead."),this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:this.annotationStorage.serializable,filename:((i=this._fullReader)==null?void 0:i.filename)??null}).finally(()=>{this.annotationStorage.resetModified()})}getPage(i){if(!Number.isInteger(i)||i<=0||i>this._numPages)return Promise.reject(new Error("Invalid page request."));const n=i-1,t=_(this,S).get(n);if(t)return t;const s=this.messageHandler.sendWithPromise("GetPage",{pageIndex:n}).then(p=>{if(this.destroyed)throw new Error("Transport destroyed");const e=new PDFPageProxy(n,p,this,this._params.ownerDocument,this._params.pdfBug);return _(this,B).set(n,e),e});return _(this,S).set(n,s),s}getPageIndex(i){return typeof i!="object"||i===null||!Number.isInteger(i.num)||i.num<0||!Number.isInteger(i.gen)||i.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:i.num,gen:i.gen})}getAnnotations(i,n){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:i,intent:n})}getFieldObjects(){return lt(this,P,te).call(this,"GetFieldObjects")}hasJSActions(){return lt(this,P,te).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(i){return typeof i!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:i})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(i){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:i})}getStructTree(i){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:i})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(i=>new _optional_content_config.OptionalContentConfig(i))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const i="GetMetadata",n=_(this,et).get(i);if(n)return n;const t=this.messageHandler.sendWithPromise(i,null).then(s=>{var p,e;return{info:s[0],metadata:s[1]?new _metadata.Metadata(s[1]):null,contentDispositionFilename:((p=this._fullReader)==null?void 0:p.filename)??null,contentLength:((e=this._fullReader)==null?void 0:e.contentLength)??null}});return _(this,et).set(i,t),t}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(i=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const n of _(this,B).values())if(!n.cleanup())throw new Error(`startCleanup: Page ${n.pageNumber} is currently rendering.`);this.commonObjs.clear(),i||this.fontLoader.clear(),_(this,et).clear()}}get loadingParams(){const{disableAutoFetch:i,enableXfa:n}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:i,enableXfa:n})}}et=new WeakMap,B=new WeakMap,S=new WeakMap,P=new WeakSet,te=function(i,n=null){const t=_(this,et).get(i);if(t)return t;const s=this.messageHandler.sendWithPromise(i,n);return _(this,et).set(i,s),s};class PDFObjects{constructor(){ut(this,A);ut(this,T,Object.create(null))}get(i,n=null){if(n){const s=lt(this,A,ee).call(this,i);return s.capability.promise.then(()=>n(s.data)),null}const t=_(this,T)[i];if(!(t!=null&&t.capability.settled))throw new Error(`Requesting object that isn't resolved yet ${i}.`);return t.data}has(i){const n=_(this,T)[i];return(n==null?void 0:n.capability.settled)||!1}resolve(i,n=null){const t=lt(this,A,ee).call(this,i);t.data=n,t.capability.resolve()}clear(){var i;for(const n in _(this,T)){const{data:t}=_(this,T)[n];(i=t==null?void 0:t.bitmap)==null||i.close()}pt(this,T,Object.create(null))}}T=new WeakMap,A=new WeakSet,ee=function(i){const n=_(this,T)[i];return n||(_(this,T)[i]={capability:(0,_util.createPromiseCapability)(),data:null})};class RenderTask{constructor(i){ut(this,f,null);pt(this,f,i),this.onContinue=null}get promise(){return _(this,f).capability.promise}cancel(i=0){_(this,f).cancel(null,i)}get separateAnnots(){const{separateAnnots:i}=_(this,f).operatorList;if(!i)return!1;const{annotationCanvasMap:n}=_(this,f);return i.form||i.canvas&&(n==null?void 0:n.size)>0}}f=new WeakMap,exports.RenderTask=RenderTask;const c=class c{constructor({callback:i,params:n,objs:t,commonObjs:s,annotationCanvasMap:p,operatorList:e,pageIndex:y,canvasFactory:O,useRequestAnimationFrame:W=!1,pdfBug:tt=!1,pageColors:gt=null}){this.callback=i,this.params=n,this.objs=t,this.commonObjs=s,this.annotationCanvasMap=p,this.operatorListIdx=null,this.operatorList=e,this._pageIndex=y,this.canvasFactory=O,this._pdfBug=tt,this.pageColors=gt,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=W===!0&&typeof window<"u",this.cancelled=!1,this.capability=(0,_util.createPromiseCapability)(),this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=n.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:i=!1,optionalContentConfig:n}){var y,O;if(this.cancelled)return;if(this._canvas){if(_(c,r).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");_(c,r).add(this._canvas)}this._pdfBug&&((y=globalThis.StepperManager)!=null&&y.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:t,viewport:s,transform:p,background:e}=this.params;this.gfx=new _canvas.CanvasGraphics(t,this.commonObjs,this.objs,this.canvasFactory,{optionalContentConfig:n},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:p,viewport:s,transparency:i,background:e}),this.operatorListIdx=0,this.graphicsReady=!0,(O=this.graphicsReadyCallback)==null||O.call(this)}cancel(i=null,n=0){var t;this.running=!1,this.cancelled=!0,(t=this.gfx)==null||t.endDrawing(),this._canvas&&_(c,r).delete(this._canvas),this.callback(i||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,"canvas",n))}operatorListChanged(){var i;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(i=this.stepper)==null||i.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),this._canvas&&_(c,r).delete(this._canvas),this.callback())))}};r=new WeakMap,ut(c,r,new WeakSet);let InternalRenderTask=c;const version="3.4.120";exports.version=version;const build="af6414988";exports.build=build},(ot,m,Q)=>{var B,S,P,ye,T;Object.defineProperty(m,"__esModule",{value:!0}),m.PrintAnnotationStorage=m.AnnotationStorage=void 0;var b=Q(1),w=Q(4),Y=Q(8);class z{constructor(){ut(this,P);ut(this,B,!1);ut(this,S,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(g,f){const r=_(this,S).get(g);return r===void 0?f:Object.assign(f,r)}getRawValue(g){return _(this,S).get(g)}remove(g){if(_(this,S).delete(g),_(this,S).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const f of _(this,S).values())if(f instanceof w.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(g,f){const r=_(this,S).get(g);let c=!1;if(r!==void 0)for(const[u,i]of Object.entries(f))r[u]!==i&&(c=!0,r[u]=i);else c=!0,_(this,S).set(g,f);c&&lt(this,P,ye).call(this),f instanceof w.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(f.constructor._type)}has(g){return _(this,S).has(g)}getAll(){return _(this,S).size>0?(0,b.objectFromMap)(_(this,S)):null}setAll(g){for(const[f,r]of Object.entries(g))this.setValue(f,r)}get size(){return _(this,S).size}resetModified(){_(this,B)&&(pt(this,B,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new et(this)}get serializable(){if(_(this,S).size===0)return null;const g=new Map;for(const[f,r]of _(this,S)){const c=r instanceof w.AnnotationEditor?r.serialize():r;c&&g.set(f,c)}return g}static getHash(g){if(!g)return"";const f=new Y.MurmurHash3_64;for(const[r,c]of g)f.update(`${r}:${JSON.stringify(c)}`);return f.hexdigest()}}B=new WeakMap,S=new WeakMap,P=new WeakSet,ye=function(){_(this,B)||(pt(this,B,!0),typeof this.onSetModified=="function"&&this.onSetModified())},m.AnnotationStorage=z;class et extends z{constructor(f){super();ut(this,T,null);pt(this,T,structuredClone(f.serializable))}get print(){(0,b.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return _(this,T)}}T=new WeakMap,m.PrintAnnotationStorage=et},(ot,m,Q)=>{var z,et,B,S,P,L;Object.defineProperty(m,"__esModule",{value:!0}),m.AnnotationEditor=void 0;var b=Q(5),w=Q(1);const T=class T{constructor(g){ut(this,z,this.focusin.bind(this));ut(this,et,this.focusout.bind(this));ut(this,B,!1);ut(this,S,!1);ut(this,P,!1);St(this,"_uiManager",null);ut(this,L,T._zIndex++);this.constructor===T&&(0,w.unreachable)("Cannot initialize AnnotationEditor."),this.parent=g.parent,this.id=g.id,this.width=this.height=null,this.pageIndex=g.parent.pageIndex,this.name=g.name,this.div=null,this._uiManager=g.uiManager;const{rotation:f,rawDims:{pageWidth:r,pageHeight:c,pageX:u,pageY:i}}=this.parent.viewport;this.rotation=f,this.pageDimensions=[r,c],this.pageTranslation=[u,i];const[n,t]=this.parentDimensions;this.x=g.x/n,this.y=g.y/t,this.isAttachedToDOM=!1}static get _defaultLineColor(){return(0,w.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}addCommands(g){this._uiManager.addCommands(g)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=_(this,L)}setParent(g){g!==null&&(this.pageIndex=g.pageIndex,this.pageDimensions=g.pageDimensions),this.parent=g}focusin(g){_(this,B)?pt(this,B,!1):this.parent.setSelected(this)}focusout(g){var r;if(!this.isAttachedToDOM)return;const f=g.relatedTarget;f!=null&&f.closest(`#${this.id}`)||(g.preventDefault(),(r=this.parent)!=null&&r.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}dragstart(g){const f=this.parent.div.getBoundingClientRect();this.startX=g.clientX-f.x,this.startY=g.clientY-f.y,g.dataTransfer.setData("text/plain",this.id),g.dataTransfer.effectAllowed="move"}setAt(g,f,r,c){const[u,i]=this.parentDimensions;[r,c]=this.screenToPageTranslation(r,c),this.x=(g+r)/u,this.y=(f+c)/i,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}translate(g,f){const[r,c]=this.parentDimensions;[g,f]=this.screenToPageTranslation(g,f),this.x+=g/r,this.y+=f/c,this.div.style.left=`${100*this.x}%`,this.div.style.top=`${100*this.y}%`}screenToPageTranslation(g,f){switch(this.parentRotation){case 90:return[f,-g];case 180:return[-g,-f];case 270:return[-f,g];default:return[g,f]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return this._uiManager.viewParameters.rotation}get parentDimensions(){const{realScale:g}=this._uiManager.viewParameters,[f,r]=this.pageDimensions;return[f*g,r*g]}setDims(g,f){const[r,c]=this.parentDimensions;this.div.style.width=`${100*g/r}%`,this.div.style.height=`${100*f/c}%`}fixDims(){const{style:g}=this.div,{height:f,width:r}=g,c=r.endsWith("%"),u=f.endsWith("%");if(c&&u)return;const[i,n]=this.parentDimensions;c||(g.width=`${100*parseFloat(r)/i}%`),u||(g.height=`${100*parseFloat(f)/n}%`)}getInitialTranslation(){return[0,0]}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",_(this,z)),this.div.addEventListener("focusout",_(this,et));const[g,f]=this.getInitialTranslation();return this.translate(g,f),(0,b.bindEvents)(this,this.div,["dragstart","pointerdown"]),this.div}pointerdown(g){const{isMac:f}=w.FeatureTest.platform;if(g.button!==0||g.ctrlKey&&f){g.preventDefault();return}g.ctrlKey&&!f||g.shiftKey||g.metaKey&&f?this.parent.toggleSelected(this):this.parent.setSelected(this),pt(this,B,!0)}getRect(g,f){const r=this.parentScale,[c,u]=this.pageDimensions,[i,n]=this.pageTranslation,t=g/r,s=f/r,p=this.x*c,e=this.y*u,y=this.width*c,O=this.height*u;switch(this.rotation){case 0:return[p+t+i,u-e-s-O+n,p+t+y+i,u-e-s+n];case 90:return[p+s+i,u-e+t+n,p+s+O+i,u-e+t+y+n];case 180:return[p-t-y+i,u-e+s+n,p-t+i,u-e+s+O+n];case 270:return[p-s-O+i,u-e-t-y+n,p-s+i,u-e-t+n];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(g,f){const[r,c,u,i]=g,n=u-r,t=i-c;switch(this.rotation){case 0:return[r,f-i,n,t];case 90:return[r,f-c,t,n];case 180:return[u,f-c,n,t];case 270:return[u,f-i,t,n];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){pt(this,P,!0)}disableEditMode(){pt(this,P,!1)}isInEditMode(){return _(this,P)}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){var g;(g=this.div)==null||g.addEventListener("focusin",_(this,z))}serialize(){(0,w.unreachable)("An editor must be serializable")}static deserialize(g,f,r){const c=new this.prototype.constructor({parent:f,id:f.getNextId(),uiManager:r});c.rotation=g.rotation;const[u,i]=c.pageDimensions,[n,t,s,p]=c.getRectInCurrentCoords(g.rect,i);return c.x=n/u,c.y=t/i,c.width=s/u,c.height=p/i,c}remove(){this.div.removeEventListener("focusin",_(this,z)),this.div.removeEventListener("focusout",_(this,et)),this.isEmpty()||this.commit(),this.parent.remove(this)}select(){var g;(g=this.div)==null||g.classList.add("selectedEditor")}unselect(){var g;(g=this.div)==null||g.classList.remove("selectedEditor")}updateParams(g,f){}disableEditing(){}enableEditing(){}get propertiesToUpdate(){return{}}get contentDiv(){return this.div}get isEditing(){return _(this,S)}set isEditing(g){pt(this,S,g),g?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null)}};z=new WeakMap,et=new WeakMap,B=new WeakMap,S=new WeakMap,P=new WeakMap,L=new WeakMap,St(T,"_colorManager",new b.ColorManager),St(T,"_zIndex",1);let Y=T;m.AnnotationEditor=Y},(ot,m,Q)=>{var T,A,g,f,r,c,ve,n,t,s,p,e,y,O,W,tt,gt,rt,ct,K,H,G,st,ht,M,h,o,v,R,D,k,Se,se,Ee,Ce,wt,Bt,Te,Pe,ne,Wt,ie;Object.defineProperty(m,"__esModule",{value:!0}),m.KeyboardManager=m.CommandManager=m.ColorManager=m.AnnotationEditorUIManager=void 0,m.bindEvents=Y,m.opacityToHex=z;var b=Q(1),w=Q(6);function Y(Z,x,U){for(const I of U)x.addEventListener(I,Z[I].bind(Z))}function z(Z){return Math.round(Math.min(255,Math.max(1,255*Z))).toString(16).padStart(2,"0")}class et{constructor(){ut(this,T,0)}getId(){return`${b.AnnotationEditorPrefix}${Zt(this,T)._++}`}}T=new WeakMap;class B{constructor(x=128){ut(this,A,[]);ut(this,g,!1);ut(this,f);ut(this,r,-1);pt(this,f,x)}add({cmd:x,undo:U,mustExec:I,type:it=NaN,overwriteIfSameType:dt=!1,keepUndo:ft=!1}){if(I&&x(),_(this,g))return;const bt={cmd:x,undo:U,type:it};if(_(this,r)===-1){_(this,A).length>0&&(_(this,A).length=0),pt(this,r,0),_(this,A).push(bt);return}if(dt&&_(this,A)[_(this,r)].type===it){ft&&(bt.undo=_(this,A)[_(this,r)].undo),_(this,A)[_(this,r)]=bt;return}const _t=_(this,r)+1;_t===_(this,f)?_(this,A).splice(0,1):(pt(this,r,_t),_t<_(this,A).length&&_(this,A).splice(_t)),_(this,A).push(bt)}undo(){_(this,r)!==-1&&(pt(this,g,!0),_(this,A)[_(this,r)].undo(),pt(this,g,!1),pt(this,r,_(this,r)-1))}redo(){_(this,r)<_(this,A).length-1&&(pt(this,r,_(this,r)+1),pt(this,g,!0),_(this,A)[_(this,r)].cmd(),pt(this,g,!1))}hasSomethingToUndo(){return _(this,r)!==-1}hasSomethingToRedo(){return _(this,r)<_(this,A).length-1}destroy(){pt(this,A,null)}}A=new WeakMap,g=new WeakMap,f=new WeakMap,r=new WeakMap,m.CommandManager=B;class S{constructor(x){ut(this,c);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:U}=b.FeatureTest.platform;for(const[I,it]of x)for(const dt of I){const ft=dt.startsWith("mac+");U&&ft?(this.callbacks.set(dt.slice(4),it),this.allKeys.add(dt.split("+").at(-1))):!U&&!ft&&(this.callbacks.set(dt,it),this.allKeys.add(dt.split("+").at(-1)))}}exec(x,U){if(!this.allKeys.has(U.key))return;const I=this.callbacks.get(lt(this,c,ve).call(this,U));I&&(I.bind(x)(),U.stopPropagation(),U.preventDefault())}}c=new WeakSet,ve=function(x){x.altKey&&this.buffer.push("alt"),x.ctrlKey&&this.buffer.push("ctrl"),x.metaKey&&this.buffer.push("meta"),x.shiftKey&&this.buffer.push("shift"),this.buffer.push(x.key);const U=this.buffer.join("+");return this.buffer.length=0,U},m.KeyboardManager=S;const i=class i{get _colors(){const x=new Map([["CanvasText",null],["Canvas",null]]);return(0,w.getColorValues)(x),(0,b.shadow)(this,"_colors",x)}convert(x){const U=(0,w.getRGB)(x);if(!window.matchMedia("(forced-colors: active)").matches)return U;for(const[I,it]of this._colors)if(it.every((dt,ft)=>dt===U[ft]))return i._colorsMapping.get(I);return U}getHexCode(x){const U=this._colors.get(x);return U?b.Util.makeHexColor(...U):x}};St(i,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let P=i;m.ColorManager=P;const j=class j{constructor(x,U,I){ut(this,k);ut(this,n,null);ut(this,t,new Map);ut(this,s,new Map);ut(this,p,null);ut(this,e,new B);ut(this,y,0);ut(this,O,null);ut(this,W,new Set);ut(this,tt,null);ut(this,gt,new et);ut(this,rt,!1);ut(this,ct,b.AnnotationEditorType.NONE);ut(this,K,new Set);ut(this,H,this.copy.bind(this));ut(this,G,this.cut.bind(this));ut(this,st,this.paste.bind(this));ut(this,ht,this.keydown.bind(this));ut(this,M,this.onEditingAction.bind(this));ut(this,h,this.onPageChanging.bind(this));ut(this,o,this.onScaleChanging.bind(this));ut(this,v,this.onRotationChanging.bind(this));ut(this,R,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1});ut(this,D,null);pt(this,D,x),pt(this,tt,U),_(this,tt)._on("editingaction",_(this,M)),_(this,tt)._on("pagechanging",_(this,h)),_(this,tt)._on("scalechanging",_(this,o)),_(this,tt)._on("rotationchanging",_(this,v)),pt(this,p,I),this.viewParameters={realScale:w.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}destroy(){lt(this,k,se).call(this),_(this,tt)._off("editingaction",_(this,M)),_(this,tt)._off("pagechanging",_(this,h)),_(this,tt)._off("scalechanging",_(this,o)),_(this,tt)._off("rotationchanging",_(this,v));for(const x of _(this,s).values())x.destroy();_(this,s).clear(),_(this,t).clear(),_(this,W).clear(),pt(this,n,null),_(this,K).clear(),_(this,e).destroy()}onPageChanging({pageNumber:x}){pt(this,y,x-1)}focusMainContainer(){_(this,D).focus()}addShouldRescale(x){_(this,W).add(x)}removeShouldRescale(x){_(this,W).delete(x)}onScaleChanging({scale:x}){this.commitOrRemove(),this.viewParameters.realScale=x*w.PixelsPerInch.PDF_TO_CSS_UNITS;for(const U of _(this,W))U.onScaleChanging()}onRotationChanging({pagesRotation:x}){this.commitOrRemove(),this.viewParameters.rotation=x}addToAnnotationStorage(x){!x.isEmpty()&&_(this,p)&&!_(this,p).has(x.id)&&_(this,p).setValue(x.id,x)}copy(x){if(x.preventDefault(),_(this,n)&&_(this,n).commitOrRemove(),!this.hasSelection)return;const U=[];for(const I of _(this,K))I.isEmpty()||U.push(I.serialize());U.length!==0&&x.clipboardData.setData("application/pdfjs",JSON.stringify(U))}cut(x){this.copy(x),this.delete()}paste(x){x.preventDefault();let U=x.clipboardData.getData("application/pdfjs");if(!U)return;try{U=JSON.parse(U)}catch(it){(0,b.warn)(`paste: "${it.message}".`);return}if(!Array.isArray(U))return;this.unselectAll();const I=_(this,s).get(_(this,y));try{const it=[];for(const bt of U){const _t=I.deserialize(bt);if(!_t)return;it.push(_t)}const dt=()=>{for(const bt of it)lt(this,k,ne).call(this,bt);lt(this,k,ie).call(this,it)},ft=()=>{for(const bt of it)bt.remove()};this.addCommands({cmd:dt,undo:ft,mustExec:!0})}catch(it){(0,b.warn)(`paste: "${it.message}".`)}}keydown(x){var U;(U=this.getActive())!=null&&U.shouldGetKeyboardEvents()||j._keyboardManager.exec(this,x)}onEditingAction(x){["undo","redo","delete","selectAll"].includes(x.name)&&this[x.name]()}setEditingState(x){x?(lt(this,k,Se).call(this),lt(this,k,Ee).call(this),lt(this,k,wt).call(this,{isEditing:_(this,ct)!==b.AnnotationEditorType.NONE,isEmpty:lt(this,k,Wt).call(this),hasSomethingToUndo:_(this,e).hasSomethingToUndo(),hasSomethingToRedo:_(this,e).hasSomethingToRedo(),hasSelectedEditor:!1})):(lt(this,k,se).call(this),lt(this,k,Ce).call(this),lt(this,k,wt).call(this,{isEditing:!1}))}registerEditorTypes(x){if(!_(this,O)){pt(this,O,x);for(const U of _(this,O))lt(this,k,Bt).call(this,U.defaultPropertiesToUpdate)}}getId(){return _(this,gt).getId()}get currentLayer(){return _(this,s).get(_(this,y))}get currentPageIndex(){return _(this,y)}addLayer(x){_(this,s).set(x.pageIndex,x),_(this,rt)?x.enable():x.disable()}removeLayer(x){_(this,s).delete(x.pageIndex)}updateMode(x){if(pt(this,ct,x),x===b.AnnotationEditorType.NONE)this.setEditingState(!1),lt(this,k,Pe).call(this);else{this.setEditingState(!0),lt(this,k,Te).call(this);for(const U of _(this,s).values())U.updateMode(x)}}updateToolbar(x){x!==_(this,ct)&&_(this,tt).dispatch("switchannotationeditormode",{source:this,mode:x})}updateParams(x,U){if(_(this,O)){for(const I of _(this,K))I.updateParams(x,U);for(const I of _(this,O))I.updateDefaultParams(x,U)}}getEditors(x){const U=[];for(const I of _(this,t).values())I.pageIndex===x&&U.push(I);return U}getEditor(x){return _(this,t).get(x)}addEditor(x){_(this,t).set(x.id,x)}removeEditor(x){var U;_(this,t).delete(x.id),this.unselect(x),(U=_(this,p))==null||U.remove(x.id)}setActiveEditor(x){_(this,n)!==x&&(pt(this,n,x),x&&lt(this,k,Bt).call(this,x.propertiesToUpdate))}toggleSelected(x){if(_(this,K).has(x)){_(this,K).delete(x),x.unselect(),lt(this,k,wt).call(this,{hasSelectedEditor:this.hasSelection});return}_(this,K).add(x),x.select(),lt(this,k,Bt).call(this,x.propertiesToUpdate),lt(this,k,wt).call(this,{hasSelectedEditor:!0})}setSelected(x){for(const U of _(this,K))U!==x&&U.unselect();_(this,K).clear(),_(this,K).add(x),x.select(),lt(this,k,Bt).call(this,x.propertiesToUpdate),lt(this,k,wt).call(this,{hasSelectedEditor:!0})}isSelected(x){return _(this,K).has(x)}unselect(x){x.unselect(),_(this,K).delete(x),lt(this,k,wt).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return _(this,K).size!==0}undo(){_(this,e).undo(),lt(this,k,wt).call(this,{hasSomethingToUndo:_(this,e).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:lt(this,k,Wt).call(this)})}redo(){_(this,e).redo(),lt(this,k,wt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:_(this,e).hasSomethingToRedo(),isEmpty:lt(this,k,Wt).call(this)})}addCommands(x){_(this,e).add(x),lt(this,k,wt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:lt(this,k,Wt).call(this)})}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const x=[..._(this,K)],U=()=>{for(const it of x)it.remove()},I=()=>{for(const it of x)lt(this,k,ne).call(this,it)};this.addCommands({cmd:U,undo:I,mustExec:!0})}commitOrRemove(){var x;(x=_(this,n))==null||x.commitOrRemove()}selectAll(){for(const x of _(this,K))x.commit();lt(this,k,ie).call(this,_(this,t).values())}unselectAll(){if(_(this,n)){_(this,n).commitOrRemove();return}if(_(this,K).size!==0){for(const x of _(this,K))x.unselect();_(this,K).clear(),lt(this,k,wt).call(this,{hasSelectedEditor:!1})}}isActive(x){return _(this,n)===x}getActive(){return _(this,n)}getMode(){return _(this,ct)}};n=new WeakMap,t=new WeakMap,s=new WeakMap,p=new WeakMap,e=new WeakMap,y=new WeakMap,O=new WeakMap,W=new WeakMap,tt=new WeakMap,gt=new WeakMap,rt=new WeakMap,ct=new WeakMap,K=new WeakMap,H=new WeakMap,G=new WeakMap,st=new WeakMap,ht=new WeakMap,M=new WeakMap,h=new WeakMap,o=new WeakMap,v=new WeakMap,R=new WeakMap,D=new WeakMap,k=new WeakSet,Se=function(){_(this,D).addEventListener("keydown",_(this,ht))},se=function(){_(this,D).removeEventListener("keydown",_(this,ht))},Ee=function(){document.addEventListener("copy",_(this,H)),document.addEventListener("cut",_(this,G)),document.addEventListener("paste",_(this,st))},Ce=function(){document.removeEventListener("copy",_(this,H)),document.removeEventListener("cut",_(this,G)),document.removeEventListener("paste",_(this,st))},wt=function(x){Object.entries(x).some(([I,it])=>_(this,R)[I]!==it)&&_(this,tt).dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(_(this,R),x)})},Bt=function(x){_(this,tt).dispatch("annotationeditorparamschanged",{source:this,details:x})},Te=function(){if(!_(this,rt)){pt(this,rt,!0);for(const x of _(this,s).values())x.enable()}},Pe=function(){if(this.unselectAll(),_(this,rt)){pt(this,rt,!1);for(const x of _(this,s).values())x.disable()}},ne=function(x){const U=_(this,s).get(x.pageIndex);U?U.addOrRebuild(x):this.addEditor(x)},Wt=function(){if(_(this,t).size===0)return!0;if(_(this,t).size===1)for(const x of _(this,t).values())return x.isEmpty();return!1},ie=function(x){_(this,K).clear();for(const U of x)U.isEmpty()||(_(this,K).add(U),U.select());lt(this,k,wt).call(this,{hasSelectedEditor:!0})},St(j,"_keyboardManager",new S([[["ctrl+a","mac+meta+a"],j.prototype.selectAll],[["ctrl+z","mac+meta+z"],j.prototype.undo],[["ctrl+y","ctrl+shift+Z","mac+meta+shift+Z"],j.prototype.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete"],j.prototype.delete],[["Escape","mac+Escape"],j.prototype.unselectAll]]));let L=j;m.AnnotationEditorUIManager=L},(ot,m,Q)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.StatTimer=m.RenderingCancelledException=m.PixelsPerInch=m.PageViewport=m.PDFDateString=m.DOMStandardFontDataFactory=m.DOMSVGFactory=m.DOMCanvasFactory=m.DOMCMapReaderFactory=m.AnnotationPrefix=void 0,m.deprecated=s,m.getColorValues=W,m.getCurrentTransform=tt,m.getCurrentTransformInverse=gt,m.getFilenameFromUrl=c,m.getPdfFilenameFromUrl=u,m.getRGB=O,m.getXfaPageViewport=y,m.isDataScheme=f,m.isPdfFile=r,m.isValidFetchUrl=n,m.loadScript=t,m.setLayerDimensions=rt;var b=Q(7),w=Q(1);const Y="http://www.w3.org/2000/svg",z="pdfjs_internal_id_";m.AnnotationPrefix=z;const ct=class ct{};St(ct,"CSS",96),St(ct,"PDF",72),St(ct,"PDF_TO_CSS_UNITS",ct.CSS/ct.PDF);let et=ct;m.PixelsPerInch=et;class B extends b.BaseCanvasFactory{constructor({ownerDocument:H=globalThis.document}={}){super(),this._document=H}_createCanvas(H,G){const st=this._document.createElement("canvas");return st.width=H,st.height=G,st}}m.DOMCanvasFactory=B;async function S(K,H=!1){if(n(K,document.baseURI)){const G=await fetch(K);if(!G.ok)throw new Error(G.statusText);return H?new Uint8Array(await G.arrayBuffer()):(0,w.stringToBytes)(await G.text())}return new Promise((G,st)=>{const ht=new XMLHttpRequest;ht.open("GET",K,!0),H&&(ht.responseType="arraybuffer"),ht.onreadystatechange=()=>{if(ht.readyState===XMLHttpRequest.DONE){if(ht.status===200||ht.status===0){let M;if(H&&ht.response?M=new Uint8Array(ht.response):!H&&ht.responseText&&(M=(0,w.stringToBytes)(ht.responseText)),M){G(M);return}}st(new Error(ht.statusText))}},ht.send(null)})}class P extends b.BaseCMapReaderFactory{_fetchData(H,G){return S(H,this.isCompressed).then(st=>({cMapData:st,compressionType:G}))}}m.DOMCMapReaderFactory=P;class L extends b.BaseStandardFontDataFactory{_fetchData(H){return S(H,!0)}}m.DOMStandardFontDataFactory=L;class T extends b.BaseSVGFactory{_createSVG(H){return document.createElementNS(Y,H)}}m.DOMSVGFactory=T;class A{constructor({viewBox:H,scale:G,rotation:st,offsetX:ht=0,offsetY:M=0,dontFlip:h=!1}){this.viewBox=H,this.scale=G,this.rotation=st,this.offsetX=ht,this.offsetY=M;const o=(H[2]+H[0])/2,v=(H[3]+H[1])/2;let R,D,k,q;switch(st%=360,st<0&&(st+=360),st){case 180:R=-1,D=0,k=0,q=1;break;case 90:R=0,D=1,k=1,q=0;break;case 270:R=0,D=-1,k=-1,q=0;break;case 0:R=1,D=0,k=0,q=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}h&&(k=-k,q=-q);let J,nt,$,a;R===0?(J=Math.abs(v-H[1])*G+ht,nt=Math.abs(o-H[0])*G+M,$=(H[3]-H[1])*G,a=(H[2]-H[0])*G):(J=Math.abs(o-H[0])*G+ht,nt=Math.abs(v-H[1])*G+M,$=(H[2]-H[0])*G,a=(H[3]-H[1])*G),this.transform=[R*G,D*G,k*G,q*G,J-R*G*o-k*G*v,nt-D*G*o-q*G*v],this.width=$,this.height=a}get rawDims(){const{viewBox:H}=this;return(0,w.shadow)(this,"rawDims",{pageWidth:H[2]-H[0],pageHeight:H[3]-H[1],pageX:H[0],pageY:H[1]})}clone({scale:H=this.scale,rotation:G=this.rotation,offsetX:st=this.offsetX,offsetY:ht=this.offsetY,dontFlip:M=!1}={}){return new A({viewBox:this.viewBox.slice(),scale:H,rotation:G,offsetX:st,offsetY:ht,dontFlip:M})}convertToViewportPoint(H,G){return w.Util.applyTransform([H,G],this.transform)}convertToViewportRectangle(H){const G=w.Util.applyTransform([H[0],H[1]],this.transform),st=w.Util.applyTransform([H[2],H[3]],this.transform);return[G[0],G[1],st[0],st[1]]}convertToPdfPoint(H,G){return w.Util.applyInverseTransform([H,G],this.transform)}}m.PageViewport=A;class g extends w.BaseException{constructor(H,G,st=0){super(H,"RenderingCancelledException"),this.type=G,this.extraDelay=st}}m.RenderingCancelledException=g;function f(K){const H=K.length;let G=0;for(;G<H&&K[G].trim()==="";)G++;return K.substring(G,G+5).toLowerCase()==="data:"}function r(K){return typeof K=="string"&&/\.pdf$/i.test(K)}function c(K,H=!1){return H||([K]=K.split(/[#?]/,1)),K.substring(K.lastIndexOf("/")+1)}function u(K,H="document.pdf"){if(typeof K!="string")return H;if(f(K))return(0,w.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),H;const G=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,st=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,ht=G.exec(K);let M=st.exec(ht[1])||st.exec(ht[2])||st.exec(ht[3]);if(M&&(M=M[0],M.includes("%")))try{M=st.exec(decodeURIComponent(M))[0]}catch{}return M||H}class i{constructor(){St(this,"started",Object.create(null));St(this,"times",[])}time(H){H in this.started&&(0,w.warn)(`Timer is already running for ${H}`),this.started[H]=Date.now()}timeEnd(H){H in this.started||(0,w.warn)(`Timer has not been started for ${H}`),this.times.push({name:H,start:this.started[H],end:Date.now()}),delete this.started[H]}toString(){const H=[];let G=0;for(const{name:st}of this.times)G=Math.max(st.length,G);for(const{name:st,start:ht,end:M}of this.times)H.push(`${st.padEnd(G)} ${M-ht}ms
`);return H.join("")}}m.StatTimer=i;function n(K,H){try{const{protocol:G}=H?new URL(K,H):new URL(K);return G==="http:"||G==="https:"}catch{return!1}}function t(K,H=!1){return new Promise((G,st)=>{const ht=document.createElement("script");ht.src=K,ht.onload=function(M){H&&ht.remove(),G(M)},ht.onerror=function(){st(new Error(`Cannot load script at: ${ht.src}`))},(document.head||document.documentElement).append(ht)})}function s(K){console.log("Deprecated API usage: "+K)}let p;class e{static toDateObject(H){if(!H||typeof H!="string")return null;p||(p=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const G=p.exec(H);if(!G)return null;const st=parseInt(G[1],10);let ht=parseInt(G[2],10);ht=ht>=1&&ht<=12?ht-1:0;let M=parseInt(G[3],10);M=M>=1&&M<=31?M:1;let h=parseInt(G[4],10);h=h>=0&&h<=23?h:0;let o=parseInt(G[5],10);o=o>=0&&o<=59?o:0;let v=parseInt(G[6],10);v=v>=0&&v<=59?v:0;const R=G[7]||"Z";let D=parseInt(G[8],10);D=D>=0&&D<=23?D:0;let k=parseInt(G[9],10)||0;return k=k>=0&&k<=59?k:0,R==="-"?(h+=D,o+=k):R==="+"&&(h-=D,o-=k),new Date(Date.UTC(st,ht,M,h,o,v))}}m.PDFDateString=e;function y(K,{scale:H=1,rotation:G=0}){const{width:st,height:ht}=K.attributes.style,M=[0,0,parseInt(st),parseInt(ht)];return new A({viewBox:M,scale:H,rotation:G})}function O(K){if(K.startsWith("#")){const H=parseInt(K.slice(1),16);return[(H&16711680)>>16,(H&65280)>>8,H&255]}return K.startsWith("rgb(")?K.slice(4,-1).split(",").map(H=>parseInt(H)):K.startsWith("rgba(")?K.slice(5,-1).split(",").map(H=>parseInt(H)).slice(0,3):((0,w.warn)(`Not a valid color format: "${K}"`),[0,0,0])}function W(K){const H=document.createElement("span");H.style.visibility="hidden",document.body.append(H);for(const G of K.keys()){H.style.color=G;const st=window.getComputedStyle(H).color;K.set(G,O(st))}H.remove()}function tt(K){const{a:H,b:G,c:st,d:ht,e:M,f:h}=K.getTransform();return[H,G,st,ht,M,h]}function gt(K){const{a:H,b:G,c:st,d:ht,e:M,f:h}=K.getTransform().invertSelf();return[H,G,st,ht,M,h]}function rt(K,H,G=!1,st=!0){if(H instanceof A){const{pageWidth:ht,pageHeight:M}=H.rawDims,{style:h}=K,o=`calc(var(--scale-factor) * ${ht}px)`,v=`calc(var(--scale-factor) * ${M}px)`;!G||H.rotation%180===0?(h.width=o,h.height=v):(h.width=v,h.height=o)}st&&K.setAttribute("data-main-rotation",H.rotation)}},(ot,m,Q)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.BaseStandardFontDataFactory=m.BaseSVGFactory=m.BaseCanvasFactory=m.BaseCMapReaderFactory=void 0;var b=Q(1);class w{constructor(){this.constructor===w&&(0,b.unreachable)("Cannot initialize BaseCanvasFactory.")}create(S,P){if(S<=0||P<=0)throw new Error("Invalid canvas size");const L=this._createCanvas(S,P);return{canvas:L,context:L.getContext("2d")}}reset(S,P,L){if(!S.canvas)throw new Error("Canvas is not specified");if(P<=0||L<=0)throw new Error("Invalid canvas size");S.canvas.width=P,S.canvas.height=L}destroy(S){if(!S.canvas)throw new Error("Canvas is not specified");S.canvas.width=0,S.canvas.height=0,S.canvas=null,S.context=null}_createCanvas(S,P){(0,b.unreachable)("Abstract method `_createCanvas` called.")}}m.BaseCanvasFactory=w;class Y{constructor({baseUrl:S=null,isCompressed:P=!0}){this.constructor===Y&&(0,b.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=S,this.isCompressed=P}async fetch({name:S}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!S)throw new Error("CMap name must be specified.");const P=this.baseUrl+S+(this.isCompressed?".bcmap":""),L=this.isCompressed?b.CMapCompressionType.BINARY:b.CMapCompressionType.NONE;return this._fetchData(P,L).catch(T=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${P}`)})}_fetchData(S,P){(0,b.unreachable)("Abstract method `_fetchData` called.")}}m.BaseCMapReaderFactory=Y;class z{constructor({baseUrl:S=null}){this.constructor===z&&(0,b.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=S}async fetch({filename:S}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!S)throw new Error("Font filename must be specified.");const P=`${this.baseUrl}${S}`;return this._fetchData(P).catch(L=>{throw new Error(`Unable to load font data at: ${P}`)})}_fetchData(S){(0,b.unreachable)("Abstract method `_fetchData` called.")}}m.BaseStandardFontDataFactory=z;class et{constructor(){this.constructor===et&&(0,b.unreachable)("Cannot initialize BaseSVGFactory.")}create(S,P,L=!1){if(S<=0||P<=0)throw new Error("Invalid SVG dimensions");const T=this._createSVG("svg:svg");return T.setAttribute("version","1.1"),L||(T.setAttribute("width",`${S}px`),T.setAttribute("height",`${P}px`)),T.setAttribute("preserveAspectRatio","none"),T.setAttribute("viewBox",`0 0 ${S} ${P}`),T}createElement(S){if(typeof S!="string")throw new Error("Invalid SVG element type");return this._createSVG(S)}_createSVG(S){(0,b.unreachable)("Abstract method `_createSVG` called.")}}m.BaseSVGFactory=et},(ot,m,Q)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.MurmurHash3_64=void 0;var b=Q(1);const w=3285377520,Y=4294901760,z=65535;class et{constructor(S){this.h1=S?S&4294967295:w,this.h2=S?S&4294967295:w}update(S){let P,L;if(typeof S=="string"){P=new Uint8Array(S.length*2),L=0;for(let p=0,e=S.length;p<e;p++){const y=S.charCodeAt(p);y<=255?P[L++]=y:(P[L++]=y>>>8,P[L++]=y&255)}}else if((0,b.isArrayBuffer)(S))P=S.slice(),L=P.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const T=L>>2,A=L-T*4,g=new Uint32Array(P.buffer,0,T);let f=0,r=0,c=this.h1,u=this.h2;const i=3432918353,n=461845907,t=i&z,s=n&z;for(let p=0;p<T;p++)p&1?(f=g[p],f=f*i&Y|f*t&z,f=f<<15|f>>>17,f=f*n&Y|f*s&z,c^=f,c=c<<13|c>>>19,c=c*5+3864292196):(r=g[p],r=r*i&Y|r*t&z,r=r<<15|r>>>17,r=r*n&Y|r*s&z,u^=r,u=u<<13|u>>>19,u=u*5+3864292196);switch(f=0,A){case 3:f^=P[T*4+2]<<16;case 2:f^=P[T*4+1]<<8;case 1:f^=P[T*4],f=f*i&Y|f*t&z,f=f<<15|f>>>17,f=f*n&Y|f*s&z,T&1?c^=f:u^=f}this.h1=c,this.h2=u}hexdigest(){let S=this.h1,P=this.h2;return S^=P>>>1,S=S*3981806797&Y|S*36045&z,P=P*4283543511&Y|((P<<16|S>>>16)*2950163797&Y)>>>16,S^=P>>>1,S=S*444984403&Y|S*60499&z,P=P*3301882366&Y|((P<<16|S>>>16)*3120437893&Y)>>>16,S^=P>>>1,(S>>>0).toString(16).padStart(8,"0")+(P>>>0).toString(16).padStart(8,"0")}}m.MurmurHash3_64=et},(ot,m,Q)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.FontLoader=m.FontFaceObject=void 0;var b=Q(1),w=Q(10);class Y{constructor({onUnsupportedFeature:B,ownerDocument:S=globalThis.document,styleElement:P=null}){this._onUnsupportedFeature=B,this._document=S,this.nativeFontFaces=[],this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(B){this.nativeFontFaces.push(B),this._document.fonts.add(B)}insertRule(B){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const S=this.styleElement.sheet;S.insertRule(B,S.cssRules.length)}clear(){for(const B of this.nativeFontFaces)this._document.fonts.delete(B);this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async bind(B){if(B.attached||B.missingFile)return;if(B.attached=!0,this.isFontLoadingAPISupported){const P=B.createNativeFontFace();if(P){this.addNativeFontFace(P);try{await P.loaded}catch(L){throw this._onUnsupportedFeature({featureId:b.UNSUPPORTED_FEATURES.errorFontLoadNative}),(0,b.warn)(`Failed to load font '${P.family}': '${L}'.`),B.disableFontFace=!0,L}}return}const S=B.createFontFaceRule();if(S){if(this.insertRule(S),this.isSyncFontLoadingSupported)return;await new Promise(P=>{const L=this._queueLoadingCallback(P);this._prepareFontLoadEvent(B,L)})}}get isFontLoadingAPISupported(){var S;const B=!!((S=this._document)!=null&&S.fonts);return(0,b.shadow)(this,"isFontLoadingAPISupported",B)}get isSyncFontLoadingSupported(){let B=!1;return(w.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(B=!0),(0,b.shadow)(this,"isSyncFontLoadingSupported",B)}_queueLoadingCallback(B){function S(){for((0,b.assert)(!L.done,"completeRequest() cannot be called twice."),L.done=!0;P.length>0&&P[0].done;){const T=P.shift();setTimeout(T.callback,0)}}const{loadingRequests:P}=this,L={done:!1,complete:S,callback:B};return P.push(L),L}get _loadTestFont(){const B=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,b.shadow)(this,"_loadTestFont",B)}_prepareFontLoadEvent(B,S){function P(W,tt){return W.charCodeAt(tt)<<24|W.charCodeAt(tt+1)<<16|W.charCodeAt(tt+2)<<8|W.charCodeAt(tt+3)&255}function L(W,tt,gt,rt){const ct=W.substring(0,tt),K=W.substring(tt+gt);return ct+rt+K}let T,A;const g=this._document.createElement("canvas");g.width=1,g.height=1;const f=g.getContext("2d");let r=0;function c(W,tt){if(++r>30){(0,b.warn)("Load test font never loaded."),tt();return}if(f.font="30px "+W,f.fillText(".",0,20),f.getImageData(0,0,1,1).data[3]>0){tt();return}setTimeout(c.bind(null,W,tt))}const u=`lt${Date.now()}${this.loadTestFontId++}`;let i=this._loadTestFont;i=L(i,976,u.length,u);const t=16,s=1482184792;let p=P(i,t);for(T=0,A=u.length-3;T<A;T+=4)p=p-s+P(u,T)|0;T<u.length&&(p=p-s+P(u+"XXX",T)|0),i=L(i,t,4,(0,b.string32)(p));const e=`url(data:font/opentype;base64,${btoa(i)});`,y=`@font-face {font-family:"${u}";src:${e}}`;this.insertRule(y);const O=this._document.createElement("div");O.style.visibility="hidden",O.style.width=O.style.height="10px",O.style.position="absolute",O.style.top=O.style.left="0px";for(const W of[B.loadedName,u]){const tt=this._document.createElement("span");tt.textContent="Hi",tt.style.fontFamily=W,O.append(tt)}this._document.body.append(O),c(u,()=>{O.remove(),S.complete()})}}m.FontLoader=Y;class z{constructor(B,{isEvalSupported:S=!0,disableFontFace:P=!1,ignoreErrors:L=!1,onUnsupportedFeature:T,fontRegistry:A=null}){this.compiledGlyphs=Object.create(null);for(const g in B)this[g]=B[g];this.isEvalSupported=S!==!1,this.disableFontFace=P===!0,this.ignoreErrors=L===!0,this._onUnsupportedFeature=T,this.fontRegistry=A}createNativeFontFace(){var S;if(!this.data||this.disableFontFace)return null;let B;if(!this.cssFontInfo)B=new FontFace(this.loadedName,this.data,{});else{const P={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(P.style=`oblique ${this.cssFontInfo.italicAngle}deg`),B=new FontFace(this.cssFontInfo.fontFamily,this.data,P)}return(S=this.fontRegistry)==null||S.registerFont(this),B}createFontFaceRule(){var L;if(!this.data||this.disableFontFace)return null;const B=(0,b.bytesToString)(this.data),S=`url(data:${this.mimetype};base64,${btoa(B)});`;let P;if(!this.cssFontInfo)P=`@font-face {font-family:"${this.loadedName}";src:${S}}`;else{let T=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(T+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),P=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${T}src:${S}}`}return(L=this.fontRegistry)==null||L.registerFont(this,S),P}getPathGenerator(B,S){if(this.compiledGlyphs[S]!==void 0)return this.compiledGlyphs[S];let P;try{P=B.get(this.loadedName+"_path_"+S)}catch(L){if(!this.ignoreErrors)throw L;return this._onUnsupportedFeature({featureId:b.UNSUPPORTED_FEATURES.errorFontGetPath}),(0,b.warn)(`getPathGenerator - ignoring character: "${L}".`),this.compiledGlyphs[S]=function(T,A){}}if(this.isEvalSupported&&b.FeatureTest.isEvalSupported){const L=[];for(const T of P){const A=T.args!==void 0?T.args.join(","):"";L.push("c.",T.cmd,"(",A,`);
`)}return this.compiledGlyphs[S]=new Function("c","size",L.join(""))}return this.compiledGlyphs[S]=function(L,T){for(const A of P)A.cmd==="scale"&&(A.args=[T,-T]),L[A.cmd].apply(L,A.args)}}}m.FontFaceObject=z},(ot,m)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.isNodeJS=void 0;const Q=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");m.isNodeJS=Q},(ot,m,Q)=>{var G,re;Object.defineProperty(m,"__esModule",{value:!0}),m.CanvasGraphics=void 0;var b=Q(1),w=Q(6),Y=Q(12),z=Q(13);const et=16,B=100,S=4096,P=15,L=10,T=1e3,A=16;function g(M,h){if(M._removeMirroring)throw new Error("Context is already forwarding operations.");M.__originalSave=M.save,M.__originalRestore=M.restore,M.__originalRotate=M.rotate,M.__originalScale=M.scale,M.__originalTranslate=M.translate,M.__originalTransform=M.transform,M.__originalSetTransform=M.setTransform,M.__originalResetTransform=M.resetTransform,M.__originalClip=M.clip,M.__originalMoveTo=M.moveTo,M.__originalLineTo=M.lineTo,M.__originalBezierCurveTo=M.bezierCurveTo,M.__originalRect=M.rect,M.__originalClosePath=M.closePath,M.__originalBeginPath=M.beginPath,M._removeMirroring=()=>{M.save=M.__originalSave,M.restore=M.__originalRestore,M.rotate=M.__originalRotate,M.scale=M.__originalScale,M.translate=M.__originalTranslate,M.transform=M.__originalTransform,M.setTransform=M.__originalSetTransform,M.resetTransform=M.__originalResetTransform,M.clip=M.__originalClip,M.moveTo=M.__originalMoveTo,M.lineTo=M.__originalLineTo,M.bezierCurveTo=M.__originalBezierCurveTo,M.rect=M.__originalRect,M.closePath=M.__originalClosePath,M.beginPath=M.__originalBeginPath,delete M._removeMirroring},M.save=function(){h.save(),this.__originalSave()},M.restore=function(){h.restore(),this.__originalRestore()},M.translate=function(v,R){h.translate(v,R),this.__originalTranslate(v,R)},M.scale=function(v,R){h.scale(v,R),this.__originalScale(v,R)},M.transform=function(v,R,D,k,q,J){h.transform(v,R,D,k,q,J),this.__originalTransform(v,R,D,k,q,J)},M.setTransform=function(v,R,D,k,q,J){h.setTransform(v,R,D,k,q,J),this.__originalSetTransform(v,R,D,k,q,J)},M.resetTransform=function(){h.resetTransform(),this.__originalResetTransform()},M.rotate=function(v){h.rotate(v),this.__originalRotate(v)},M.clip=function(v){h.clip(v),this.__originalClip(v)},M.moveTo=function(o,v){h.moveTo(o,v),this.__originalMoveTo(o,v)},M.lineTo=function(o,v){h.lineTo(o,v),this.__originalLineTo(o,v)},M.bezierCurveTo=function(o,v,R,D,k,q){h.bezierCurveTo(o,v,R,D,k,q),this.__originalBezierCurveTo(o,v,R,D,k,q)},M.rect=function(o,v,R,D){h.rect(o,v,R,D),this.__originalRect(o,v,R,D)},M.closePath=function(){h.closePath(),this.__originalClosePath()},M.beginPath=function(){h.beginPath(),this.__originalBeginPath()}}class f{constructor(h){this.canvasFactory=h,this.cache=Object.create(null)}getCanvas(h,o,v){let R;return this.cache[h]!==void 0?(R=this.cache[h],this.canvasFactory.reset(R,o,v)):(R=this.canvasFactory.create(o,v),this.cache[h]=R),R}delete(h){delete this.cache[h]}clear(){for(const h in this.cache){const o=this.cache[h];this.canvasFactory.destroy(o),delete this.cache[h]}}}function r(M,h,o,v,R,D,k,q,J,nt){const[$,a,l,E,C,d]=(0,w.getCurrentTransform)(M);if(a===0&&l===0){const j=k*$+C,Z=Math.round(j),x=q*E+d,U=Math.round(x),I=(k+J)*$+C,it=Math.abs(Math.round(I)-Z)||1,dt=(q+nt)*E+d,ft=Math.abs(Math.round(dt)-U)||1;return M.setTransform(Math.sign($),0,0,Math.sign(E),Z,U),M.drawImage(h,o,v,R,D,0,0,it,ft),M.setTransform($,a,l,E,C,d),[it,ft]}if($===0&&E===0){const j=q*l+C,Z=Math.round(j),x=k*a+d,U=Math.round(x),I=(q+nt)*l+C,it=Math.abs(Math.round(I)-Z)||1,dt=(k+J)*a+d,ft=Math.abs(Math.round(dt)-U)||1;return M.setTransform(0,Math.sign(a),Math.sign(l),0,Z,U),M.drawImage(h,o,v,R,D,0,0,ft,it),M.setTransform($,a,l,E,C,d),[ft,it]}M.drawImage(h,o,v,R,D,k,q,J,nt);const F=Math.hypot($,a),N=Math.hypot(l,E);return[F*J,N*nt]}function c(M){const{width:h,height:o}=M;if(h>T||o>T)return null;const v=1e3,R=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),D=h+1;let k=new Uint8Array(D*(o+1)),q,J,nt;const $=h+7&-8;let a=new Uint8Array($*o),l=0;for(const N of M.data){let j=128;for(;j>0;)a[l++]=N&j?0:255,j>>=1}let E=0;for(l=0,a[l]!==0&&(k[0]=1,++E),J=1;J<h;J++)a[l]!==a[l+1]&&(k[J]=a[l]?2:1,++E),l++;for(a[l]!==0&&(k[J]=2,++E),q=1;q<o;q++){l=q*$,nt=q*D,a[l-$]!==a[l]&&(k[nt]=a[l]?1:8,++E);let N=(a[l]?4:0)+(a[l-$]?8:0);for(J=1;J<h;J++)N=(N>>2)+(a[l+1]?4:0)+(a[l-$+1]?8:0),R[N]&&(k[nt+J]=R[N],++E),l++;if(a[l-$]!==a[l]&&(k[nt+J]=a[l]?2:4,++E),E>v)return null}for(l=$*(o-1),nt=q*D,a[l]!==0&&(k[nt]=8,++E),J=1;J<h;J++)a[l]!==a[l+1]&&(k[nt+J]=a[l]?4:8,++E),l++;if(a[l]!==0&&(k[nt+J]=4,++E),E>v)return null;const C=new Int32Array([0,D,-1,0,-D,0,0,0,1]),d=new Path2D;for(q=0;E&&q<=o;q++){let N=q*D;const j=N+h;for(;N<j&&!k[N];)N++;if(N===j)continue;d.moveTo(N%D,q);const Z=N;let x=k[N];do{const U=C[x];do N+=U;while(!k[N]);const I=k[N];I!==5&&I!==10?(x=I,k[N]=0):(x=I&51*x>>4,k[N]&=x>>2|x<<2),d.lineTo(N%D,N/D|0),k[N]||--E}while(Z!==N);--q}return a=null,k=null,function(N){N.save(),N.scale(1/h,-1/o),N.translate(0,-o),N.fill(d),N.beginPath(),N.restore()}}class u{constructor(h,o){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=b.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=b.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=b.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps=null,this.startNewPathAndClipBox([0,0,h,o])}clone(){const h=Object.create(this);return h.clipBox=this.clipBox.slice(),h}setCurrentPoint(h,o){this.x=h,this.y=o}updatePathMinMax(h,o,v){[o,v]=b.Util.applyTransform([o,v],h),this.minX=Math.min(this.minX,o),this.minY=Math.min(this.minY,v),this.maxX=Math.max(this.maxX,o),this.maxY=Math.max(this.maxY,v)}updateRectMinMax(h,o){const v=b.Util.applyTransform(o,h),R=b.Util.applyTransform(o.slice(2),h);this.minX=Math.min(this.minX,v[0],R[0]),this.minY=Math.min(this.minY,v[1],R[1]),this.maxX=Math.max(this.maxX,v[0],R[0]),this.maxY=Math.max(this.maxY,v[1],R[1])}updateScalingPathMinMax(h,o){b.Util.scaleMinMax(h,o),this.minX=Math.min(this.minX,o[0]),this.maxX=Math.max(this.maxX,o[1]),this.minY=Math.min(this.minY,o[2]),this.maxY=Math.max(this.maxY,o[3])}updateCurvePathMinMax(h,o,v,R,D,k,q,J,nt,$){const a=b.Util.bezierBoundingBox(o,v,R,D,k,q,J,nt);if($){$[0]=Math.min($[0],a[0],a[2]),$[1]=Math.max($[1],a[0],a[2]),$[2]=Math.min($[2],a[1],a[3]),$[3]=Math.max($[3],a[1],a[3]);return}this.updateRectMinMax(h,a)}getPathBoundingBox(h=Y.PathType.FILL,o=null){const v=[this.minX,this.minY,this.maxX,this.maxY];if(h===Y.PathType.STROKE){o||(0,b.unreachable)("Stroke bounding box must include transform.");const R=b.Util.singularValueDecompose2dScale(o),D=R[0]*this.lineWidth/2,k=R[1]*this.lineWidth/2;v[0]-=D,v[1]-=k,v[2]+=D,v[3]+=k}return v}updateClipFromPath(){const h=b.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(h||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(h){this.clipBox=h,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(h=Y.PathType.FILL,o=null){return b.Util.intersect(this.clipBox,this.getPathBoundingBox(h,o))}}function i(M,h,o=null){if(typeof ImageData<"u"&&h instanceof ImageData){M.putImageData(h,0,0);return}const v=h.height,R=h.width,D=v%A,k=(v-D)/A,q=D===0?k:k+1,J=M.createImageData(R,A);let nt=0,$;const a=h.data,l=J.data;let E,C,d,F,N,j,Z,x;if(o)switch(o.length){case 1:N=o[0],j=o[0],Z=o[0],x=o[0];break;case 4:N=o[0],j=o[1],Z=o[2],x=o[3];break}if(h.kind===b.ImageKind.GRAYSCALE_1BPP){const U=a.byteLength,I=new Uint32Array(l.buffer,0,l.byteLength>>2),it=I.length,dt=R+7>>3;let ft=4294967295,bt=b.FeatureTest.isLittleEndian?4278190080:255;for(x&&x[0]===255&&x[255]===0&&([ft,bt]=[bt,ft]),E=0;E<q;E++){for(d=E<k?A:D,$=0,C=0;C<d;C++){const _t=U-nt;let yt=0;const vt=_t>dt?R:_t*8-7,at=vt&-8;let V=0,X=0;for(;yt<at;yt+=8)X=a[nt++],I[$++]=X&128?ft:bt,I[$++]=X&64?ft:bt,I[$++]=X&32?ft:bt,I[$++]=X&16?ft:bt,I[$++]=X&8?ft:bt,I[$++]=X&4?ft:bt,I[$++]=X&2?ft:bt,I[$++]=X&1?ft:bt;for(;yt<vt;yt++)V===0&&(X=a[nt++],V=128),I[$++]=X&V?ft:bt,V>>=1}for(;$<it;)I[$++]=0;M.putImageData(J,0,E*A)}}else if(h.kind===b.ImageKind.RGBA_32BPP){const U=!!(N||j||Z);for(C=0,F=R*A*4,E=0;E<k;E++){if(l.set(a.subarray(nt,nt+F)),nt+=F,U)for(let I=0;I<F;I+=4)N&&(l[I+0]=N[l[I+0]]),j&&(l[I+1]=j[l[I+1]]),Z&&(l[I+2]=Z[l[I+2]]);M.putImageData(J,0,C),C+=A}if(E<q){if(F=R*D*4,l.set(a.subarray(nt,nt+F)),U)for(let I=0;I<F;I+=4)N&&(l[I+0]=N[l[I+0]]),j&&(l[I+1]=j[l[I+1]]),Z&&(l[I+2]=Z[l[I+2]]);M.putImageData(J,0,C)}}else if(h.kind===b.ImageKind.RGB_24BPP){const U=!!(N||j||Z);for(d=A,F=R*d,E=0;E<q;E++){for(E>=k&&(d=D,F=R*d),$=0,C=F;C--;)l[$++]=a[nt++],l[$++]=a[nt++],l[$++]=a[nt++],l[$++]=255;if(U)for(let I=0;I<$;I+=4)N&&(l[I+0]=N[l[I+0]]),j&&(l[I+1]=j[l[I+1]]),Z&&(l[I+2]=Z[l[I+2]]);M.putImageData(J,0,E*A)}}else throw new Error(`bad image kind: ${h.kind}`)}function n(M,h){if(h.bitmap){M.drawImage(h.bitmap,0,0);return}const o=h.height,v=h.width,R=o%A,D=(o-R)/A,k=R===0?D:D+1,q=M.createImageData(v,A);let J=0;const nt=h.data,$=q.data;for(let a=0;a<k;a++){const l=a<D?A:R;({srcPos:J}=(0,z.applyMaskImageData)({src:nt,srcPos:J,dest:$,width:v,height:l})),M.putImageData(q,0,a*A)}}function t(M,h){const o=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font"];for(const v of o)M[v]!==void 0&&(h[v]=M[v]);M.setLineDash!==void 0&&(h.setLineDash(M.getLineDash()),h.lineDashOffset=M.lineDashOffset)}function s(M,h){M.strokeStyle=M.fillStyle=h||"#000000",M.fillRule="nonzero",M.globalAlpha=1,M.lineWidth=1,M.lineCap="butt",M.lineJoin="miter",M.miterLimit=10,M.globalCompositeOperation="source-over",M.font="10px sans-serif",M.setLineDash!==void 0&&(M.setLineDash([]),M.lineDashOffset=0)}function p(M,h,o,v){const R=M.length;for(let D=3;D<R;D+=4){const k=M[D];if(k===0)M[D-3]=h,M[D-2]=o,M[D-1]=v;else if(k<255){const q=255-k;M[D-3]=M[D-3]*k+h*q>>8,M[D-2]=M[D-2]*k+o*q>>8,M[D-1]=M[D-1]*k+v*q>>8}}}function e(M,h,o){const v=M.length,R=1/255;for(let D=3;D<v;D+=4){const k=o?o[M[D]]:M[D];h[D]=h[D]*k*R|0}}function y(M,h,o){const v=M.length;for(let R=3;R<v;R+=4){const D=M[R-3]*77+M[R-2]*152+M[R-1]*28;h[R]=o?h[R]*o[D>>8]>>8:h[R]*D>>16}}function O(M,h,o,v,R,D,k,q,J,nt,$){const a=!!D,l=a?D[0]:0,E=a?D[1]:0,C=a?D[2]:0;let d;R==="Luminosity"?d=y:d=e;const N=Math.min(v,Math.ceil(1048576/o));for(let j=0;j<v;j+=N){const Z=Math.min(N,v-j),x=M.getImageData(q-nt,j+(J-$),o,Z),U=h.getImageData(q,j+J,o,Z);a&&p(x.data,l,E,C),d(x.data,U.data,k),h.putImageData(U,q,j+J)}}function W(M,h,o,v){const R=v[0],D=v[1],k=v[2]-R,q=v[3]-D;k===0||q===0||(O(h.context,o,k,q,h.subtype,h.backdrop,h.transferMap,R,D,h.offsetX,h.offsetY),M.save(),M.globalAlpha=1,M.globalCompositeOperation="source-over",M.setTransform(1,0,0,1,0,0),M.drawImage(o.canvas,0,0),M.restore())}function tt(M,h){const o=b.Util.singularValueDecompose2dScale(M);o[0]=Math.fround(o[0]),o[1]=Math.fround(o[1]);const v=Math.fround((globalThis.devicePixelRatio||1)*w.PixelsPerInch.PDF_TO_CSS_UNITS);return h!==void 0?h:o[0]<=v||o[1]<=v}const gt=["butt","round","square"],rt=["miter","round","bevel"],ct={},K={},ht=class ht{constructor(h,o,v,R,{optionalContentConfig:D,markedContentStack:k=null},q,J){ut(this,G);this.ctx=h,this.current=new u(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=o,this.objs=v,this.canvasFactory=R,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=k||[],this.optionalContentConfig=D,this.cachedCanvases=new f(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=q,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.backgroundColor=(J==null?void 0:J.background)||null,this.foregroundColor=(J==null?void 0:J.foreground)||null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(h,o=null){return typeof h=="string"?h.startsWith("g_")?this.commonObjs.get(h):this.objs.get(h):o}beginDrawing({transform:h,viewport:o,transparency:v=!1,background:R=null}){const D=this.ctx.canvas.width,k=this.ctx.canvas.height,q=R||"#ffffff";if(this.ctx.save(),this.foregroundColor&&this.backgroundColor){this.ctx.fillStyle=this.foregroundColor;const J=this.foregroundColor=this.ctx.fillStyle;this.ctx.fillStyle=this.backgroundColor;const nt=this.backgroundColor=this.ctx.fillStyle;let $=!0,a=q;if(this.ctx.fillStyle=q,a=this.ctx.fillStyle,$=typeof a=="string"&&/^#[0-9A-Fa-f]{6}$/.test(a),J==="#000000"&&nt==="#ffffff"||J===nt||!$)this.foregroundColor=this.backgroundColor=null;else{const[l,E,C]=(0,w.getRGB)(a),d=N=>(N/=255,N<=.03928?N/12.92:((N+.055)/1.055)**2.4),F=Math.round(.2126*d(l)+.7152*d(E)+.0722*d(C));this.selectColor=(N,j,Z)=>{const x=.2126*d(N)+.7152*d(j)+.0722*d(Z);return Math.round(x)===F?nt:J}}}if(this.ctx.fillStyle=this.backgroundColor||q,this.ctx.fillRect(0,0,D,k),this.ctx.restore(),v){const J=this.cachedCanvases.getCanvas("transparent",D,k);this.compositeCtx=this.ctx,this.transparentCanvas=J.canvas,this.ctx=J.context,this.ctx.save(),this.ctx.transform(...(0,w.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),s(this.ctx,this.foregroundColor),h&&(this.ctx.transform(...h),this.outputScaleX=h[0],this.outputScaleY=h[0]),this.ctx.transform(...o.transform),this.viewportScale=o.scale,this.baseTransform=(0,w.getCurrentTransform)(this.ctx)}executeOperatorList(h,o,v,R){const D=h.argsArray,k=h.fnArray;let q=o||0;const J=D.length;if(J===q)return q;const nt=J-q>L&&typeof v=="function",$=nt?Date.now()+P:0;let a=0;const l=this.commonObjs,E=this.objs;let C;for(;;){if(R!==void 0&&q===R.nextBreakPoint)return R.breakIt(q,v),q;if(C=k[q],C!==b.OPS.dependency)this[C].apply(this,D[q]);else for(const d of D[q]){const F=d.startsWith("g_")?l:E;if(!F.has(d))return F.get(d,v),q}if(q++,q===J)return q;if(nt&&++a>L){if(Date.now()>$)return v(),q;a=0}}}endDrawing(){lt(this,G,re).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const h of this._cachedBitmapsMap.values()){for(const o of h.values())typeof HTMLCanvasElement<"u"&&o instanceof HTMLCanvasElement&&(o.width=o.height=0);h.clear()}this._cachedBitmapsMap.clear()}_scaleImage(h,o){const v=h.width,R=h.height;let D=Math.max(Math.hypot(o[0],o[1]),1),k=Math.max(Math.hypot(o[2],o[3]),1),q=v,J=R,nt="prescale1",$,a;for(;D>2&&q>1||k>2&&J>1;){let l=q,E=J;D>2&&q>1&&(l=Math.ceil(q/2),D/=q/l),k>2&&J>1&&(E=Math.ceil(J/2),k/=J/E),$=this.cachedCanvases.getCanvas(nt,l,E),a=$.context,a.clearRect(0,0,l,E),a.drawImage(h,0,0,q,J,0,0,l,E),h=$.canvas,q=l,J=E,nt=nt==="prescale1"?"prescale2":"prescale1"}return{img:h,paintWidth:q,paintHeight:J}}_createMaskCanvas(h){const o=this.ctx,{width:v,height:R}=h,D=this.current.fillColor,k=this.current.patternFill,q=(0,w.getCurrentTransform)(o);let J,nt,$,a;if((h.bitmap||h.data)&&h.count>1){const it=h.bitmap||h.data.buffer;nt=JSON.stringify(k?q:[q.slice(0,4),D]),J=this._cachedBitmapsMap.get(it),J||(J=new Map,this._cachedBitmapsMap.set(it,J));const dt=J.get(nt);if(dt&&!k){const ft=Math.round(Math.min(q[0],q[2])+q[4]),bt=Math.round(Math.min(q[1],q[3])+q[5]);return{canvas:dt,offsetX:ft,offsetY:bt}}$=dt}$||(a=this.cachedCanvases.getCanvas("maskCanvas",v,R),n(a.context,h));let l=b.Util.transform(q,[1/v,0,0,-1/R,0,0]);l=b.Util.transform(l,[1,0,0,1,0,-R]);const E=b.Util.applyTransform([0,0],l),C=b.Util.applyTransform([v,R],l),d=b.Util.normalizeRect([E[0],E[1],C[0],C[1]]),F=Math.round(d[2]-d[0])||1,N=Math.round(d[3]-d[1])||1,j=this.cachedCanvases.getCanvas("fillCanvas",F,N),Z=j.context,x=Math.min(E[0],C[0]),U=Math.min(E[1],C[1]);Z.translate(-x,-U),Z.transform(...l),$||($=this._scaleImage(a.canvas,(0,w.getCurrentTransformInverse)(Z)),$=$.img,J&&k&&J.set(nt,$)),Z.imageSmoothingEnabled=tt((0,w.getCurrentTransform)(Z),h.interpolate),r(Z,$,0,0,$.width,$.height,0,0,v,R),Z.globalCompositeOperation="source-in";const I=b.Util.transform((0,w.getCurrentTransformInverse)(Z),[1,0,0,1,-x,-U]);return Z.fillStyle=k?D.getPattern(o,this,I,Y.PathType.FILL):D,Z.fillRect(0,0,v,R),J&&!k&&(this.cachedCanvases.delete("fillCanvas"),J.set(nt,j.canvas)),{canvas:j.canvas,offsetX:Math.round(x),offsetY:Math.round(U)}}setLineWidth(h){h!==this.current.lineWidth&&(this._cachedScaleForStroking=null),this.current.lineWidth=h,this.ctx.lineWidth=h}setLineCap(h){this.ctx.lineCap=gt[h]}setLineJoin(h){this.ctx.lineJoin=rt[h]}setMiterLimit(h){this.ctx.miterLimit=h}setDash(h,o){const v=this.ctx;v.setLineDash!==void 0&&(v.setLineDash(h),v.lineDashOffset=o)}setRenderingIntent(h){}setFlatness(h){}setGState(h){for(const[o,v]of h)switch(o){case"LW":this.setLineWidth(v);break;case"LC":this.setLineCap(v);break;case"LJ":this.setLineJoin(v);break;case"ML":this.setMiterLimit(v);break;case"D":this.setDash(v[0],v[1]);break;case"RI":this.setRenderingIntent(v);break;case"FL":this.setFlatness(v);break;case"Font":this.setFont(v[0],v[1]);break;case"CA":this.current.strokeAlpha=v;break;case"ca":this.current.fillAlpha=v,this.ctx.globalAlpha=v;break;case"BM":this.ctx.globalCompositeOperation=v;break;case"SMask":this.current.activeSMask=v?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.current.transferMaps=v}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const h=this.inSMaskMode;this.current.activeSMask&&!h?this.beginSMaskMode():!this.current.activeSMask&&h&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const h=this.ctx.canvas.width,o=this.ctx.canvas.height,v="smaskGroupAt"+this.groupLevel,R=this.cachedCanvases.getCanvas(v,h,o);this.suspendedCtx=this.ctx,this.ctx=R.context;const D=this.ctx;D.setTransform(...(0,w.getCurrentTransform)(this.suspendedCtx)),t(this.suspendedCtx,D),g(D,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),t(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(h){if(!this.current.activeSMask)return;h?(h[0]=Math.floor(h[0]),h[1]=Math.floor(h[1]),h[2]=Math.ceil(h[2]),h[3]=Math.ceil(h[3])):h=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const o=this.current.activeSMask,v=this.suspendedCtx;W(v,o,this.ctx,h),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(t(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const h=this.current;this.stateStack.push(h),this.current=h.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),t(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null)}transform(h,o,v,R,D,k){this.ctx.transform(h,o,v,R,D,k),this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null}constructPath(h,o,v){const R=this.ctx,D=this.current;let k=D.x,q=D.y,J,nt;const $=(0,w.getCurrentTransform)(R),a=$[0]===0&&$[3]===0||$[1]===0&&$[2]===0,l=a?v.slice(0):null;for(let E=0,C=0,d=h.length;E<d;E++)switch(h[E]|0){case b.OPS.rectangle:k=o[C++],q=o[C++];const F=o[C++],N=o[C++],j=k+F,Z=q+N;R.moveTo(k,q),F===0||N===0?R.lineTo(j,Z):(R.lineTo(j,q),R.lineTo(j,Z),R.lineTo(k,Z)),a||D.updateRectMinMax($,[k,q,j,Z]),R.closePath();break;case b.OPS.moveTo:k=o[C++],q=o[C++],R.moveTo(k,q),a||D.updatePathMinMax($,k,q);break;case b.OPS.lineTo:k=o[C++],q=o[C++],R.lineTo(k,q),a||D.updatePathMinMax($,k,q);break;case b.OPS.curveTo:J=k,nt=q,k=o[C+4],q=o[C+5],R.bezierCurveTo(o[C],o[C+1],o[C+2],o[C+3],k,q),D.updateCurvePathMinMax($,J,nt,o[C],o[C+1],o[C+2],o[C+3],k,q,l),C+=6;break;case b.OPS.curveTo2:J=k,nt=q,R.bezierCurveTo(k,q,o[C],o[C+1],o[C+2],o[C+3]),D.updateCurvePathMinMax($,J,nt,k,q,o[C],o[C+1],o[C+2],o[C+3],l),k=o[C+2],q=o[C+3],C+=4;break;case b.OPS.curveTo3:J=k,nt=q,k=o[C+2],q=o[C+3],R.bezierCurveTo(o[C],o[C+1],k,q,k,q),D.updateCurvePathMinMax($,J,nt,o[C],o[C+1],k,q,k,q,l),C+=4;break;case b.OPS.closePath:R.closePath();break}a&&D.updateScalingPathMinMax($,l),D.setCurrentPoint(k,q)}closePath(){this.ctx.closePath()}stroke(h=!0){const o=this.ctx,v=this.current.strokeColor;o.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof v=="object"&&(v!=null&&v.getPattern)?(o.save(),o.strokeStyle=v.getPattern(o,this,(0,w.getCurrentTransformInverse)(o),Y.PathType.STROKE),this.rescaleAndStroke(!1),o.restore()):this.rescaleAndStroke(!0)),h&&this.consumePath(this.current.getClippedPathBoundingBox()),o.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(h=!0){const o=this.ctx,v=this.current.fillColor,R=this.current.patternFill;let D=!1;R&&(o.save(),o.fillStyle=v.getPattern(o,this,(0,w.getCurrentTransformInverse)(o),Y.PathType.FILL),D=!0);const k=this.current.getClippedPathBoundingBox();this.contentVisible&&k!==null&&(this.pendingEOFill?(o.fill("evenodd"),this.pendingEOFill=!1):o.fill()),D&&o.restore(),h&&this.consumePath(k)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=ct}eoClip(){this.pendingClip=K}beginText(){this.current.textMatrix=b.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const h=this.pendingTextPaths,o=this.ctx;if(h===void 0){o.beginPath();return}o.save(),o.beginPath();for(const v of h)o.setTransform(...v.transform),o.translate(v.x,v.y),v.addToPath(o,v.fontSize);o.restore(),o.clip(),o.beginPath(),delete this.pendingTextPaths}setCharSpacing(h){this.current.charSpacing=h}setWordSpacing(h){this.current.wordSpacing=h}setHScale(h){this.current.textHScale=h/100}setLeading(h){this.current.leading=-h}setFont(h,o){const v=this.commonObjs.get(h),R=this.current;if(!v)throw new Error(`Can't find font for ${h}`);if(R.fontMatrix=v.fontMatrix||b.FONT_IDENTITY_MATRIX,(R.fontMatrix[0]===0||R.fontMatrix[3]===0)&&(0,b.warn)("Invalid font matrix for font "+h),o<0?(o=-o,R.fontDirection=-1):R.fontDirection=1,this.current.font=v,this.current.fontSize=o,v.isType3Font)return;const D=v.loadedName||"sans-serif";let k="normal";v.black?k="900":v.bold&&(k="bold");const q=v.italic?"italic":"normal",J=`"${D}", ${v.fallbackName}`;let nt=o;o<et?nt=et:o>B&&(nt=B),this.current.fontSizeScale=o/nt,this.ctx.font=`${q} ${k} ${nt}px ${J}`}setTextRenderingMode(h){this.current.textRenderingMode=h}setTextRise(h){this.current.textRise=h}moveText(h,o){this.current.x=this.current.lineX+=h,this.current.y=this.current.lineY+=o}setLeadingMoveText(h,o){this.setLeading(-o),this.moveText(h,o)}setTextMatrix(h,o,v,R,D,k){this.current.textMatrix=[h,o,v,R,D,k],this.current.textMatrixScale=Math.hypot(h,o),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(h,o,v,R){const D=this.ctx,k=this.current,q=k.font,J=k.textRenderingMode,nt=k.fontSize/k.fontSizeScale,$=J&b.TextRenderingMode.FILL_STROKE_MASK,a=!!(J&b.TextRenderingMode.ADD_TO_PATH_FLAG),l=k.patternFill&&!q.missingFile;let E;(q.disableFontFace||a||l)&&(E=q.getPathGenerator(this.commonObjs,h)),q.disableFontFace||l?(D.save(),D.translate(o,v),D.beginPath(),E(D,nt),R&&D.setTransform(...R),($===b.TextRenderingMode.FILL||$===b.TextRenderingMode.FILL_STROKE)&&D.fill(),($===b.TextRenderingMode.STROKE||$===b.TextRenderingMode.FILL_STROKE)&&D.stroke(),D.restore()):(($===b.TextRenderingMode.FILL||$===b.TextRenderingMode.FILL_STROKE)&&D.fillText(h,o,v),($===b.TextRenderingMode.STROKE||$===b.TextRenderingMode.FILL_STROKE)&&D.strokeText(h,o,v)),a&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,w.getCurrentTransform)(D),x:o,y:v,fontSize:nt,addToPath:E})}get isFontSubpixelAAEnabled(){const{context:h}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);h.scale(1.5,1),h.fillText("I",0,10);const o=h.getImageData(0,0,10,10).data;let v=!1;for(let R=3;R<o.length;R+=4)if(o[R]>0&&o[R]<255){v=!0;break}return(0,b.shadow)(this,"isFontSubpixelAAEnabled",v)}showText(h){const o=this.current,v=o.font;if(v.isType3Font)return this.showType3Text(h);const R=o.fontSize;if(R===0)return;const D=this.ctx,k=o.fontSizeScale,q=o.charSpacing,J=o.wordSpacing,nt=o.fontDirection,$=o.textHScale*nt,a=h.length,l=v.vertical,E=l?1:-1,C=v.defaultVMetrics,d=R*o.fontMatrix[0],F=o.textRenderingMode===b.TextRenderingMode.FILL&&!v.disableFontFace&&!o.patternFill;D.save(),D.transform(...o.textMatrix),D.translate(o.x,o.y+o.textRise),nt>0?D.scale($,-1):D.scale($,1);let N;if(o.patternFill){D.save();const I=o.fillColor.getPattern(D,this,(0,w.getCurrentTransformInverse)(D),Y.PathType.FILL);N=(0,w.getCurrentTransform)(D),D.restore(),D.fillStyle=I}let j=o.lineWidth;const Z=o.textMatrixScale;if(Z===0||j===0){const I=o.textRenderingMode&b.TextRenderingMode.FILL_STROKE_MASK;(I===b.TextRenderingMode.STROKE||I===b.TextRenderingMode.FILL_STROKE)&&(j=this.getSinglePixelWidth())}else j/=Z;if(k!==1&&(D.scale(k,k),j/=k),D.lineWidth=j,v.isInvalidPDFjsFont){const I=[];let it=0;for(const dt of h)I.push(dt.unicode),it+=dt.width;D.fillText(I.join(""),0,0),o.x+=it*d*$,D.restore(),this.compose();return}let x=0,U;for(U=0;U<a;++U){const I=h[U];if(typeof I=="number"){x+=E*I*R/1e3;continue}let it=!1;const dt=(I.isSpace?J:0)+q,ft=I.fontChar,bt=I.accent;let _t,yt,vt=I.width;if(l){const V=I.vmetric||C,X=-(I.vmetric?V[1]:vt*.5)*d,mt=V[2]*d;vt=V?-V[0]:vt,_t=X/k,yt=(x+mt)/k}else _t=x/k,yt=0;if(v.remeasure&&vt>0){const V=D.measureText(ft).width*1e3/R*k;if(vt<V&&this.isFontSubpixelAAEnabled){const X=vt/V;it=!0,D.save(),D.scale(X,1),_t/=X}else vt!==V&&(_t+=(vt-V)/2e3*R/k)}if(this.contentVisible&&(I.isInFont||v.missingFile)){if(F&&!bt)D.fillText(ft,_t,yt);else if(this.paintChar(ft,_t,yt,N),bt){const V=_t+R*bt.offset.x/k,X=yt-R*bt.offset.y/k;this.paintChar(bt.fontChar,V,X,N)}}let at;l?at=vt*d-dt*nt:at=vt*d+dt*nt,x+=at,it&&D.restore()}l?o.y-=x:o.x+=x*$,D.restore(),this.compose()}showType3Text(h){const o=this.ctx,v=this.current,R=v.font,D=v.fontSize,k=v.fontDirection,q=R.vertical?1:-1,J=v.charSpacing,nt=v.wordSpacing,$=v.textHScale*k,a=v.fontMatrix||b.FONT_IDENTITY_MATRIX,l=h.length,E=v.textRenderingMode===b.TextRenderingMode.INVISIBLE;let C,d,F,N;if(!(E||D===0)){for(this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,o.save(),o.transform(...v.textMatrix),o.translate(v.x,v.y),o.scale($,k),C=0;C<l;++C){if(d=h[C],typeof d=="number"){N=q*d*D/1e3,this.ctx.translate(N,0),v.x+=N*$;continue}const j=(d.isSpace?nt:0)+J,Z=R.charProcOperatorList[d.operatorListId];if(!Z){(0,b.warn)(`Type3 character "${d.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=d,this.save(),o.scale(D,D),o.transform(...a),this.executeOperatorList(Z),this.restore()),F=b.Util.applyTransform([d.width,0],a)[0]*D+j,o.translate(F,0),v.x+=F*$}o.restore(),this.processingType3=null}}setCharWidth(h,o){}setCharWidthAndBounds(h,o,v,R,D,k){this.ctx.rect(v,R,D-v,k-R),this.ctx.clip(),this.endPath()}getColorN_Pattern(h){let o;if(h[0]==="TilingPattern"){const v=h[1],R=this.baseTransform||(0,w.getCurrentTransform)(this.ctx),D={createCanvasGraphics:k=>new ht(k,this.commonObjs,this.objs,this.canvasFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};o=new Y.TilingPattern(h,v,this.ctx,D,R)}else o=this._getPattern(h[1],h[2]);return o}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(h,o,v){var D;const R=((D=this.selectColor)==null?void 0:D.call(this,h,o,v))||b.Util.makeHexColor(h,o,v);this.ctx.strokeStyle=R,this.current.strokeColor=R}setFillRGBColor(h,o,v){var D;const R=((D=this.selectColor)==null?void 0:D.call(this,h,o,v))||b.Util.makeHexColor(h,o,v);this.ctx.fillStyle=R,this.current.fillColor=R,this.current.patternFill=!1}_getPattern(h,o=null){let v;return this.cachedPatterns.has(h)?v=this.cachedPatterns.get(h):(v=(0,Y.getShadingPattern)(this.objs.get(h)),this.cachedPatterns.set(h,v)),o&&(v.matrix=o),v}shadingFill(h){if(!this.contentVisible)return;const o=this.ctx;this.save();const v=this._getPattern(h);o.fillStyle=v.getPattern(o,this,(0,w.getCurrentTransformInverse)(o),Y.PathType.SHADING);const R=(0,w.getCurrentTransformInverse)(o);if(R){const D=o.canvas,k=D.width,q=D.height,J=b.Util.applyTransform([0,0],R),nt=b.Util.applyTransform([0,q],R),$=b.Util.applyTransform([k,0],R),a=b.Util.applyTransform([k,q],R),l=Math.min(J[0],nt[0],$[0],a[0]),E=Math.min(J[1],nt[1],$[1],a[1]),C=Math.max(J[0],nt[0],$[0],a[0]),d=Math.max(J[1],nt[1],$[1],a[1]);this.ctx.fillRect(l,E,C-l,d-E)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,b.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,b.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(h,o){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(h)&&h.length===6&&this.transform(...h),this.baseTransform=(0,w.getCurrentTransform)(this.ctx),o)){const v=o[2]-o[0],R=o[3]-o[1];this.ctx.rect(o[0],o[1],v,R),this.current.updateRectMinMax((0,w.getCurrentTransform)(this.ctx),o),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(h){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const o=this.ctx;h.isolated||(0,b.info)("TODO: Support non-isolated groups."),h.knockout&&(0,b.warn)("Knockout groups not supported.");const v=(0,w.getCurrentTransform)(o);if(h.matrix&&o.transform(...h.matrix),!h.bbox)throw new Error("Bounding box is required.");let R=b.Util.getAxialAlignedBoundingBox(h.bbox,(0,w.getCurrentTransform)(o));const D=[0,0,o.canvas.width,o.canvas.height];R=b.Util.intersect(R,D)||[0,0,0,0];const k=Math.floor(R[0]),q=Math.floor(R[1]);let J=Math.max(Math.ceil(R[2])-k,1),nt=Math.max(Math.ceil(R[3])-q,1),$=1,a=1;J>S&&($=J/S,J=S),nt>S&&(a=nt/S,nt=S),this.current.startNewPathAndClipBox([0,0,J,nt]);let l="groupAt"+this.groupLevel;h.smask&&(l+="_smask_"+this.smaskCounter++%2);const E=this.cachedCanvases.getCanvas(l,J,nt),C=E.context;C.scale(1/$,1/a),C.translate(-k,-q),C.transform(...v),h.smask?this.smaskStack.push({canvas:E.canvas,context:C,offsetX:k,offsetY:q,scaleX:$,scaleY:a,subtype:h.smask.subtype,backdrop:h.smask.backdrop,transferMap:h.smask.transferMap||null,startTransformInverse:null}):(o.setTransform(1,0,0,1,0,0),o.translate(k,q),o.scale($,a),o.save()),t(o,C),this.ctx=C,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(o),this.groupLevel++}endGroup(h){if(!this.contentVisible)return;this.groupLevel--;const o=this.ctx,v=this.groupStack.pop();if(this.ctx=v,this.ctx.imageSmoothingEnabled=!1,h.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const R=(0,w.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...R);const D=b.Util.getAxialAlignedBoundingBox([0,0,o.canvas.width,o.canvas.height],R);this.ctx.drawImage(o.canvas,0,0),this.ctx.restore(),this.compose(D)}}beginAnnotation(h,o,v,R,D){if(lt(this,G,re).call(this),s(this.ctx,this.foregroundColor),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(o)&&o.length===4){const k=o[2]-o[0],q=o[3]-o[1];if(D&&this.annotationCanvasMap){v=v.slice(),v[4]-=o[0],v[5]-=o[1],o=o.slice(),o[0]=o[1]=0,o[2]=k,o[3]=q;const[J,nt]=b.Util.singularValueDecompose2dScale((0,w.getCurrentTransform)(this.ctx)),{viewportScale:$}=this,a=Math.ceil(k*this.outputScaleX*$),l=Math.ceil(q*this.outputScaleY*$);this.annotationCanvas=this.canvasFactory.create(a,l);const{canvas:E,context:C}=this.annotationCanvas;this.annotationCanvasMap.set(h,E),this.annotationCanvas.savedCtx=this.ctx,this.ctx=C,this.ctx.setTransform(J,0,0,-nt,0,q*nt),s(this.ctx,this.foregroundColor)}else s(this.ctx,this.foregroundColor),this.ctx.rect(o[0],o[1],k,q),this.ctx.clip(),this.endPath()}this.current=new u(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...v),this.transform(...R)}endAnnotation(){this.annotationCanvas&&(this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(h){if(!this.contentVisible)return;const o=h.count;h=this.getObject(h.data,h),h.count=o;const v=this.ctx,R=this.processingType3;if(R&&(R.compiled===void 0&&(R.compiled=c(h)),R.compiled)){R.compiled(v);return}const D=this._createMaskCanvas(h),k=D.canvas;v.save(),v.setTransform(1,0,0,1,0,0),v.drawImage(k,D.offsetX,D.offsetY),v.restore(),this.compose()}paintImageMaskXObjectRepeat(h,o,v=0,R=0,D,k){if(!this.contentVisible)return;h=this.getObject(h.data,h);const q=this.ctx;q.save();const J=(0,w.getCurrentTransform)(q);q.transform(o,v,R,D,0,0);const nt=this._createMaskCanvas(h);q.setTransform(1,0,0,1,nt.offsetX-J[4],nt.offsetY-J[5]);for(let $=0,a=k.length;$<a;$+=2){const l=b.Util.transform(J,[o,v,R,D,k[$],k[$+1]]),[E,C]=b.Util.applyTransform([0,0],l);q.drawImage(nt.canvas,E,C)}q.restore(),this.compose()}paintImageMaskXObjectGroup(h){if(!this.contentVisible)return;const o=this.ctx,v=this.current.fillColor,R=this.current.patternFill;for(const D of h){const{data:k,width:q,height:J,transform:nt}=D,$=this.cachedCanvases.getCanvas("maskCanvas",q,J),a=$.context;a.save();const l=this.getObject(k,D);n(a,l),a.globalCompositeOperation="source-in",a.fillStyle=R?v.getPattern(a,this,(0,w.getCurrentTransformInverse)(o),Y.PathType.FILL):v,a.fillRect(0,0,q,J),a.restore(),o.save(),o.transform(...nt),o.scale(1,-1),r(o,$.canvas,0,0,q,J,0,-1,1,1),o.restore()}this.compose()}paintImageXObject(h){if(!this.contentVisible)return;const o=this.getObject(h);if(!o){(0,b.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(o)}paintImageXObjectRepeat(h,o,v,R){if(!this.contentVisible)return;const D=this.getObject(h);if(!D){(0,b.warn)("Dependent image isn't ready yet");return}const k=D.width,q=D.height,J=[];for(let nt=0,$=R.length;nt<$;nt+=2)J.push({transform:[o,0,0,v,R[nt],R[nt+1]],x:0,y:0,w:k,h:q});this.paintInlineImageXObjectGroup(D,J)}paintInlineImageXObject(h){if(!this.contentVisible)return;const o=h.width,v=h.height,R=this.ctx;this.save(),R.scale(1/o,-1/v);let D;if(typeof HTMLElement=="function"&&h instanceof HTMLElement||!h.data)D=h;else{const q=this.cachedCanvases.getCanvas("inlineImage",o,v),J=q.context;i(J,h,this.current.transferMaps),D=q.canvas}const k=this._scaleImage(D,(0,w.getCurrentTransformInverse)(R));R.imageSmoothingEnabled=tt((0,w.getCurrentTransform)(R),h.interpolate),r(R,k.img,0,0,k.paintWidth,k.paintHeight,0,-v,o,v),this.compose(),this.restore()}paintInlineImageXObjectGroup(h,o){if(!this.contentVisible)return;const v=this.ctx,R=h.width,D=h.height,k=this.cachedCanvases.getCanvas("inlineImage",R,D),q=k.context;i(q,h,this.current.transferMaps);for(const J of o)v.save(),v.transform(...J.transform),v.scale(1,-1),r(v,k.canvas,J.x,J.y,J.w,J.h,0,-1,1,1),v.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(h){}markPointProps(h,o){}beginMarkedContent(h){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(h,o){h==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(o)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(h){const o=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(h);const v=this.ctx;this.pendingClip&&(o||(this.pendingClip===K?v.clip("evenodd"):v.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),v.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const h=(0,w.getCurrentTransform)(this.ctx);if(h[1]===0&&h[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(h[0]),Math.abs(h[3]));else{const o=Math.abs(h[0]*h[3]-h[2]*h[1]),v=Math.hypot(h[0],h[2]),R=Math.hypot(h[1],h[3]);this._cachedGetSinglePixelWidth=Math.max(v,R)/o}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(!this._cachedScaleForStroking){const{lineWidth:h}=this.current,o=(0,w.getCurrentTransform)(this.ctx);let v,R;if(o[1]===0&&o[2]===0){const D=Math.abs(o[0]),k=Math.abs(o[3]);if(h===0)v=1/D,R=1/k;else{const q=D*h,J=k*h;v=q<1?1/q:1,R=J<1?1/J:1}}else{const D=Math.abs(o[0]*o[3]-o[2]*o[1]),k=Math.hypot(o[0],o[1]),q=Math.hypot(o[2],o[3]);if(h===0)v=q/D,R=k/D;else{const J=h*D;v=q>J?q/J:1,R=k>J?k/J:1}}this._cachedScaleForStroking=[v,R]}return this._cachedScaleForStroking}rescaleAndStroke(h){const{ctx:o}=this,{lineWidth:v}=this.current,[R,D]=this.getScaleForStroking();if(o.lineWidth=v||1,R===1&&D===1){o.stroke();return}let k,q,J;h&&(k=(0,w.getCurrentTransform)(o),q=o.getLineDash().slice(),J=o.lineDashOffset),o.scale(R,D);const nt=Math.max(R,D);o.setLineDash(o.getLineDash().map($=>$/nt)),o.lineDashOffset/=nt,o.stroke(),h&&(o.setTransform(...k),o.setLineDash(q),o.lineDashOffset=J)}isContentVisible(){for(let h=this.markedContentStack.length-1;h>=0;h--)if(!this.markedContentStack[h].visible)return!1;return!0}};G=new WeakSet,re=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)};let H=ht;m.CanvasGraphics=H;for(const M in b.OPS)H.prototype[M]!==void 0&&(H.prototype[b.OPS[M]]=H.prototype[M])},(ot,m,Q)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.TilingPattern=m.PathType=void 0,m.getShadingPattern=A;var b=Q(1),w=Q(6);const Y={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};m.PathType=Y;function z(r,c){if(!c)return;const u=c[2]-c[0],i=c[3]-c[1],n=new Path2D;n.rect(c[0],c[1],u,i),r.clip(n)}class et{constructor(){this.constructor===et&&(0,b.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,b.unreachable)("Abstract method `getPattern` called.")}}class B extends et{constructor(c){super(),this._type=c[1],this._bbox=c[2],this._colorStops=c[3],this._p0=c[4],this._p1=c[5],this._r0=c[6],this._r1=c[7],this.matrix=null}_createGradient(c){let u;this._type==="axial"?u=c.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(u=c.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const i of this._colorStops)u.addColorStop(i[0],i[1]);return u}getPattern(c,u,i,n){let t;if(n===Y.STROKE||n===Y.FILL){const s=u.current.getClippedPathBoundingBox(n,(0,w.getCurrentTransform)(c))||[0,0,0,0],p=Math.ceil(s[2]-s[0])||1,e=Math.ceil(s[3]-s[1])||1,y=u.cachedCanvases.getCanvas("pattern",p,e,!0),O=y.context;O.clearRect(0,0,O.canvas.width,O.canvas.height),O.beginPath(),O.rect(0,0,O.canvas.width,O.canvas.height),O.translate(-s[0],-s[1]),i=b.Util.transform(i,[1,0,0,1,s[0],s[1]]),O.transform(...u.baseTransform),this.matrix&&O.transform(...this.matrix),z(O,this._bbox),O.fillStyle=this._createGradient(O),O.fill(),t=c.createPattern(y.canvas,"no-repeat");const W=new DOMMatrix(i);t.setTransform(W)}else z(c,this._bbox),t=this._createGradient(c);return t}}function S(r,c,u,i,n,t,s,p){const e=c.coords,y=c.colors,O=r.data,W=r.width*4;let tt;e[u+1]>e[i+1]&&(tt=u,u=i,i=tt,tt=t,t=s,s=tt),e[i+1]>e[n+1]&&(tt=i,i=n,n=tt,tt=s,s=p,p=tt),e[u+1]>e[i+1]&&(tt=u,u=i,i=tt,tt=t,t=s,s=tt);const gt=(e[u]+c.offsetX)*c.scaleX,rt=(e[u+1]+c.offsetY)*c.scaleY,ct=(e[i]+c.offsetX)*c.scaleX,K=(e[i+1]+c.offsetY)*c.scaleY,H=(e[n]+c.offsetX)*c.scaleX,G=(e[n+1]+c.offsetY)*c.scaleY;if(rt>=G)return;const st=y[t],ht=y[t+1],M=y[t+2],h=y[s],o=y[s+1],v=y[s+2],R=y[p],D=y[p+1],k=y[p+2],q=Math.round(rt),J=Math.round(G);let nt,$,a,l,E,C,d,F;for(let N=q;N<=J;N++){if(N<K){let I;N<rt?I=0:I=(rt-N)/(rt-K),nt=gt-(gt-ct)*I,$=st-(st-h)*I,a=ht-(ht-o)*I,l=M-(M-v)*I}else{let I;N>G?I=1:K===G?I=0:I=(K-N)/(K-G),nt=ct-(ct-H)*I,$=h-(h-R)*I,a=o-(o-D)*I,l=v-(v-k)*I}let j;N<rt?j=0:N>G?j=1:j=(rt-N)/(rt-G),E=gt-(gt-H)*j,C=st-(st-R)*j,d=ht-(ht-D)*j,F=M-(M-k)*j;const Z=Math.round(Math.min(nt,E)),x=Math.round(Math.max(nt,E));let U=W*N+Z*4;for(let I=Z;I<=x;I++)j=(nt-I)/(nt-E),j<0?j=0:j>1&&(j=1),O[U++]=$-($-C)*j|0,O[U++]=a-(a-d)*j|0,O[U++]=l-(l-F)*j|0,O[U++]=255}}function P(r,c,u){const i=c.coords,n=c.colors;let t,s;switch(c.type){case"lattice":const p=c.verticesPerRow,e=Math.floor(i.length/p)-1,y=p-1;for(t=0;t<e;t++){let O=t*p;for(let W=0;W<y;W++,O++)S(r,u,i[O],i[O+1],i[O+p],n[O],n[O+1],n[O+p]),S(r,u,i[O+p+1],i[O+1],i[O+p],n[O+p+1],n[O+1],n[O+p])}break;case"triangles":for(t=0,s=i.length;t<s;t+=3)S(r,u,i[t],i[t+1],i[t+2],n[t],n[t+1],n[t+2]);break;default:throw new Error("illegal figure")}}class L extends et{constructor(c){super(),this._coords=c[2],this._colors=c[3],this._figures=c[4],this._bounds=c[5],this._bbox=c[7],this._background=c[8],this.matrix=null}_createMeshCanvas(c,u,i){const p=Math.floor(this._bounds[0]),e=Math.floor(this._bounds[1]),y=Math.ceil(this._bounds[2])-p,O=Math.ceil(this._bounds[3])-e,W=Math.min(Math.ceil(Math.abs(y*c[0]*1.1)),3e3),tt=Math.min(Math.ceil(Math.abs(O*c[1]*1.1)),3e3),gt=y/W,rt=O/tt,ct={coords:this._coords,colors:this._colors,offsetX:-p,offsetY:-e,scaleX:1/gt,scaleY:1/rt},K=W+2*2,H=tt+2*2,G=i.getCanvas("mesh",K,H,!1),st=G.context,ht=st.createImageData(W,tt);if(u){const h=ht.data;for(let o=0,v=h.length;o<v;o+=4)h[o]=u[0],h[o+1]=u[1],h[o+2]=u[2],h[o+3]=255}for(const h of this._figures)P(ht,h,ct);return st.putImageData(ht,2,2),{canvas:G.canvas,offsetX:p-2*gt,offsetY:e-2*rt,scaleX:gt,scaleY:rt}}getPattern(c,u,i,n){z(c,this._bbox);let t;if(n===Y.SHADING)t=b.Util.singularValueDecompose2dScale((0,w.getCurrentTransform)(c));else if(t=b.Util.singularValueDecompose2dScale(u.baseTransform),this.matrix){const p=b.Util.singularValueDecompose2dScale(this.matrix);t=[t[0]*p[0],t[1]*p[1]]}const s=this._createMeshCanvas(t,n===Y.SHADING?null:this._background,u.cachedCanvases);return n!==Y.SHADING&&(c.setTransform(...u.baseTransform),this.matrix&&c.transform(...this.matrix)),c.translate(s.offsetX,s.offsetY),c.scale(s.scaleX,s.scaleY),c.createPattern(s.canvas,"no-repeat")}}class T extends et{getPattern(){return"hotpink"}}function A(r){switch(r[0]){case"RadialAxial":return new B(r);case"Mesh":return new L(r);case"Dummy":return new T}throw new Error(`Unknown IR type: ${r[0]}`)}const g={COLORED:1,UNCOLORED:2};class f{static get MAX_PATTERN_SIZE(){return(0,b.shadow)(this,"MAX_PATTERN_SIZE",3e3)}constructor(c,u,i,n,t){this.operatorList=c[2],this.matrix=c[3]||[1,0,0,1,0,0],this.bbox=c[4],this.xstep=c[5],this.ystep=c[6],this.paintType=c[7],this.tilingType=c[8],this.color=u,this.ctx=i,this.canvasGraphicsFactory=n,this.baseTransform=t}createPatternCanvas(c){const u=this.operatorList,i=this.bbox,n=this.xstep,t=this.ystep,s=this.paintType,p=this.tilingType,e=this.color,y=this.canvasGraphicsFactory;(0,b.info)("TilingType: "+p);const O=i[0],W=i[1],tt=i[2],gt=i[3],rt=b.Util.singularValueDecompose2dScale(this.matrix),ct=b.Util.singularValueDecompose2dScale(this.baseTransform),K=[rt[0]*ct[0],rt[1]*ct[1]],H=this.getSizeAndScale(n,this.ctx.canvas.width,K[0]),G=this.getSizeAndScale(t,this.ctx.canvas.height,K[1]),st=c.cachedCanvases.getCanvas("pattern",H.size,G.size,!0),ht=st.context,M=y.createCanvasGraphics(ht);M.groupLevel=c.groupLevel,this.setFillAndStrokeStyleToContext(M,s,e);let h=O,o=W,v=tt,R=gt;return O<0&&(h=0,v+=Math.abs(O)),W<0&&(o=0,R+=Math.abs(W)),ht.translate(-(H.scale*h),-(G.scale*o)),M.transform(H.scale,0,0,G.scale,0,0),ht.save(),this.clipBbox(M,h,o,v,R),M.baseTransform=(0,w.getCurrentTransform)(M.ctx),M.executeOperatorList(u),M.endDrawing(),{canvas:st.canvas,scaleX:H.scale,scaleY:G.scale,offsetX:h,offsetY:o}}getSizeAndScale(c,u,i){c=Math.abs(c);const n=Math.max(f.MAX_PATTERN_SIZE,u);let t=Math.ceil(c*i);return t>=n?t=n:i=t/c,{scale:i,size:t}}clipBbox(c,u,i,n,t){const s=n-u,p=t-i;c.ctx.rect(u,i,s,p),c.current.updateRectMinMax((0,w.getCurrentTransform)(c.ctx),[u,i,n,t]),c.clip(),c.endPath()}setFillAndStrokeStyleToContext(c,u,i){const n=c.ctx,t=c.current;switch(u){case g.COLORED:const s=this.ctx;n.fillStyle=s.fillStyle,n.strokeStyle=s.strokeStyle,t.fillColor=s.fillStyle,t.strokeColor=s.strokeStyle;break;case g.UNCOLORED:const p=b.Util.makeHexColor(i[0],i[1],i[2]);n.fillStyle=p,n.strokeStyle=p,t.fillColor=p,t.strokeColor=p;break;default:throw new b.FormatError(`Unsupported paint type: ${u}`)}}getPattern(c,u,i,n){let t=i;n!==Y.SHADING&&(t=b.Util.transform(t,u.baseTransform),this.matrix&&(t=b.Util.transform(t,this.matrix)));const s=this.createPatternCanvas(u);let p=new DOMMatrix(t);p=p.translate(s.offsetX,s.offsetY),p=p.scale(1/s.scaleX,1/s.scaleY);const e=c.createPattern(s.canvas,"repeat");return e.setTransform(p),e}}m.TilingPattern=f},(ot,m,Q)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.applyMaskImageData=w;var b=Q(1);function w({src:Y,srcPos:z=0,dest:et,destPos:B=0,width:S,height:P,inverseDecode:L=!1}){const T=b.FeatureTest.isLittleEndian?4278190080:255,[A,g]=L?[0,T]:[T,0],f=S>>3,r=S&7,c=Y.length;et=new Uint32Array(et.buffer);for(let u=0;u<P;u++){for(const n=z+f;z<n;z++){const t=z<c?Y[z]:255;et[B++]=t&128?g:A,et[B++]=t&64?g:A,et[B++]=t&32?g:A,et[B++]=t&16?g:A,et[B++]=t&8?g:A,et[B++]=t&4?g:A,et[B++]=t&2?g:A,et[B++]=t&1?g:A}if(r===0)continue;const i=z<c?Y[z++]:255;for(let n=0;n<r;n++)et[B++]=i&1<<7-n?g:A}return{srcPos:z,destPos:B}}},(ot,m)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.GlobalWorkerOptions=void 0;const Q=Object.create(null);m.GlobalWorkerOptions=Q,Q.workerPort=null,Q.workerSrc=""},(ot,m,Q)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.MessageHandler=void 0;var b=Q(1);const w={UNKNOWN:0,DATA:1,ERROR:2},Y={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function z(B){switch(B instanceof Error||typeof B=="object"&&B!==null||(0,b.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),B.name){case"AbortException":return new b.AbortException(B.message);case"MissingPDFException":return new b.MissingPDFException(B.message);case"PasswordException":return new b.PasswordException(B.message,B.code);case"UnexpectedResponseException":return new b.UnexpectedResponseException(B.message,B.status);case"UnknownErrorException":return new b.UnknownErrorException(B.message,B.details);default:return new b.UnknownErrorException(B.message,B.toString())}}class et{constructor(S,P,L){this.sourceName=S,this.targetName=P,this.comObj=L,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=T=>{const A=T.data;if(A.targetName!==this.sourceName)return;if(A.stream){this._processStreamMessage(A);return}if(A.callback){const f=A.callbackId,r=this.callbackCapabilities[f];if(!r)throw new Error(`Cannot resolve callback ${f}`);if(delete this.callbackCapabilities[f],A.callback===w.DATA)r.resolve(A.data);else if(A.callback===w.ERROR)r.reject(z(A.reason));else throw new Error("Unexpected callback case");return}const g=this.actionHandler[A.action];if(!g)throw new Error(`Unknown action from worker: ${A.action}`);if(A.callbackId){const f=this.sourceName,r=A.sourceName;new Promise(function(c){c(g(A.data))}).then(function(c){L.postMessage({sourceName:f,targetName:r,callback:w.DATA,callbackId:A.callbackId,data:c})},function(c){L.postMessage({sourceName:f,targetName:r,callback:w.ERROR,callbackId:A.callbackId,reason:z(c)})});return}if(A.streamId){this._createStreamSink(A);return}g(A.data)},L.addEventListener("message",this._onComObjOnMessage)}on(S,P){const L=this.actionHandler;if(L[S])throw new Error(`There is already an actionName called "${S}"`);L[S]=P}send(S,P,L){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:S,data:P},L)}sendWithPromise(S,P,L){const T=this.callbackId++,A=(0,b.createPromiseCapability)();this.callbackCapabilities[T]=A;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:S,callbackId:T,data:P},L)}catch(g){A.reject(g)}return A.promise}sendWithStream(S,P,L,T){const A=this.streamId++,g=this.sourceName,f=this.targetName,r=this.comObj;return new ReadableStream({start:c=>{const u=(0,b.createPromiseCapability)();return this.streamControllers[A]={controller:c,startCall:u,pullCall:null,cancelCall:null,isClosed:!1},r.postMessage({sourceName:g,targetName:f,action:S,streamId:A,data:P,desiredSize:c.desiredSize},T),u.promise},pull:c=>{const u=(0,b.createPromiseCapability)();return this.streamControllers[A].pullCall=u,r.postMessage({sourceName:g,targetName:f,stream:Y.PULL,streamId:A,desiredSize:c.desiredSize}),u.promise},cancel:c=>{(0,b.assert)(c instanceof Error,"cancel must have a valid reason");const u=(0,b.createPromiseCapability)();return this.streamControllers[A].cancelCall=u,this.streamControllers[A].isClosed=!0,r.postMessage({sourceName:g,targetName:f,stream:Y.CANCEL,streamId:A,reason:z(c)}),u.promise}},L)}_createStreamSink(S){const P=S.streamId,L=this.sourceName,T=S.sourceName,A=this.comObj,g=this,f=this.actionHandler[S.action],r={enqueue(c,u=1,i){if(this.isCancelled)return;const n=this.desiredSize;this.desiredSize-=u,n>0&&this.desiredSize<=0&&(this.sinkCapability=(0,b.createPromiseCapability)(),this.ready=this.sinkCapability.promise),A.postMessage({sourceName:L,targetName:T,stream:Y.ENQUEUE,streamId:P,chunk:c},i)},close(){this.isCancelled||(this.isCancelled=!0,A.postMessage({sourceName:L,targetName:T,stream:Y.CLOSE,streamId:P}),delete g.streamSinks[P])},error(c){(0,b.assert)(c instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,A.postMessage({sourceName:L,targetName:T,stream:Y.ERROR,streamId:P,reason:z(c)}))},sinkCapability:(0,b.createPromiseCapability)(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:S.desiredSize,ready:null};r.sinkCapability.resolve(),r.ready=r.sinkCapability.promise,this.streamSinks[P]=r,new Promise(function(c){c(f(S.data,r))}).then(function(){A.postMessage({sourceName:L,targetName:T,stream:Y.START_COMPLETE,streamId:P,success:!0})},function(c){A.postMessage({sourceName:L,targetName:T,stream:Y.START_COMPLETE,streamId:P,reason:z(c)})})}_processStreamMessage(S){const P=S.streamId,L=this.sourceName,T=S.sourceName,A=this.comObj,g=this.streamControllers[P],f=this.streamSinks[P];switch(S.stream){case Y.START_COMPLETE:S.success?g.startCall.resolve():g.startCall.reject(z(S.reason));break;case Y.PULL_COMPLETE:S.success?g.pullCall.resolve():g.pullCall.reject(z(S.reason));break;case Y.PULL:if(!f){A.postMessage({sourceName:L,targetName:T,stream:Y.PULL_COMPLETE,streamId:P,success:!0});break}f.desiredSize<=0&&S.desiredSize>0&&f.sinkCapability.resolve(),f.desiredSize=S.desiredSize,new Promise(function(r){r(f.onPull&&f.onPull())}).then(function(){A.postMessage({sourceName:L,targetName:T,stream:Y.PULL_COMPLETE,streamId:P,success:!0})},function(r){A.postMessage({sourceName:L,targetName:T,stream:Y.PULL_COMPLETE,streamId:P,reason:z(r)})});break;case Y.ENQUEUE:if((0,b.assert)(g,"enqueue should have stream controller"),g.isClosed)break;g.controller.enqueue(S.chunk);break;case Y.CLOSE:if((0,b.assert)(g,"close should have stream controller"),g.isClosed)break;g.isClosed=!0,g.controller.close(),this._deleteStreamController(g,P);break;case Y.ERROR:(0,b.assert)(g,"error should have stream controller"),g.controller.error(z(S.reason)),this._deleteStreamController(g,P);break;case Y.CANCEL_COMPLETE:S.success?g.cancelCall.resolve():g.cancelCall.reject(z(S.reason)),this._deleteStreamController(g,P);break;case Y.CANCEL:if(!f)break;new Promise(function(r){r(f.onCancel&&f.onCancel(z(S.reason)))}).then(function(){A.postMessage({sourceName:L,targetName:T,stream:Y.CANCEL_COMPLETE,streamId:P,success:!0})},function(r){A.postMessage({sourceName:L,targetName:T,stream:Y.CANCEL_COMPLETE,streamId:P,reason:z(r)})}),f.sinkCapability.reject(z(S.reason)),f.isCancelled=!0,delete this.streamSinks[P];break;default:throw new Error("Unexpected stream case")}}async _deleteStreamController(S,P){await Promise.allSettled([S.startCall&&S.startCall.promise,S.pullCall&&S.pullCall.promise,S.cancelCall&&S.cancelCall.promise]),delete this.streamControllers[P]}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}m.MessageHandler=et},(ot,m,Q)=>{var Y,z;Object.defineProperty(m,"__esModule",{value:!0}),m.Metadata=void 0;var b=Q(1);class w{constructor({parsedData:B,rawData:S}){ut(this,Y);ut(this,z);pt(this,Y,B),pt(this,z,S)}getRaw(){return _(this,z)}get(B){return _(this,Y).get(B)??null}getAll(){return(0,b.objectFromMap)(_(this,Y))}has(B){return _(this,Y).has(B)}}Y=new WeakMap,z=new WeakMap,m.Metadata=w},(ot,m,Q)=>{var B,S,P,L,T,A,ae;Object.defineProperty(m,"__esModule",{value:!0}),m.OptionalContentConfig=void 0;var b=Q(1),w=Q(8);const Y=Symbol("INTERNAL");class z{constructor(r,c){ut(this,B,!0);this.name=r,this.intent=c}get visible(){return _(this,B)}_setVisible(r,c){r!==Y&&(0,b.unreachable)("Internal method `_setVisible` called."),pt(this,B,c)}}B=new WeakMap;class et{constructor(r){ut(this,A);ut(this,S,null);ut(this,P,new Map);ut(this,L,null);ut(this,T,null);if(this.name=null,this.creator=null,r!==null){this.name=r.name,this.creator=r.creator,pt(this,T,r.order);for(const c of r.groups)_(this,P).set(c.id,new z(c.name,c.intent));if(r.baseState==="OFF")for(const c of _(this,P).values())c._setVisible(Y,!1);for(const c of r.on)_(this,P).get(c)._setVisible(Y,!0);for(const c of r.off)_(this,P).get(c)._setVisible(Y,!1);pt(this,L,this.getHash())}}isVisible(r){if(_(this,P).size===0)return!0;if(!r)return(0,b.warn)("Optional content group not defined."),!0;if(r.type==="OCG")return _(this,P).has(r.id)?_(this,P).get(r.id).visible:((0,b.warn)(`Optional content group not found: ${r.id}`),!0);if(r.type==="OCMD"){if(r.expression)return lt(this,A,ae).call(this,r.expression);if(!r.policy||r.policy==="AnyOn"){for(const c of r.ids){if(!_(this,P).has(c))return(0,b.warn)(`Optional content group not found: ${c}`),!0;if(_(this,P).get(c).visible)return!0}return!1}else if(r.policy==="AllOn"){for(const c of r.ids){if(!_(this,P).has(c))return(0,b.warn)(`Optional content group not found: ${c}`),!0;if(!_(this,P).get(c).visible)return!1}return!0}else if(r.policy==="AnyOff"){for(const c of r.ids){if(!_(this,P).has(c))return(0,b.warn)(`Optional content group not found: ${c}`),!0;if(!_(this,P).get(c).visible)return!0}return!1}else if(r.policy==="AllOff"){for(const c of r.ids){if(!_(this,P).has(c))return(0,b.warn)(`Optional content group not found: ${c}`),!0;if(_(this,P).get(c).visible)return!1}return!0}return(0,b.warn)(`Unknown optional content policy ${r.policy}.`),!0}return(0,b.warn)(`Unknown group type ${r.type}.`),!0}setVisibility(r,c=!0){if(!_(this,P).has(r)){(0,b.warn)(`Optional content group not found: ${r}`);return}_(this,P).get(r)._setVisible(Y,!!c),pt(this,S,null)}get hasInitialVisibility(){return this.getHash()===_(this,L)}getOrder(){return _(this,P).size?_(this,T)?_(this,T).slice():[..._(this,P).keys()]:null}getGroups(){return _(this,P).size>0?(0,b.objectFromMap)(_(this,P)):null}getGroup(r){return _(this,P).get(r)||null}getHash(){if(_(this,S)!==null)return _(this,S);const r=new w.MurmurHash3_64;for(const[c,u]of _(this,P))r.update(`${c}:${u.visible}`);return pt(this,S,r.hexdigest())}}S=new WeakMap,P=new WeakMap,L=new WeakMap,T=new WeakMap,A=new WeakSet,ae=function(r){const c=r.length;if(c<2)return!0;const u=r[0];for(let i=1;i<c;i++){const n=r[i];let t;if(Array.isArray(n))t=lt(this,A,ae).call(this,n);else if(_(this,P).has(n))t=_(this,P).get(n).visible;else return(0,b.warn)(`Optional content group not found: ${n}`),!0;switch(u){case"And":if(!t)return!1;break;case"Or":if(t)return!0;break;case"Not":return!t;default:return!0}}return u==="And"},m.OptionalContentConfig=et},(ot,m,Q)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.PDFDataTransportStream=void 0;var b=Q(1),w=Q(6);class Y{constructor({length:S,initialData:P,progressiveDone:L=!1,contentDispositionFilename:T=null,disableRange:A=!1,disableStream:g=!1},f){if((0,b.assert)(f,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=L,this._contentDispositionFilename=T,(P==null?void 0:P.length)>0){const r=P instanceof Uint8Array&&P.byteLength===P.buffer.byteLength?P.buffer:new Uint8Array(P).buffer;this._queuedChunks.push(r)}this._pdfDataRangeTransport=f,this._isStreamingSupported=!g,this._isRangeSupported=!A,this._contentLength=S,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((r,c)=>{this._onReceiveData({begin:r,chunk:c})}),this._pdfDataRangeTransport.addProgressListener((r,c)=>{this._onProgress({loaded:r,total:c})}),this._pdfDataRangeTransport.addProgressiveReadListener(r=>{this._onReceiveData({chunk:r})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:S,chunk:P}){const L=P instanceof Uint8Array&&P.byteLength===P.buffer.byteLength?P.buffer:new Uint8Array(P).buffer;if(S===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(L):this._queuedChunks.push(L);else{const T=this._rangeReaders.some(function(A){return A._begin!==S?!1:(A._enqueue(L),!0)});(0,b.assert)(T,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var S;return((S=this._fullRequestReader)==null?void 0:S._loaded)??0}_onProgress(S){var P,L,T,A;S.total===void 0?(L=(P=this._rangeReaders[0])==null?void 0:P.onProgress)==null||L.call(P,{loaded:S.loaded}):(A=(T=this._fullRequestReader)==null?void 0:T.onProgress)==null||A.call(T,{loaded:S.loaded,total:S.total})}_onProgressiveDone(){var S;(S=this._fullRequestReader)==null||S.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(S){const P=this._rangeReaders.indexOf(S);P>=0&&this._rangeReaders.splice(P,1)}getFullReader(){(0,b.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const S=this._queuedChunks;return this._queuedChunks=null,new z(this,S,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(S,P){if(P<=this._progressiveDataLength)return null;const L=new et(this,S,P);return this._pdfDataRangeTransport.requestDataRange(S,P),this._rangeReaders.push(L),L}cancelAllRequests(S){var P;(P=this._fullRequestReader)==null||P.cancel(S);for(const L of this._rangeReaders.slice(0))L.cancel(S);this._pdfDataRangeTransport.abort()}}m.PDFDataTransportStream=Y;class z{constructor(S,P,L=!1,T=null){this._stream=S,this._done=L||!1,this._filename=(0,w.isPdfFile)(T)?T:null,this._queuedChunks=P||[],this._loaded=0;for(const A of this._queuedChunks)this._loaded+=A.byteLength;this._requests=[],this._headersReady=Promise.resolve(),S._fullRequestReader=this,this.onProgress=null}_enqueue(S){this._done||(this._requests.length>0?this._requests.shift().resolve({value:S,done:!1}):this._queuedChunks.push(S),this._loaded+=S.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const S=(0,b.createPromiseCapability)();return this._requests.push(S),S.promise}cancel(S){this._done=!0;for(const P of this._requests)P.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class et{constructor(S,P,L){this._stream=S,this._begin=P,this._end=L,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(S){if(!this._done){if(this._requests.length===0)this._queuedChunk=S;else{this._requests.shift().resolve({value:S,done:!1});for(const L of this._requests)L.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const P=this._queuedChunk;return this._queuedChunk=null,{value:P,done:!1}}if(this._done)return{value:void 0,done:!0};const S=(0,b.createPromiseCapability)();return this._requests.push(S),S.promise}cancel(S){this._done=!0;for(const P of this._requests)P.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(ot,m)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.XfaText=void 0;class Q{static textContent(w){const Y=[],z={items:Y,styles:Object.create(null)};function et(B){var L;if(!B)return;let S=null;const P=B.name;if(P==="#text")S=B.value;else if(Q.shouldBuildText(P))(L=B==null?void 0:B.attributes)!=null&&L.textContent?S=B.attributes.textContent:B.value&&(S=B.value);else return;if(S!==null&&Y.push({str:S}),!!B.children)for(const T of B.children)et(T)}return et(w),z}static shouldBuildText(w){return!(w==="textarea"||w==="input"||w==="option"||w==="select")}}m.XfaText=Q},(ot,m,Q)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.NodeStandardFontDataFactory=m.NodeCanvasFactory=m.NodeCMapReaderFactory=void 0;var b=Q(7);const w=function(B){return new Promise((S,P)=>{require$$5.readFile(B,(T,A)=>{if(T||!A){P(new Error(T));return}S(new Uint8Array(A))})})};class Y extends b.BaseCanvasFactory{_createCanvas(S,P){return require$$5.createCanvas(S,P)}}m.NodeCanvasFactory=Y;class z extends b.BaseCMapReaderFactory{_fetchData(S,P){return w(S).then(L=>({cMapData:L,compressionType:P}))}}m.NodeCMapReaderFactory=z;class et extends b.BaseStandardFontDataFactory{_fetchData(S){return w(S)}}m.NodeStandardFontDataFactory=et},(ot,m,Q)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.PDFNodeStream=void 0;var b=Q(1),w=Q(22);const Y=require$$5,z=require$$5,et=require$$5,B=require$$5,S=/^file:\/\/\/[a-zA-Z]:\//;function P(i){const n=B.parse(i);return n.protocol==="file:"||n.host?n:/^[a-z]:[/\\]/i.test(i)?B.parse(`file:///${i}`):(n.host||(n.protocol="file:"),n)}class L{constructor(n){this.source=n,this.url=P(n.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&n.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var n;return((n=this._fullRequestReader)==null?void 0:n._loaded)??0}getFullReader(){return(0,b.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new c(this):new f(this),this._fullRequestReader}getRangeReader(n,t){if(t<=this._progressiveDataLength)return null;const s=this.isFsUrl?new u(this,n,t):new r(this,n,t);return this._rangeRequestReaders.push(s),s}cancelAllRequests(n){var t;(t=this._fullRequestReader)==null||t.cancel(n);for(const s of this._rangeRequestReaders.slice(0))s.cancel(n)}}m.PDFNodeStream=L;class T{constructor(n){this._url=n.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=n.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=(0,b.createPromiseCapability)(),this._headersCapability=(0,b.createPromiseCapability)()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const n=this._readableStream.read();return n===null?(this._readCapability=(0,b.createPromiseCapability)(),this.read()):(this._loaded+=n.length,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(n).buffer,done:!1})}cancel(n){if(!this._readableStream){this._error(n);return}this._readableStream.destroy(n)}_error(n){this._storedError=n,this._readCapability.resolve()}_setReadableStream(n){this._readableStream=n,n.on("readable",()=>{this._readCapability.resolve()}),n.on("end",()=>{n.destroy(),this._done=!0,this._readCapability.resolve()}),n.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new b.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class A{constructor(n){this._url=n.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=(0,b.createPromiseCapability)();const t=n.source;this._isStreamingSupported=!t.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){var s;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const n=this._readableStream.read();return n===null?(this._readCapability=(0,b.createPromiseCapability)(),this.read()):(this._loaded+=n.length,(s=this.onProgress)==null||s.call(this,{loaded:this._loaded}),{value:new Uint8Array(n).buffer,done:!1})}cancel(n){if(!this._readableStream){this._error(n);return}this._readableStream.destroy(n)}_error(n){this._storedError=n,this._readCapability.resolve()}_setReadableStream(n){this._readableStream=n,n.on("readable",()=>{this._readCapability.resolve()}),n.on("end",()=>{n.destroy(),this._done=!0,this._readCapability.resolve()}),n.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function g(i,n){return{protocol:i.protocol,auth:i.auth,host:i.hostname,port:i.port,path:i.path,method:"GET",headers:n}}class f extends T{constructor(n){super(n);const t=s=>{if(s.statusCode===404){const O=new b.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=O,this._headersCapability.reject(O);return}this._headersCapability.resolve(),this._setReadableStream(s);const p=O=>this._readableStream.headers[O.toLowerCase()],{allowRangeRequests:e,suggestedLength:y}=(0,w.validateRangeRequestCapabilities)({getResponseHeader:p,isHttp:n.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=e,this._contentLength=y||this._contentLength,this._filename=(0,w.extractFilenameFromHeader)(p)};this._request=null,this._url.protocol==="http:"?this._request=z.request(g(this._url,n.httpHeaders),t):this._request=et.request(g(this._url,n.httpHeaders),t),this._request.on("error",s=>{this._storedError=s,this._headersCapability.reject(s)}),this._request.end()}}class r extends A{constructor(n,t,s){super(n),this._httpHeaders={};for(const e in n.httpHeaders){const y=n.httpHeaders[e];y!==void 0&&(this._httpHeaders[e]=y)}this._httpHeaders.Range=`bytes=${t}-${s-1}`;const p=e=>{if(e.statusCode===404){const y=new b.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=y;return}this._setReadableStream(e)};this._request=null,this._url.protocol==="http:"?this._request=z.request(g(this._url,this._httpHeaders),p):this._request=et.request(g(this._url,this._httpHeaders),p),this._request.on("error",e=>{this._storedError=e}),this._request.end()}}class c extends T{constructor(n){super(n);let t=decodeURIComponent(this._url.path);S.test(this._url.href)&&(t=t.replace(/^\//,"")),Y.lstat(t,(s,p)=>{if(s){s.code==="ENOENT"&&(s=new b.MissingPDFException(`Missing PDF "${t}".`)),this._storedError=s,this._headersCapability.reject(s);return}this._contentLength=p.size,this._setReadableStream(Y.createReadStream(t)),this._headersCapability.resolve()})}}class u extends A{constructor(n,t,s){super(n);let p=decodeURIComponent(this._url.path);S.test(this._url.href)&&(p=p.replace(/^\//,"")),this._setReadableStream(Y.createReadStream(p,{start:t,end:s-1}))}}},(ot,m,Q)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.createResponseStatusError=B,m.extractFilenameFromHeader=et,m.validateRangeRequestCapabilities=z,m.validateResponseStatus=S;var b=Q(1),w=Q(23),Y=Q(6);function z({getResponseHeader:P,isHttp:L,rangeChunkSize:T,disableRange:A}){const g={allowRangeRequests:!1,suggestedLength:void 0},f=parseInt(P("Content-Length"),10);return!Number.isInteger(f)||(g.suggestedLength=f,f<=2*T)||A||!L||P("Accept-Ranges")!=="bytes"||(P("Content-Encoding")||"identity")!=="identity"||(g.allowRangeRequests=!0),g}function et(P){const L=P("Content-Disposition");if(L){let T=(0,w.getFilenameFromContentDispositionHeader)(L);if(T.includes("%"))try{T=decodeURIComponent(T)}catch{}if((0,Y.isPdfFile)(T))return T}return null}function B(P,L){return P===404||P===0&&L.startsWith("file:")?new b.MissingPDFException('Missing PDF "'+L+'".'):new b.UnexpectedResponseException(`Unexpected server response (${P}) while retrieving PDF "${L}".`,P)}function S(P){return P===200||P===206}},(ot,m,Q)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.getFilenameFromContentDispositionHeader=w;var b=Q(1);function w(Y){let z=!0,et=B("filename\\*","i").exec(Y);if(et){et=et[1];let f=T(et);return f=unescape(f),f=A(f),f=g(f),P(f)}if(et=L(Y),et){const f=g(et);return P(f)}if(et=B("filename","i").exec(Y),et){et=et[1];let f=T(et);return f=g(f),P(f)}function B(f,r){return new RegExp("(?:^|;)\\s*"+f+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',r)}function S(f,r){if(f){if(!/^[\x00-\xFF]+$/.test(r))return r;try{const c=new TextDecoder(f,{fatal:!0}),u=(0,b.stringToBytes)(r);r=c.decode(u),z=!1}catch{}}return r}function P(f){return z&&/[\x80-\xff]/.test(f)&&(f=S("utf-8",f),z&&(f=S("iso-8859-1",f))),f}function L(f){const r=[];let c;const u=B("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(c=u.exec(f))!==null;){let[,n,t,s]=c;if(n=parseInt(n,10),n in r){if(n===0)break;continue}r[n]=[t,s]}const i=[];for(let n=0;n<r.length&&n in r;++n){let[t,s]=r[n];s=T(s),t&&(s=unescape(s),n===0&&(s=A(s))),i.push(s)}return i.join("")}function T(f){if(f.startsWith('"')){const r=f.slice(1).split('\\"');for(let c=0;c<r.length;++c){const u=r[c].indexOf('"');u!==-1&&(r[c]=r[c].slice(0,u),r.length=c+1),r[c]=r[c].replace(/\\(.)/g,"$1")}f=r.join('"')}return f}function A(f){const r=f.indexOf("'");if(r===-1)return f;const c=f.slice(0,r),i=f.slice(r+1).replace(/^[^']*'/,"");return S(c,i)}function g(f){return!f.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(f)?f:f.replace(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(r,c,u,i){if(u==="q"||u==="Q")return i=i.replace(/_/g," "),i=i.replace(/=([0-9a-fA-F]{2})/g,function(n,t){return String.fromCharCode(parseInt(t,16))}),S(c,i);try{i=atob(i)}catch{}return S(c,i)})}return""}},(ot,m,Q)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.PDFNetworkStream=void 0;var b=Q(1),w=Q(22);const Y=200,z=206;function et(T){const A=T.response;return typeof A!="string"?A:(0,b.stringToBytes)(A).buffer}class B{constructor(A,g={}){this.url=A,this.isHttp=/^https?:/i.test(A),this.httpHeaders=this.isHttp&&g.httpHeaders||Object.create(null),this.withCredentials=g.withCredentials||!1,this.getXhr=g.getXhr||function(){return new XMLHttpRequest},this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(A,g,f){const r={begin:A,end:g};for(const c in f)r[c]=f[c];return this.request(r)}requestFull(A){return this.request(A)}request(A){const g=this.getXhr(),f=this.currXhrId++,r=this.pendingRequests[f]={xhr:g};g.open("GET",this.url),g.withCredentials=this.withCredentials;for(const c in this.httpHeaders){const u=this.httpHeaders[c];u!==void 0&&g.setRequestHeader(c,u)}return this.isHttp&&"begin"in A&&"end"in A?(g.setRequestHeader("Range",`bytes=${A.begin}-${A.end-1}`),r.expectedStatus=z):r.expectedStatus=Y,g.responseType="arraybuffer",A.onError&&(g.onerror=function(c){A.onError(g.status)}),g.onreadystatechange=this.onStateChange.bind(this,f),g.onprogress=this.onProgress.bind(this,f),r.onHeadersReceived=A.onHeadersReceived,r.onDone=A.onDone,r.onError=A.onError,r.onProgress=A.onProgress,g.send(null),f}onProgress(A,g){var r;const f=this.pendingRequests[A];f&&((r=f.onProgress)==null||r.call(f,g))}onStateChange(A,g){var n,t,s;const f=this.pendingRequests[A];if(!f)return;const r=f.xhr;if(r.readyState>=2&&f.onHeadersReceived&&(f.onHeadersReceived(),delete f.onHeadersReceived),r.readyState!==4||!(A in this.pendingRequests))return;if(delete this.pendingRequests[A],r.status===0&&this.isHttp){(n=f.onError)==null||n.call(f,r.status);return}const c=r.status||Y;if(!(c===Y&&f.expectedStatus===z)&&c!==f.expectedStatus){(t=f.onError)==null||t.call(f,r.status);return}const i=et(r);if(c===z){const p=r.getResponseHeader("Content-Range"),e=/bytes (\d+)-(\d+)\/(\d+)/.exec(p);f.onDone({begin:parseInt(e[1],10),chunk:i})}else i?f.onDone({begin:0,chunk:i}):(s=f.onError)==null||s.call(f,r.status)}getRequestXhr(A){return this.pendingRequests[A].xhr}isPendingRequest(A){return A in this.pendingRequests}abortRequest(A){const g=this.pendingRequests[A].xhr;delete this.pendingRequests[A],g.abort()}}class S{constructor(A){this._source=A,this._manager=new B(A.url,{httpHeaders:A.httpHeaders,withCredentials:A.withCredentials}),this._rangeChunkSize=A.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(A){const g=this._rangeRequestReaders.indexOf(A);g>=0&&this._rangeRequestReaders.splice(g,1)}getFullReader(){return(0,b.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new P(this._manager,this._source),this._fullRequestReader}getRangeReader(A,g){const f=new L(this._manager,A,g);return f.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(f),f}cancelAllRequests(A){var g;(g=this._fullRequestReader)==null||g.cancel(A);for(const f of this._rangeRequestReaders.slice(0))f.cancel(A)}}m.PDFNetworkStream=S;class P{constructor(A,g){this._manager=A;const f={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=g.url,this._fullRequestId=A.requestFull(f),this._headersReceivedCapability=(0,b.createPromiseCapability)(),this._disableRange=g.disableRange||!1,this._contentLength=g.length,this._rangeChunkSize=g.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const A=this._fullRequestId,g=this._manager.getRequestXhr(A),f=u=>g.getResponseHeader(u),{allowRangeRequests:r,suggestedLength:c}=(0,w.validateRangeRequestCapabilities)({getResponseHeader:f,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});r&&(this._isRangeSupported=!0),this._contentLength=c||this._contentLength,this._filename=(0,w.extractFilenameFromHeader)(f),this._isRangeSupported&&this._manager.abortRequest(A),this._headersReceivedCapability.resolve()}_onDone(A){if(A&&(this._requests.length>0?this._requests.shift().resolve({value:A.chunk,done:!1}):this._cachedChunks.push(A.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const g of this._requests)g.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(A){this._storedError=(0,w.createResponseStatusError)(A,this._url),this._headersReceivedCapability.reject(this._storedError);for(const g of this._requests)g.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(A){var g;(g=this.onProgress)==null||g.call(this,{loaded:A.loaded,total:A.lengthComputable?A.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const A=(0,b.createPromiseCapability)();return this._requests.push(A),A.promise}cancel(A){this._done=!0,this._headersReceivedCapability.reject(A);for(const g of this._requests)g.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class L{constructor(A,g,f){this._manager=A;const r={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=A.url,this._requestId=A.requestRange(g,f,r),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var A;(A=this.onClosed)==null||A.call(this,this)}_onDone(A){const g=A.chunk;this._requests.length>0?this._requests.shift().resolve({value:g,done:!1}):this._queuedChunk=g,this._done=!0;for(const f of this._requests)f.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(A){this._storedError=(0,w.createResponseStatusError)(A,this._url);for(const g of this._requests)g.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(A){var g;this.isStreamingSupported||(g=this.onProgress)==null||g.call(this,{loaded:A.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const g=this._queuedChunk;return this._queuedChunk=null,{value:g,done:!1}}if(this._done)return{value:void 0,done:!0};const A=(0,b.createPromiseCapability)();return this._requests.push(A),A.promise}cancel(A){this._done=!0;for(const g of this._requests)g.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(ot,m,Q)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.PDFFetchStream=void 0;var b=Q(1),w=Q(22);function Y(L,T,A){return{method:"GET",headers:L,signal:A.signal,mode:"cors",credentials:T?"include":"same-origin",redirect:"follow"}}function z(L){const T=new Headers;for(const A in L){const g=L[A];g!==void 0&&T.append(A,g)}return T}function et(L){return L instanceof Uint8Array?L.buffer:L instanceof ArrayBuffer?L:((0,b.warn)(`getArrayBuffer - unexpected data format: ${L}`),new Uint8Array(L).buffer)}class B{constructor(T){this.source=T,this.isHttp=/^https?:/i.test(T.url),this.httpHeaders=this.isHttp&&T.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var T;return((T=this._fullRequestReader)==null?void 0:T._loaded)??0}getFullReader(){return(0,b.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new S(this),this._fullRequestReader}getRangeReader(T,A){if(A<=this._progressiveDataLength)return null;const g=new P(this,T,A);return this._rangeRequestReaders.push(g),g}cancelAllRequests(T){var A;(A=this._fullRequestReader)==null||A.cancel(T);for(const g of this._rangeRequestReaders.slice(0))g.cancel(T)}}m.PDFFetchStream=B;class S{constructor(T){this._stream=T,this._reader=null,this._loaded=0,this._filename=null;const A=T.source;this._withCredentials=A.withCredentials||!1,this._contentLength=A.length,this._headersCapability=(0,b.createPromiseCapability)(),this._disableRange=A.disableRange||!1,this._rangeChunkSize=A.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!A.disableStream,this._isRangeSupported=!A.disableRange,this._headers=z(this._stream.httpHeaders);const g=A.url;fetch(g,Y(this._headers,this._withCredentials,this._abortController)).then(f=>{if(!(0,w.validateResponseStatus)(f.status))throw(0,w.createResponseStatusError)(f.status,g);this._reader=f.body.getReader(),this._headersCapability.resolve();const r=i=>f.headers.get(i),{allowRangeRequests:c,suggestedLength:u}=(0,w.validateRangeRequestCapabilities)({getResponseHeader:r,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=c,this._contentLength=u||this._contentLength,this._filename=(0,w.extractFilenameFromHeader)(r),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new b.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var g;await this._headersCapability.promise;const{value:T,done:A}=await this._reader.read();return A?{value:T,done:A}:(this._loaded+=T.byteLength,(g=this.onProgress)==null||g.call(this,{loaded:this._loaded,total:this._contentLength}),{value:et(T),done:!1})}cancel(T){var A;(A=this._reader)==null||A.cancel(T),this._abortController.abort()}}class P{constructor(T,A,g){this._stream=T,this._reader=null,this._loaded=0;const f=T.source;this._withCredentials=f.withCredentials||!1,this._readCapability=(0,b.createPromiseCapability)(),this._isStreamingSupported=!f.disableStream,this._abortController=new AbortController,this._headers=z(this._stream.httpHeaders),this._headers.append("Range",`bytes=${A}-${g-1}`);const r=f.url;fetch(r,Y(this._headers,this._withCredentials,this._abortController)).then(c=>{if(!(0,w.validateResponseStatus)(c.status))throw(0,w.createResponseStatusError)(c.status,r);this._readCapability.resolve(),this._reader=c.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var g;await this._readCapability.promise;const{value:T,done:A}=await this._reader.read();return A?{value:T,done:A}:(this._loaded+=T.byteLength,(g=this.onProgress)==null||g.call(this,{loaded:this._loaded}),{value:et(T),done:!1})}cancel(T){var A;(A=this._reader)==null||A.cancel(T),this._abortController.abort()}}},(ot,m,Q)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.TextLayerRenderTask=void 0,m.renderTextLayer=f,m.updateTextLayer=r;var b=Q(1),w=Q(6);const Y=1e5,z=30,et=.8,B=new Map;function S(c,u){let i;if(u&&b.FeatureTest.isOffscreenCanvasSupported)i=new OffscreenCanvas(c,c).getContext("2d",{alpha:!1});else{const n=document.createElement("canvas");n.width=n.height=c,i=n.getContext("2d",{alpha:!1})}return i}function P(c,u){const i=B.get(c);if(i)return i;const n=S(z,u);n.font=`${z}px ${c}`;const t=n.measureText("");let s=t.fontBoundingBoxAscent,p=Math.abs(t.fontBoundingBoxDescent);if(s){const y=s/(s+p);return B.set(c,y),n.canvas.width=n.canvas.height=0,y}n.strokeStyle="red",n.clearRect(0,0,z,z),n.strokeText("g",0,0);let e=n.getImageData(0,0,z,z).data;p=0;for(let y=e.length-1-3;y>=0;y-=4)if(e[y]>0){p=Math.ceil(y/4/z);break}n.clearRect(0,0,z,z),n.strokeText("A",0,z),e=n.getImageData(0,0,z,z).data,s=0;for(let y=0,O=e.length;y<O;y+=4)if(e[y]>0){s=z-Math.floor(y/4/z);break}if(n.canvas.width=n.canvas.height=0,s){const y=s/(s+p);return B.set(c,y),y}return B.set(c,et),et}function L(c,u,i){const n=document.createElement("span"),t={angle:0,canvasWidth:0,hasText:u.str!=="",hasEOL:u.hasEOL,fontSize:0};c._textDivs.push(n);const s=b.Util.transform(c._transform,u.transform);let p=Math.atan2(s[1],s[0]);const e=i[u.fontName];e.vertical&&(p+=Math.PI/2);const y=Math.hypot(s[2],s[3]),O=y*P(e.fontFamily,c._isOffscreenCanvasSupported);let W,tt;p===0?(W=s[4],tt=s[5]-O):(W=s[4]+O*Math.sin(p),tt=s[5]-O*Math.cos(p));const gt="calc(var(--scale-factor)*",rt=n.style;c._container===c._rootContainer?(rt.left=`${(100*W/c._pageWidth).toFixed(2)}%`,rt.top=`${(100*tt/c._pageHeight).toFixed(2)}%`):(rt.left=`${gt}${W.toFixed(2)}px)`,rt.top=`${gt}${tt.toFixed(2)}px)`),rt.fontSize=`${gt}${y.toFixed(2)}px)`,rt.fontFamily=e.fontFamily,t.fontSize=y,n.setAttribute("role","presentation"),n.textContent=u.str,n.dir=u.dir,c._fontInspectorEnabled&&(n.dataset.fontName=u.fontName),p!==0&&(t.angle=p*(180/Math.PI));let ct=!1;if(u.str.length>1)ct=!0;else if(u.str!==" "&&u.transform[0]!==u.transform[3]){const K=Math.abs(u.transform[0]),H=Math.abs(u.transform[3]);K!==H&&Math.max(K,H)/Math.min(K,H)>1.5&&(ct=!0)}ct&&(t.canvasWidth=e.vertical?u.height:u.width),c._textDivProperties.set(n,t),c._isReadableStream&&c._layoutText(n)}function T(c){const{div:u,scale:i,properties:n,ctx:t,prevFontSize:s,prevFontFamily:p}=c,{style:e}=u;let y="";if(n.canvasWidth!==0&&n.hasText){const{fontFamily:O}=e,{canvasWidth:W,fontSize:tt}=n;(s!==tt||p!==O)&&(t.font=`${tt*i}px ${O}`,c.prevFontSize=tt,c.prevFontFamily=O);const{width:gt}=t.measureText(u.textContent);gt>0&&(y=`scaleX(${W*i/gt})`)}n.angle!==0&&(y=`rotate(${n.angle}deg) ${y}`),y.length>0&&(e.transform=y)}function A(c){if(c._canceled)return;const u=c._textDivs,i=c._capability;if(u.length>Y){i.resolve();return}if(!c._isReadableStream)for(const t of u)c._layoutText(t);i.resolve()}class g{constructor({textContentSource:u,container:i,viewport:n,textDivs:t,textDivProperties:s,textContentItemsStr:p,isOffscreenCanvasSupported:e}){var gt;this._textContentSource=u,this._isReadableStream=u instanceof ReadableStream,this._container=this._rootContainer=i,this._textDivs=t||[],this._textContentItemsStr=p||[],this._isOffscreenCanvasSupported=e,this._fontInspectorEnabled=!!((gt=globalThis.FontInspector)!=null&&gt.enabled),this._reader=null,this._textDivProperties=s||new WeakMap,this._canceled=!1,this._capability=(0,b.createPromiseCapability)(),this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:n.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:S(0,e)};const{pageWidth:y,pageHeight:O,pageX:W,pageY:tt}=n.rawDims;this._transform=[1,0,0,-1,-W,tt+O],this._pageWidth=y,this._pageHeight=O,(0,w.setLayerDimensions)(i,n),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new b.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new b.AbortException("TextLayer task cancelled."))}_processItems(u,i){for(const n of u){if(n.str===void 0){if(n.type==="beginMarkedContentProps"||n.type==="beginMarkedContent"){const t=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),n.id!==null&&this._container.setAttribute("id",`${n.id}`),t.append(this._container)}else n.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(n.str),L(this,n,i)}}_layoutText(u){const i=this._layoutTextParams.properties=this._textDivProperties.get(u);if(this._layoutTextParams.div=u,T(this._layoutTextParams),i.hasText&&this._container.append(u),i.hasEOL){const n=document.createElement("br");n.setAttribute("role","presentation"),this._container.append(n)}}_render(){const u=(0,b.createPromiseCapability)();let i=Object.create(null);if(this._isReadableStream){const n=()=>{this._reader.read().then(({value:t,done:s})=>{if(s){u.resolve();return}Object.assign(i,t.styles),this._processItems(t.items,i),n()},u.reject)};this._reader=this._textContentSource.getReader(),n()}else if(this._textContentSource){const{items:n,styles:t}=this._textContentSource;this._processItems(n,t),u.resolve()}else throw new Error('No "textContentSource" parameter specified.');u.promise.then(()=>{i=null,A(this)},this._capability.reject)}}m.TextLayerRenderTask=g;function f(c){!c.textContentSource&&(c.textContent||c.textContentStream)&&((0,w.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),c.textContentSource=c.textContent||c.textContentStream);const u=new g(c);return u._render(),u}function r({container:c,viewport:u,textDivs:i,textDivProperties:n,isOffscreenCanvasSupported:t,mustRotate:s=!0,mustRescale:p=!0}){if(s&&(0,w.setLayerDimensions)(c,{rotation:u.rotation}),p){const e=S(0,t),O={prevFontSize:null,prevFontFamily:null,div:null,scale:u.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:e};for(const W of i)O.properties=n.get(W),O.div=W,T(O)}}},(ot,m,Q)=>{var S,P,L,T,A,g,f,r,c,oe,xe,le,ce;Object.defineProperty(m,"__esModule",{value:!0}),m.AnnotationEditorLayer=void 0;var b=Q(1),w=Q(5),Y=Q(28),z=Q(29),et=Q(6);const s=class s{constructor(e){ut(this,c);ut(this,S);ut(this,P,!1);ut(this,L,this.pointerup.bind(this));ut(this,T,this.pointerdown.bind(this));ut(this,A,new Map);ut(this,g,!1);ut(this,f,!1);ut(this,r);s._initialized||(s._initialized=!0,Y.FreeTextEditor.initialize(e.l10n),z.InkEditor.initialize(e.l10n)),e.uiManager.registerEditorTypes([Y.FreeTextEditor,z.InkEditor]),pt(this,r,e.uiManager),this.pageIndex=e.pageIndex,this.div=e.div,pt(this,S,e.accessibilityManager),_(this,r).addLayer(this)}get isEmpty(){return _(this,A).size===0}updateToolbar(e){_(this,r).updateToolbar(e)}updateMode(e=_(this,r).getMode()){lt(this,c,ce).call(this),e===b.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),_(this,r).unselectAll(),e!==b.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",e===b.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",e===b.AnnotationEditorType.INK),this.div.hidden=!1)}addInkEditorIfNeeded(e){if(!e&&_(this,r).getMode()!==b.AnnotationEditorType.INK)return;if(!e){for(const O of _(this,A).values())if(O.isEmpty()){O.setInBackground();return}}lt(this,c,le).call(this,{offsetX:0,offsetY:0}).setInBackground()}setEditingState(e){_(this,r).setEditingState(e)}addCommands(e){_(this,r).addCommands(e)}enable(){this.div.style.pointerEvents="auto";for(const e of _(this,A).values())e.enableEditing()}disable(){this.div.style.pointerEvents="none";for(const e of _(this,A).values())e.disableEditing();lt(this,c,ce).call(this),this.isEmpty&&(this.div.hidden=!0)}setActiveEditor(e){_(this,r).getActive()!==e&&_(this,r).setActiveEditor(e)}enableClick(){this.div.addEventListener("pointerdown",_(this,T)),this.div.addEventListener("pointerup",_(this,L))}disableClick(){this.div.removeEventListener("pointerdown",_(this,T)),this.div.removeEventListener("pointerup",_(this,L))}attach(e){_(this,A).set(e.id,e)}detach(e){var y;_(this,A).delete(e.id),(y=_(this,S))==null||y.removePointerInTextLayer(e.contentDiv)}remove(e){_(this,r).removeEditor(e),this.detach(e),e.div.style.display="none",setTimeout(()=>{e.div.style.display="",e.div.remove(),e.isAttachedToDOM=!1,document.activeElement===document.body&&_(this,r).focusMainContainer()},0),_(this,f)||this.addInkEditorIfNeeded(!1)}add(e){if(lt(this,c,oe).call(this,e),_(this,r).addEditor(e),this.attach(e),!e.isAttachedToDOM){const y=e.render();this.div.append(y),e.isAttachedToDOM=!0}this.moveEditorInDOM(e),e.onceAdded(),_(this,r).addToAnnotationStorage(e)}moveEditorInDOM(e){var y;(y=_(this,S))==null||y.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?e.rebuild():this.add(e)}addANewEditor(e){const y=()=>{this.addOrRebuild(e)},O=()=>{e.remove()};this.addCommands({cmd:y,undo:O,mustExec:!0})}addUndoableEditor(e){const y=()=>{this.addOrRebuild(e)},O=()=>{e.remove()};this.addCommands({cmd:y,undo:O,mustExec:!1})}getNextId(){return _(this,r).getId()}deserialize(e){switch(e.annotationType){case b.AnnotationEditorType.FREETEXT:return Y.FreeTextEditor.deserialize(e,this,_(this,r));case b.AnnotationEditorType.INK:return z.InkEditor.deserialize(e,this,_(this,r))}return null}setSelected(e){_(this,r).setSelected(e)}toggleSelected(e){_(this,r).toggleSelected(e)}isSelected(e){return _(this,r).isSelected(e)}unselect(e){_(this,r).unselect(e)}pointerup(e){const{isMac:y}=b.FeatureTest.platform;if(!(e.button!==0||e.ctrlKey&&y)&&e.target===this.div&&_(this,g)){if(pt(this,g,!1),!_(this,P)){pt(this,P,!0);return}lt(this,c,le).call(this,e)}}pointerdown(e){const{isMac:y}=b.FeatureTest.platform;if(e.button!==0||e.ctrlKey&&y||e.target!==this.div)return;pt(this,g,!0);const O=_(this,r).getActive();pt(this,P,!O||O.isEmpty())}drop(e){const y=e.dataTransfer.getData("text/plain"),O=_(this,r).getEditor(y);if(!O)return;e.preventDefault(),e.dataTransfer.dropEffect="move",lt(this,c,oe).call(this,O);const W=this.div.getBoundingClientRect(),tt=e.clientX-W.x,gt=e.clientY-W.y;O.translate(tt-O.startX,gt-O.startY),this.moveEditorInDOM(O),O.div.focus()}dragover(e){e.preventDefault()}destroy(){var e,y;((e=_(this,r).getActive())==null?void 0:e.parent)===this&&_(this,r).setActiveEditor(null);for(const O of _(this,A).values())(y=_(this,S))==null||y.removePointerInTextLayer(O.contentDiv),O.setParent(null),O.isAttachedToDOM=!1,O.div.remove();this.div=null,_(this,A).clear(),_(this,r).removeLayer(this)}render({viewport:e}){this.viewport=e,(0,et.setLayerDimensions)(this.div,e),(0,w.bindEvents)(this,this.div,["dragover","drop"]);for(const y of _(this,r).getEditors(this.pageIndex))this.add(y);this.updateMode()}update({viewport:e}){_(this,r).commitOrRemove(),this.viewport=e,(0,et.setLayerDimensions)(this.div,{rotation:e.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:e,pageHeight:y}=this.viewport.rawDims;return[e,y]}};S=new WeakMap,P=new WeakMap,L=new WeakMap,T=new WeakMap,A=new WeakMap,g=new WeakMap,f=new WeakMap,r=new WeakMap,c=new WeakSet,oe=function(e){var y;e.parent!==this&&(this.attach(e),(y=e.parent)==null||y.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))},xe=function(e){switch(_(this,r).getMode()){case b.AnnotationEditorType.FREETEXT:return new Y.FreeTextEditor(e);case b.AnnotationEditorType.INK:return new z.InkEditor(e)}return null},le=function(e){const y=this.getNextId(),O=lt(this,c,xe).call(this,{parent:this,id:y,x:e.offsetX,y:e.offsetY,uiManager:_(this,r)});return O&&this.add(O),O},ce=function(){pt(this,f,!0);for(const e of _(this,A).values())e.isEmpty()&&e.remove();pt(this,f,!1)},St(s,"_initialized",!1);let B=s;m.AnnotationEditorLayer=B},(ot,m,Q)=>{var et,B,S,P,L,T,A,g,f,r,we,ke,Re,he;Object.defineProperty(m,"__esModule",{value:!0}),m.FreeTextEditor=void 0;var b=Q(1),w=Q(5),Y=Q(4);const t=class t extends Y.AnnotationEditor{constructor(e){super({...e,name:"freeTextEditor"});ut(this,r);ut(this,et,this.editorDivBlur.bind(this));ut(this,B,this.editorDivFocus.bind(this));ut(this,S,this.editorDivInput.bind(this));ut(this,P,this.editorDivKeydown.bind(this));ut(this,L);ut(this,T,"");ut(this,A,`${this.id}-editor`);ut(this,g,!1);ut(this,f);pt(this,L,e.color||t._defaultColor||Y.AnnotationEditor._defaultLineColor),pt(this,f,e.fontSize||t._defaultFontSize)}static initialize(e){this._l10nPromise=new Map(["free_text2_default_content","editor_free_text2_aria_label"].map(O=>[O,e.get(O)]));const y=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(y.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,y){switch(e){case b.AnnotationEditorParamsType.FREETEXT_SIZE:t._defaultFontSize=y;break;case b.AnnotationEditorParamsType.FREETEXT_COLOR:t._defaultColor=y;break}}updateParams(e,y){switch(e){case b.AnnotationEditorParamsType.FREETEXT_SIZE:lt(this,r,we).call(this,y);break;case b.AnnotationEditorParamsType.FREETEXT_COLOR:lt(this,r,ke).call(this,y);break}}static get defaultPropertiesToUpdate(){return[[b.AnnotationEditorParamsType.FREETEXT_SIZE,t._defaultFontSize],[b.AnnotationEditorParamsType.FREETEXT_COLOR,t._defaultColor||Y.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[b.AnnotationEditorParamsType.FREETEXT_SIZE,_(this,f)],[b.AnnotationEditorParamsType.FREETEXT_COLOR,_(this,L)]]}getInitialTranslation(){const e=this.parentScale;return[-t._internalPadding*e,-(t._internalPadding+_(this,f))*e]}rebuild(){super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(b.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this.div.draggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",_(this,P)),this.editorDiv.addEventListener("focus",_(this,B)),this.editorDiv.addEventListener("blur",_(this,et)),this.editorDiv.addEventListener("input",_(this,S)))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",_(this,A)),this.div.draggable=!0,this.editorDiv.removeEventListener("keydown",_(this,P)),this.editorDiv.removeEventListener("focus",_(this,B)),this.editorDiv.removeEventListener("blur",_(this,et)),this.editorDiv.removeEventListener("input",_(this,S)),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(e){super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus()}onceAdded(){this.width||(this.enableEditMode(),this.editorDiv.focus())}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing"),super.remove()}commit(){this.isInEditMode()&&(super.commit(),_(this,g)||(pt(this,g,!0),this.parent.addUndoableEditor(this)),this.disableEditMode(),pt(this,T,lt(this,r,Re).call(this).trimEnd()),lt(this,r,he).call(this))}shouldGetKeyboardEvents(){return this.isInEditMode()}dblclick(e){this.enableEditMode(),this.editorDiv.focus()}keydown(e){e.target===this.div&&e.key==="Enter"&&(this.enableEditMode(),this.editorDiv.focus())}editorDivKeydown(e){t._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let e,y;this.width&&(e=this.x,y=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",_(this,A)),this.enableEditing(),t._l10nPromise.get("editor_free_text2_aria_label").then(W=>{var tt;return(tt=this.editorDiv)==null?void 0:tt.setAttribute("aria-label",W)}),t._l10nPromise.get("free_text2_default_content").then(W=>{var tt;return(tt=this.editorDiv)==null?void 0:tt.setAttribute("default-content",W)}),this.editorDiv.contentEditable=!0;const{style:O}=this.editorDiv;if(O.fontSize=`calc(${_(this,f)}px * var(--scale-factor))`,O.color=_(this,L),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,w.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[W,tt]=this.parentDimensions;this.setAt(e*W,y*tt,this.width*W,this.height*tt);for(const gt of _(this,T).split(`
`)){const rt=document.createElement("div");rt.append(gt?document.createTextNode(gt):document.createElement("br")),this.editorDiv.append(rt)}this.div.draggable=!0,this.editorDiv.contentEditable=!1}else this.div.draggable=!1,this.editorDiv.contentEditable=!0;return this.div}get contentDiv(){return this.editorDiv}static deserialize(e,y,O){const W=super.deserialize(e,y,O);return pt(W,f,e.fontSize),pt(W,L,b.Util.makeHexColor(...e.color)),pt(W,T,e.value),W}serialize(){if(this.isEmpty())return null;const e=t._internalPadding*this.parentScale,y=this.getRect(e,e),O=Y.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:_(this,L));return{annotationType:b.AnnotationEditorType.FREETEXT,color:O,fontSize:_(this,f),value:_(this,T),pageIndex:this.pageIndex,rect:y,rotation:this.rotation}}};et=new WeakMap,B=new WeakMap,S=new WeakMap,P=new WeakMap,L=new WeakMap,T=new WeakMap,A=new WeakMap,g=new WeakMap,f=new WeakMap,r=new WeakSet,we=function(e){const y=W=>{this.editorDiv.style.fontSize=`calc(${W}px * var(--scale-factor))`,this.translate(0,-(W-_(this,f))*this.parentScale),pt(this,f,W),lt(this,r,he).call(this)},O=_(this,f);this.addCommands({cmd:()=>{y(e)},undo:()=>{y(O)},mustExec:!0,type:b.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},ke=function(e){const y=_(this,L);this.addCommands({cmd:()=>{pt(this,L,this.editorDiv.style.color=e)},undo:()=>{pt(this,L,this.editorDiv.style.color=y)},mustExec:!0,type:b.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},Re=function(){const e=this.editorDiv.getElementsByTagName("div");if(e.length===0)return this.editorDiv.innerText;const y=[];for(const O of e)y.push(O.innerText.replace(/\r\n?|\n/,""));return y.join(`
`)},he=function(){const[e,y]=this.parentDimensions;let O;if(this.isAttachedToDOM)O=this.div.getBoundingClientRect();else{const{currentLayer:W,div:tt}=this,gt=tt.style.display;tt.style.display="hidden",W.div.append(this.div),O=tt.getBoundingClientRect(),tt.remove(),tt.style.display=gt}this.width=O.width/e,this.height=O.height/y},St(t,"_freeTextDefaultContent",""),St(t,"_l10nPromise"),St(t,"_internalPadding",0),St(t,"_defaultColor",null),St(t,"_defaultFontSize",10),St(t,"_keyboardManager",new w.KeyboardManager([[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.prototype.commitOrRemove]])),St(t,"_type","freetext");let z=t;m.FreeTextEditor=z},(ot,m,Q)=>{var P,L,T,A,g,f,r,c,u,i,n,t,s,p,e,Fe,Me,De,Oe,de,Ie,Le,Ne,Mt,ue,Xt,Vt,Lt,fe,zt,v,pe,Ue,je,Be,ge,$t,Nt,me;Object.defineProperty(m,"__esModule",{value:!0}),m.InkEditor=void 0,Object.defineProperty(m,"fitCurve",{enumerable:!0,get:function(){return Y.fitCurve}});var b=Q(1),w=Q(4),Y=Q(30),z=Q(5);const et=16,B=100,l=class l extends w.AnnotationEditor{constructor(d){super({...d,name:"inkEditor"});ut(this,e);ut(this,P,0);ut(this,L,0);ut(this,T,0);ut(this,A,this.canvasPointermove.bind(this));ut(this,g,this.canvasPointerleave.bind(this));ut(this,f,this.canvasPointerup.bind(this));ut(this,r,this.canvasPointerdown.bind(this));ut(this,c,!1);ut(this,u,!1);ut(this,i,null);ut(this,n,null);ut(this,t,0);ut(this,s,0);ut(this,p,null);this.color=d.color||null,this.thickness=d.thickness||null,this.opacity=d.opacity||null,this.paths=[],this.bezierPath2D=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0}static initialize(d){this._l10nPromise=new Map(["editor_ink_canvas_aria_label","editor_ink2_aria_label"].map(F=>[F,d.get(F)]))}static updateDefaultParams(d,F){switch(d){case b.AnnotationEditorParamsType.INK_THICKNESS:l._defaultThickness=F;break;case b.AnnotationEditorParamsType.INK_COLOR:l._defaultColor=F;break;case b.AnnotationEditorParamsType.INK_OPACITY:l._defaultOpacity=F/100;break}}updateParams(d,F){switch(d){case b.AnnotationEditorParamsType.INK_THICKNESS:lt(this,e,Fe).call(this,F);break;case b.AnnotationEditorParamsType.INK_COLOR:lt(this,e,Me).call(this,F);break;case b.AnnotationEditorParamsType.INK_OPACITY:lt(this,e,De).call(this,F);break}}static get defaultPropertiesToUpdate(){return[[b.AnnotationEditorParamsType.INK_THICKNESS,l._defaultThickness],[b.AnnotationEditorParamsType.INK_COLOR,l._defaultColor||w.AnnotationEditor._defaultLineColor],[b.AnnotationEditorParamsType.INK_OPACITY,Math.round(l._defaultOpacity*100)]]}get propertiesToUpdate(){return[[b.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||l._defaultThickness],[b.AnnotationEditorParamsType.INK_COLOR,this.color||l._defaultColor||w.AnnotationEditor._defaultLineColor],[b.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??l._defaultOpacity))]]}rebuild(){super.rebuild(),this.div!==null&&(this.canvas||(lt(this,e,Xt).call(this),lt(this,e,Vt).call(this)),this.isAttachedToDOM||(this.parent.add(this),lt(this,e,Lt).call(this)),lt(this,e,Nt).call(this))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,_(this,n).disconnect(),pt(this,n,null),super.remove())}setParent(d){!this.parent&&d?this._uiManager.removeShouldRescale(this):this.parent&&d===null&&this._uiManager.addShouldRescale(this),super.setParent(d)}onScaleChanging(){const[d,F]=this.parentDimensions,N=this.width*d,j=this.height*F;this.setDimensions(N,j)}enableEditMode(){_(this,c)||this.canvas===null||(super.enableEditMode(),this.div.draggable=!1,this.canvas.addEventListener("pointerdown",_(this,r)),this.canvas.addEventListener("pointerup",_(this,f)))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this.div.draggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",_(this,r)),this.canvas.removeEventListener("pointerup",_(this,f)))}onceAdded(){this.div.draggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}commit(){_(this,c)||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),pt(this,c,!0),this.div.classList.add("disabled"),lt(this,e,Nt).call(this,!0),this.parent.addInkEditorIfNeeded(!0),this.parent.moveEditorInDOM(this),this.div.focus({preventScroll:!0}))}focusin(d){super.focusin(d),this.enableEditMode()}canvasPointerdown(d){d.button!==0||!this.isInEditMode()||_(this,c)||(this.setInForeground(),d.type!=="mouse"&&this.div.focus(),d.stopPropagation(),this.canvas.addEventListener("pointerleave",_(this,g)),this.canvas.addEventListener("pointermove",_(this,A)),lt(this,e,Ie).call(this,d.offsetX,d.offsetY))}canvasPointermove(d){d.stopPropagation(),lt(this,e,Le).call(this,d.offsetX,d.offsetY)}canvasPointerup(d){d.button===0&&this.isInEditMode()&&this.currentPath.length!==0&&(d.stopPropagation(),lt(this,e,ue).call(this,d),this.setInBackground())}canvasPointerleave(d){lt(this,e,ue).call(this,d),this.setInBackground()}render(){if(this.div)return this.div;let d,F;this.width&&(d=this.x,F=this.y),super.render(),l._l10nPromise.get("editor_ink2_aria_label").then(U=>{var I;return(I=this.div)==null?void 0:I.setAttribute("aria-label",U)});const[N,j,Z,x]=lt(this,e,Oe).call(this);if(this.setAt(N,j,0,0),this.setDims(Z,x),lt(this,e,Xt).call(this),this.width){const[U,I]=this.parentDimensions;this.setAt(d*U,F*I,this.width*U,this.height*I),pt(this,u,!0),lt(this,e,Lt).call(this),this.setDims(this.width*U,this.height*I),lt(this,e,Mt).call(this),lt(this,e,me).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return lt(this,e,Vt).call(this),this.div}setDimensions(d,F){const N=Math.round(d),j=Math.round(F);if(_(this,t)===N&&_(this,s)===j)return;pt(this,t,N),pt(this,s,j),this.canvas.style.visibility="hidden",_(this,P)&&Math.abs(_(this,P)-d/F)>.01&&(F=Math.ceil(d/_(this,P)),this.setDims(d,F));const[Z,x]=this.parentDimensions;this.width=d/Z,this.height=F/x,_(this,c)&&lt(this,e,fe).call(this,d,F),lt(this,e,Lt).call(this),lt(this,e,Mt).call(this),this.canvas.style.visibility="visible"}static deserialize(d,F,N){var bt,_t;const j=super.deserialize(d,F,N);j.thickness=d.thickness,j.color=b.Util.makeHexColor(...d.color),j.opacity=d.opacity;const[Z,x]=j.pageDimensions,U=j.width*Z,I=j.height*x,it=j.parentScale,dt=d.thickness/2;pt(j,P,U/I),pt(j,c,!0),pt(j,t,Math.round(U)),pt(j,s,Math.round(I));for(const{bezier:yt}of d.paths){const vt=[];j.paths.push(vt);let at=it*(yt[0]-dt),V=it*(I-yt[1]-dt);for(let mt=2,At=yt.length;mt<At;mt+=6){const Et=it*(yt[mt]-dt),Ct=it*(I-yt[mt+1]-dt),kt=it*(yt[mt+2]-dt),Rt=it*(I-yt[mt+3]-dt),Ft=it*(yt[mt+4]-dt),Pt=it*(I-yt[mt+5]-dt);vt.push([[at,V],[Et,Ct],[kt,Rt],[Ft,Pt]]),at=Ft,V=Pt}const X=lt(this,v,pe).call(this,vt);j.bezierPath2D.push(X)}const ft=lt(bt=j,e,ge).call(bt);return pt(j,T,Math.max(et,ft[2]-ft[0])),pt(j,L,Math.max(et,ft[3]-ft[1])),lt(_t=j,e,fe).call(_t,U,I),j}serialize(){if(this.isEmpty())return null;const d=this.getRect(0,0),F=this.rotation%180===0?d[3]-d[1]:d[2]-d[0],N=w.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:b.AnnotationEditorType.INK,color:N,thickness:this.thickness,opacity:this.opacity,paths:lt(this,e,Ue).call(this,this.scaleFactor/this.parentScale,this.translationX,this.translationY,F),pageIndex:this.pageIndex,rect:d,rotation:this.rotation}}};P=new WeakMap,L=new WeakMap,T=new WeakMap,A=new WeakMap,g=new WeakMap,f=new WeakMap,r=new WeakMap,c=new WeakMap,u=new WeakMap,i=new WeakMap,n=new WeakMap,t=new WeakMap,s=new WeakMap,p=new WeakMap,e=new WeakSet,Fe=function(d){const F=this.thickness;this.addCommands({cmd:()=>{this.thickness=d,lt(this,e,Nt).call(this)},undo:()=>{this.thickness=F,lt(this,e,Nt).call(this)},mustExec:!0,type:b.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})},Me=function(d){const F=this.color;this.addCommands({cmd:()=>{this.color=d,lt(this,e,Mt).call(this)},undo:()=>{this.color=F,lt(this,e,Mt).call(this)},mustExec:!0,type:b.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})},De=function(d){d/=100;const F=this.opacity;this.addCommands({cmd:()=>{this.opacity=d,lt(this,e,Mt).call(this)},undo:()=>{this.opacity=F,lt(this,e,Mt).call(this)},mustExec:!0,type:b.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})},Oe=function(){const{parentRotation:d,parentDimensions:[F,N]}=this;switch(d){case 90:return[0,N,N,F];case 180:return[F,N,F,N];case 270:return[F,0,N,F];default:return[0,0,F,N]}},de=function(){const{ctx:d,color:F,opacity:N,thickness:j,parentScale:Z,scaleFactor:x}=this;d.lineWidth=j*Z/x,d.lineCap="round",d.lineJoin="round",d.miterLimit=10,d.strokeStyle=`${F}${(0,z.opacityToHex)(N)}`},Ie=function(d,F){this.isEditing=!0,_(this,u)||(pt(this,u,!0),lt(this,e,Lt).call(this),this.thickness||(this.thickness=l._defaultThickness),this.color||(this.color=l._defaultColor||w.AnnotationEditor._defaultLineColor),this.opacity??(this.opacity=l._defaultOpacity)),this.currentPath.push([d,F]),pt(this,i,null),lt(this,e,de).call(this),this.ctx.beginPath(),this.ctx.moveTo(d,F),pt(this,p,()=>{_(this,p)&&(_(this,i)&&(this.isEmpty()?(this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)):lt(this,e,Mt).call(this),this.ctx.lineTo(..._(this,i)),pt(this,i,null),this.ctx.stroke()),window.requestAnimationFrame(_(this,p)))}),window.requestAnimationFrame(_(this,p))},Le=function(d,F){const[N,j]=this.currentPath.at(-1);d===N&&F===j||(this.currentPath.push([d,F]),pt(this,i,[d,F]))},Ne=function(d,F){var it;this.ctx.closePath(),pt(this,p,null),d=Math.min(Math.max(d,0),this.canvas.width),F=Math.min(Math.max(F,0),this.canvas.height);const[N,j]=this.currentPath.at(-1);(d!==N||F!==j)&&this.currentPath.push([d,F]);let Z;if(this.currentPath.length!==1)Z=(0,Y.fitCurve)(this.currentPath,30,null);else{const dt=[d,F];Z=[[dt,dt.slice(),dt.slice(),dt]]}const x=lt(it=l,v,pe).call(it,Z);this.currentPath.length=0;const U=()=>{this.paths.push(Z),this.bezierPath2D.push(x),this.rebuild()},I=()=>{this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(lt(this,e,Xt).call(this),lt(this,e,Vt).call(this)),lt(this,e,Nt).call(this))};this.addCommands({cmd:U,undo:I,mustExec:!0})},Mt=function(){if(this.isEmpty()){lt(this,e,zt).call(this);return}lt(this,e,de).call(this);const{canvas:d,ctx:F}=this;F.setTransform(1,0,0,1,0,0),F.clearRect(0,0,d.width,d.height),lt(this,e,zt).call(this);for(const N of this.bezierPath2D)F.stroke(N)},ue=function(d){lt(this,e,Ne).call(this,d.offsetX,d.offsetY),this.canvas.removeEventListener("pointerleave",_(this,g)),this.canvas.removeEventListener("pointermove",_(this,A)),this.addToAnnotationStorage()},Xt=function(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",l._l10nPromise.get("editor_ink_canvas_aria_label").then(d=>{var F;return(F=this.canvas)==null?void 0:F.setAttribute("aria-label",d)}),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")},Vt=function(){let d=null;pt(this,n,new ResizeObserver(F=>{const N=F[0].contentRect;N.width&&N.height&&(d!==null&&clearTimeout(d),d=setTimeout(()=>{this.fixDims(),d=null},B),this.setDimensions(N.width,N.height))})),_(this,n).observe(this.div)},Lt=function(){if(!_(this,u))return;const[d,F]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*d),this.canvas.height=Math.ceil(this.height*F),lt(this,e,zt).call(this)},fe=function(d,F){const N=lt(this,e,$t).call(this),j=(d-N)/_(this,T),Z=(F-N)/_(this,L);this.scaleFactor=Math.min(j,Z)},zt=function(){const d=lt(this,e,$t).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+d,this.translationY*this.scaleFactor+d)},v=new WeakSet,pe=function(d){const F=new Path2D;for(let N=0,j=d.length;N<j;N++){const[Z,x,U,I]=d[N];N===0&&F.moveTo(...Z),F.bezierCurveTo(x[0],x[1],U[0],U[1],I[0],I[1])}return F},Ue=function(d,F,N,j){const x=[],U=this.thickness/2;let I,it;for(const dt of this.paths){I=[],it=[];for(let ft=0,bt=dt.length;ft<bt;ft++){const[_t,yt,vt,at]=dt[ft],V=d*(_t[0]+F)+U,X=j-d*(_t[1]+N)-U,mt=d*(yt[0]+F)+U,At=j-d*(yt[1]+N)-U,Et=d*(vt[0]+F)+U,Ct=j-d*(vt[1]+N)-U,kt=d*(at[0]+F)+U,Rt=j-d*(at[1]+N)-U;ft===0&&(I.push(V,X),it.push(V,X)),I.push(mt,At,Et,Ct,kt,Rt),lt(this,e,je).call(this,V,X,mt,At,Et,Ct,kt,Rt,4,it)}x.push({bezier:I,points:it})}return x},je=function(d,F,N,j,Z,x,U,I,it,dt){if(lt(this,e,Be).call(this,d,F,N,j,Z,x,U,I)){dt.push(U,I);return}for(let ft=1;ft<it-1;ft++){const bt=ft/it,_t=1-bt;let yt=bt*d+_t*N,vt=bt*F+_t*j,at=bt*N+_t*Z,V=bt*j+_t*x;const X=bt*Z+_t*U,mt=bt*x+_t*I;yt=bt*yt+_t*at,vt=bt*vt+_t*V,at=bt*at+_t*X,V=bt*V+_t*mt,yt=bt*yt+_t*at,vt=bt*vt+_t*V,dt.push(yt,vt)}dt.push(U,I)},Be=function(d,F,N,j,Z,x,U,I){const dt=(3*N-2*d-U)**2,ft=(3*j-2*F-I)**2,bt=(3*Z-d-2*U)**2,_t=(3*x-F-2*I)**2;return Math.max(dt,bt)+Math.max(ft,_t)<=10},ge=function(){let d=1/0,F=-1/0,N=1/0,j=-1/0;for(const Z of this.paths)for(const[x,U,I,it]of Z){const dt=b.Util.bezierBoundingBox(...x,...U,...I,...it);d=Math.min(d,dt[0]),N=Math.min(N,dt[1]),F=Math.max(F,dt[2]),j=Math.max(j,dt[3])}return[d,N,F,j]},$t=function(){return _(this,c)?Math.ceil(this.thickness*this.parentScale):0},Nt=function(d=!1){if(this.isEmpty())return;if(!_(this,c)){lt(this,e,Mt).call(this);return}const F=lt(this,e,ge).call(this),N=lt(this,e,$t).call(this);pt(this,T,Math.max(et,F[2]-F[0])),pt(this,L,Math.max(et,F[3]-F[1]));const j=Math.ceil(N+_(this,T)*this.scaleFactor),Z=Math.ceil(N+_(this,L)*this.scaleFactor),[x,U]=this.parentDimensions;this.width=j/x,this.height=Z/U,pt(this,P,j/Z),lt(this,e,me).call(this);const I=this.translationX,it=this.translationY;this.translationX=-F[0],this.translationY=-F[1],lt(this,e,Lt).call(this),lt(this,e,Mt).call(this),pt(this,t,j),pt(this,s,Z),this.setDims(j,Z);const dt=d?N/this.scaleFactor/2:0;this.translate(I-this.translationX-dt,it-this.translationY-dt)},me=function(){const{style:d}=this.div;_(this,P)>=1?(d.minHeight=`${et}px`,d.minWidth=`${Math.round(_(this,P)*et)}px`):(d.minWidth=`${et}px`,d.minHeight=`${Math.round(et/_(this,P))}px`)},ut(l,v),St(l,"_defaultColor",null),St(l,"_defaultOpacity",1),St(l,"_defaultThickness",1),St(l,"_l10nPromise"),St(l,"_type","ink");let S=l;m.InkEditor=S},(ot,m,Q)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.fitCurve=void 0;const b=Q(31);m.fitCurve=b},ot=>{function m(g,f,r){if(!Array.isArray(g))throw new TypeError("First argument should be an array");if(g.forEach(n=>{if(!Array.isArray(n)||n.some(t=>typeof t!="number")||n.length!==g[0].length)throw Error("Each point should be an array of numbers. Each point should have the same amount of numbers.")}),g=g.filter((n,t)=>t===0||!n.every((s,p)=>s===g[t-1][p])),g.length<2)return[];const c=g.length,u=L(g[1],g[0]),i=L(g[c-2],g[c-1]);return Q(g,u,i,f,r)}function Q(g,f,r,c,u){var n,t,s,p,e,y,O,W,tt,gt,rt,ct,K;if(g.length===2)return ct=T.vectorLen(T.subtract(g[0],g[1]))/3,n=[g[0],T.addArrays(g[0],T.mulItems(f,ct)),T.addArrays(g[1],T.mulItems(r,ct)),g[1]],[n];if(t=et(g),[n,p,y]=b(g,t,t,f,r,u),p===0||p<c)return[n];if(p<c*c)for(s=t,e=p,O=y,K=0;K<20;K++){if(s=Y(n,g,s),[n,p,y]=b(g,t,s,f,r,u),p<c)return[n];if(y===O){let H=p/e;if(H>.9999&&H<1.0001)break}e=p,O=y}return rt=[],W=T.subtract(g[y-1],g[y+1]),W.every(H=>H===0)&&(W=T.subtract(g[y-1],g[y]),[W[0],W[1]]=[-W[1],W[0]]),tt=T.normalize(W),gt=T.mulItems(tt,-1),rt=rt.concat(Q(g.slice(0,y+1),f,tt,c,u)),rt=rt.concat(Q(g.slice(y),gt,r,c,u)),rt}function b(g,f,r,c,u,i){var n,t,s;return n=w(g,r,c,u),[t,s]=B(g,n,f),i&&i({bez:n,points:g,params:f,maxErr:t,maxPoint:s}),[n,t,s]}function w(g,f,r,c){var u,i,n,t,s,p,e,y,O,W,tt,gt,rt,ct,K,H,G,st=g[0],ht=g[g.length-1];for(u=[st,null,null,ht],i=T.zeros_Xx2x2(f.length),rt=0,ct=f.length;rt<ct;rt++)H=f[rt],G=1-H,n=i[rt],n[0]=T.mulItems(r,3*H*(G*G)),n[1]=T.mulItems(c,3*G*(H*H));for(t=[[0,0],[0,0]],s=[0,0],rt=0,ct=g.length;rt<ct;rt++)H=f[rt],n=i[rt],t[0][0]+=T.dot(n[0],n[0]),t[0][1]+=T.dot(n[0],n[1]),t[1][0]+=T.dot(n[0],n[1]),t[1][1]+=T.dot(n[1],n[1]),K=T.subtract(g[rt],A.q([st,st,ht,ht],H)),s[0]+=T.dot(n[0],K),s[1]+=T.dot(n[1],K);return p=t[0][0]*t[1][1]-t[1][0]*t[0][1],e=t[0][0]*s[1]-t[1][0]*s[0],y=s[0]*t[1][1]-s[1]*t[0][1],O=p===0?0:y/p,W=p===0?0:e/p,gt=T.vectorLen(T.subtract(st,ht)),tt=1e-6*gt,O<tt||W<tt?(u[1]=T.addArrays(st,T.mulItems(r,gt/3)),u[2]=T.addArrays(ht,T.mulItems(c,gt/3))):(u[1]=T.addArrays(st,T.mulItems(r,O)),u[2]=T.addArrays(ht,T.mulItems(c,W))),u}function Y(g,f,r){return r.map((c,u)=>z(g,f[u],c))}function z(g,f,r){var c=T.subtract(A.q(g,r),f),u=A.qprime(g,r),i=T.mulMatrix(c,u),n=T.sum(T.squareItems(u))+2*T.mulMatrix(c,A.qprimeprime(g,r));return n===0?r:r-i/n}function et(g){var f=[],r,c,u;return g.forEach((i,n)=>{r=n?c+T.vectorLen(T.subtract(i,u)):0,f.push(r),c=r,u=i}),f=f.map(i=>i/c),f}function B(g,f,r){var c,u,i,n,t,s,p,e;u=0,i=Math.floor(g.length/2);const y=S(f,10);for(t=0,s=g.length;t<s;t++)p=g[t],e=P(f,r[t],y,10),n=T.subtract(A.q(f,e),p),c=n[0]*n[0]+n[1]*n[1],c>u&&(u=c,i=t);return[u,i]}var S=function(g,f){for(var r,c=[0],u=g[0],i=0,n=1;n<=f;n++)r=A.q(g,n/f),i+=T.vectorLen(T.subtract(r,u)),c.push(i),u=r;return c=c.map(t=>t/i),c};function P(g,f,r,c){if(f<0)return 0;if(f>1)return 1;for(var u,i,n,t,s,p=1;p<=c;p++)if(f<=r[p]){t=(p-1)/c,n=p/c,i=r[p-1],u=r[p],s=(f-i)/(u-i)*(n-t)+t;break}return s}function L(g,f){return T.normalize(T.subtract(g,f))}class T{static zeros_Xx2x2(f){for(var r=[];f--;)r.push([0,0]);return r}static mulItems(f,r){return f.map(c=>c*r)}static mulMatrix(f,r){return f.reduce((c,u,i)=>c+u*r[i],0)}static subtract(f,r){return f.map((c,u)=>c-r[u])}static addArrays(f,r){return f.map((c,u)=>c+r[u])}static addItems(f,r){return f.map(c=>c+r)}static sum(f){return f.reduce((r,c)=>r+c)}static dot(f,r){return T.mulMatrix(f,r)}static vectorLen(f){return Math.hypot(...f)}static divItems(f,r){return f.map(c=>c/r)}static squareItems(f){return f.map(r=>r*r)}static normalize(f){return this.divItems(f,this.vectorLen(f))}}class A{static q(f,r){var c=1-r,u=T.mulItems(f[0],c*c*c),i=T.mulItems(f[1],3*c*c*r),n=T.mulItems(f[2],3*c*r*r),t=T.mulItems(f[3],r*r*r);return T.addArrays(T.addArrays(u,i),T.addArrays(n,t))}static qprime(f,r){var c=1-r,u=T.mulItems(T.subtract(f[1],f[0]),3*c*c),i=T.mulItems(T.subtract(f[2],f[1]),6*c*r),n=T.mulItems(T.subtract(f[3],f[2]),3*r*r);return T.addArrays(T.addArrays(u,i),n)}static qprimeprime(f,r){return T.addArrays(T.mulItems(T.addArrays(T.subtract(f[2],T.mulItems(f[1],2)),f[0]),6*(1-r)),T.mulItems(T.addArrays(T.subtract(f[3],T.mulItems(f[2],2)),f[1]),6*r))}}ot.exports=m,ot.exports.fitCubic=Q,ot.exports.createTangent=L},(ot,m,Q)=>{var o,Ot,We,k,be,_e;Object.defineProperty(m,"__esModule",{value:!0}),m.AnnotationLayer=void 0;var b=Q(1),w=Q(6),Y=Q(3),z=Q(33),et=Q(34);const B=1e3,S=9,P=new WeakSet;function L($){return{width:$[2]-$[0],height:$[3]-$[1]}}class T{static create(a){switch(a.data.annotationType){case b.AnnotationType.LINK:return new g(a);case b.AnnotationType.TEXT:return new f(a);case b.AnnotationType.WIDGET:switch(a.data.fieldType){case"Tx":return new c(a);case"Btn":return a.data.radioButton?new i(a):a.data.checkBox?new u(a):new n(a);case"Ch":return new t(a)}return new r(a);case b.AnnotationType.POPUP:return new s(a);case b.AnnotationType.FREETEXT:return new e(a);case b.AnnotationType.LINE:return new y(a);case b.AnnotationType.SQUARE:return new O(a);case b.AnnotationType.CIRCLE:return new W(a);case b.AnnotationType.POLYLINE:return new tt(a);case b.AnnotationType.CARET:return new rt(a);case b.AnnotationType.INK:return new ct(a);case b.AnnotationType.POLYGON:return new gt(a);case b.AnnotationType.HIGHLIGHT:return new K(a);case b.AnnotationType.UNDERLINE:return new H(a);case b.AnnotationType.SQUIGGLY:return new G(a);case b.AnnotationType.STRIKEOUT:return new st(a);case b.AnnotationType.STAMP:return new ht(a);case b.AnnotationType.FILEATTACHMENT:return new M(a);default:return new A(a)}}}class A{constructor(a,{isRenderable:l=!1,ignoreBorder:E=!1,createQuadrilaterals:C=!1}={}){this.isRenderable=l,this.data=a.data,this.layer=a.layer,this.page=a.page,this.viewport=a.viewport,this.linkService=a.linkService,this.downloadManager=a.downloadManager,this.imageResourcesPath=a.imageResourcesPath,this.renderForms=a.renderForms,this.svgFactory=a.svgFactory,this.annotationStorage=a.annotationStorage,this.enableScripting=a.enableScripting,this.hasJSActions=a.hasJSActions,this._fieldObjects=a.fieldObjects,l&&(this.container=this._createContainer(E)),C&&(this.quadrilaterals=this._createQuadrilaterals(E))}_createContainer(a=!1){const{data:l,page:E,viewport:C}=this,d=document.createElement("section");d.setAttribute("data-annotation-id",l.id);const{pageWidth:F,pageHeight:N,pageX:j,pageY:Z}=C.rawDims,{width:x,height:U}=L(l.rect),I=b.Util.normalizeRect([l.rect[0],E.view[3]-l.rect[1]+E.view[1],l.rect[2],E.view[3]-l.rect[3]+E.view[1]]);if(!a&&l.borderStyle.width>0){d.style.borderWidth=`${l.borderStyle.width}px`;const dt=l.borderStyle.horizontalCornerRadius,ft=l.borderStyle.verticalCornerRadius;if(dt>0||ft>0){const _t=`calc(${dt}px * var(--scale-factor)) / calc(${ft}px * var(--scale-factor))`;d.style.borderRadius=_t}else if(this instanceof i){const _t=`calc(${x}px * var(--scale-factor)) / calc(${U}px * var(--scale-factor))`;d.style.borderRadius=_t}switch(l.borderStyle.style){case b.AnnotationBorderStyleType.SOLID:d.style.borderStyle="solid";break;case b.AnnotationBorderStyleType.DASHED:d.style.borderStyle="dashed";break;case b.AnnotationBorderStyleType.BEVELED:(0,b.warn)("Unimplemented border style: beveled");break;case b.AnnotationBorderStyleType.INSET:(0,b.warn)("Unimplemented border style: inset");break;case b.AnnotationBorderStyleType.UNDERLINE:d.style.borderBottomStyle="solid";break}const bt=l.borderColor||null;bt?d.style.borderColor=b.Util.makeHexColor(bt[0]|0,bt[1]|0,bt[2]|0):d.style.borderWidth=0}d.style.left=`${100*(I[0]-j)/F}%`,d.style.top=`${100*(I[1]-Z)/N}%`;const{rotation:it}=l;return l.hasOwnCanvas||it===0?(d.style.width=`${100*x/F}%`,d.style.height=`${100*U/N}%`):this.setRotation(it,d),d}setRotation(a,l=this.container){const{pageWidth:E,pageHeight:C}=this.viewport.rawDims,{width:d,height:F}=L(this.data.rect);let N,j;a%180===0?(N=100*d/E,j=100*F/C):(N=100*F/E,j=100*d/C),l.style.width=`${N}%`,l.style.height=`${j}%`,l.setAttribute("data-main-rotation",(360-a)%360)}get _commonActions(){const a=(l,E,C)=>{const d=C.detail[l];C.target.style[E]=z.ColorConverters[`${d[0]}_HTML`](d.slice(1))};return(0,b.shadow)(this,"_commonActions",{display:l=>{const E=l.detail.display%2===1;this.container.style.visibility=E?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:E,print:l.detail.display===0||l.detail.display===3})},print:l=>{this.annotationStorage.setValue(this.data.id,{print:l.detail.print})},hidden:l=>{this.container.style.visibility=l.detail.hidden?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:l.detail.hidden})},focus:l=>{setTimeout(()=>l.target.focus({preventScroll:!1}),0)},userName:l=>{l.target.title=l.detail.userName},readonly:l=>{l.detail.readonly?l.target.setAttribute("readonly",""):l.target.removeAttribute("readonly")},required:l=>{this._setRequired(l.target,l.detail.required)},bgColor:l=>{a("bgColor","backgroundColor",l)},fillColor:l=>{a("fillColor","backgroundColor",l)},fgColor:l=>{a("fgColor","color",l)},textColor:l=>{a("textColor","color",l)},borderColor:l=>{a("borderColor","borderColor",l)},strokeColor:l=>{a("strokeColor","borderColor",l)},rotation:l=>{const E=l.detail.rotation;this.setRotation(E),this.annotationStorage.setValue(this.data.id,{rotation:E})}})}_dispatchEventFromSandbox(a,l){const E=this._commonActions;for(const C of Object.keys(l.detail)){const d=a[C]||E[C];d==null||d(l)}}_setDefaultPropertiesFromJS(a){if(!this.enableScripting)return;const l=this.annotationStorage.getRawValue(this.data.id);if(!l)return;const E=this._commonActions;for(const[C,d]of Object.entries(l)){const F=E[C];if(F){const N={detail:{[C]:d},target:a};F(N),delete l[C]}}}_createQuadrilaterals(a=!1){if(!this.data.quadPoints)return null;const l=[],E=this.data.rect;for(const C of this.data.quadPoints)this.data.rect=[C[2].x,C[2].y,C[1].x,C[1].y],l.push(this._createContainer(a));return this.data.rect=E,l}_createPopup(a,l){let E=this.container;this.quadrilaterals&&(a=a||this.quadrilaterals,E=this.quadrilaterals[0]),a||(a=document.createElement("div"),a.className="popupTriggerArea",E.append(a));const d=new p({container:E,trigger:a,color:l.color,titleObj:l.titleObj,modificationDate:l.modificationDate,contentsObj:l.contentsObj,richText:l.richText,hideWrapper:!0}).render();d.style.left="100%",E.append(d)}_renderQuadrilaterals(a){for(const l of this.quadrilaterals)l.className=a;return this.quadrilaterals}render(){(0,b.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(a,l=null){const E=[];if(this._fieldObjects){const C=this._fieldObjects[a];if(C)for(const{page:d,id:F,exportValues:N}of C){if(d===-1||F===l)continue;const j=typeof N=="string"?N:null,Z=document.querySelector(`[data-element-id="${F}"]`);if(Z&&!P.has(Z)){(0,b.warn)(`_getElementsByName - element not allowed: ${F}`);continue}E.push({id:F,exportValue:j,domElement:Z})}return E}for(const C of document.getElementsByName(a)){const{exportValue:d}=C,F=C.getAttribute("data-element-id");F!==l&&P.has(C)&&E.push({id:F,exportValue:d,domElement:C})}return E}}class g extends A{constructor(l,E=null){super(l,{isRenderable:!0,ignoreBorder:!!(E!=null&&E.ignoreBorder),createQuadrilaterals:!0});ut(this,o);this.isTooltipOnly=l.data.isTooltipOnly}render(){const{data:l,linkService:E}=this,C=document.createElement("a");C.setAttribute("data-element-id",l.id);let d=!1;return l.url?(E.addLinkAttributes(C,l.url,l.newWindow),d=!0):l.action?(this._bindNamedAction(C,l.action),d=!0):l.attachment?(this._bindAttachment(C,l.attachment),d=!0):l.setOCGState?(lt(this,o,We).call(this,C,l.setOCGState),d=!0):l.dest?(this._bindLink(C,l.dest),d=!0):(l.actions&&(l.actions.Action||l.actions["Mouse Up"]||l.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(C,l),d=!0),l.resetForm?(this._bindResetFormAction(C,l.resetForm),d=!0):this.isTooltipOnly&&!d&&(this._bindLink(C,""),d=!0)),this.quadrilaterals?this._renderQuadrilaterals("linkAnnotation").map((F,N)=>{const j=N===0?C:C.cloneNode();return F.append(j),F}):(this.container.className="linkAnnotation",d&&this.container.append(C),this.container)}_bindLink(l,E){l.href=this.linkService.getDestinationHash(E),l.onclick=()=>(E&&this.linkService.goToDestination(E),!1),(E||E==="")&&lt(this,o,Ot).call(this)}_bindNamedAction(l,E){l.href=this.linkService.getAnchorUrl(""),l.onclick=()=>(this.linkService.executeNamedAction(E),!1),lt(this,o,Ot).call(this)}_bindAttachment(l,E){l.href=this.linkService.getAnchorUrl(""),l.onclick=()=>{var C;return(C=this.downloadManager)==null||C.openOrDownloadData(this.container,E.content,E.filename),!1},lt(this,o,Ot).call(this)}_bindJSAction(l,E){l.href=this.linkService.getAnchorUrl("");const C=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const d of Object.keys(E.actions)){const F=C.get(d);F&&(l[F]=()=>{var N;return(N=this.linkService.eventBus)==null||N.dispatch("dispatcheventinsandbox",{source:this,detail:{id:E.id,name:d}}),!1})}l.onclick||(l.onclick=()=>!1),lt(this,o,Ot).call(this)}_bindResetFormAction(l,E){const C=l.onclick;if(C||(l.href=this.linkService.getAnchorUrl("")),lt(this,o,Ot).call(this),!this._fieldObjects){(0,b.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),C||(l.onclick=()=>!1);return}l.onclick=()=>{var U;C==null||C();const{fields:d,refs:F,include:N}=E,j=[];if(d.length!==0||F.length!==0){const I=new Set(F);for(const it of d){const dt=this._fieldObjects[it]||[];for(const{id:ft}of dt)I.add(ft)}for(const it of Object.values(this._fieldObjects))for(const dt of it)I.has(dt.id)===N&&j.push(dt)}else for(const I of Object.values(this._fieldObjects))j.push(...I);const Z=this.annotationStorage,x=[];for(const I of j){const{id:it}=I;switch(x.push(it),I.type){case"text":{const ft=I.defaultValue||"";Z.setValue(it,{value:ft});break}case"checkbox":case"radiobutton":{const ft=I.defaultValue===I.exportValues;Z.setValue(it,{value:ft});break}case"combobox":case"listbox":{const ft=I.defaultValue||"";Z.setValue(it,{value:ft});break}default:continue}const dt=document.querySelector(`[data-element-id="${it}"]`);if(dt){if(!P.has(dt)){(0,b.warn)(`_bindResetFormAction - element not allowed: ${it}`);continue}}else continue;dt.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((U=this.linkService.eventBus)==null||U.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:x,name:"ResetForm"}})),!1}}}o=new WeakSet,Ot=function(){this.container.setAttribute("data-internal-link","")},We=function(l,E){l.href=this.linkService.getAnchorUrl(""),l.onclick=()=>(this.linkService.executeSetOCGState(E),!1),lt(this,o,Ot).call(this)};class f extends A{constructor(a){var E,C,d;const l=!!(a.data.hasPopup||(E=a.data.titleObj)!=null&&E.str||(C=a.data.contentsObj)!=null&&C.str||(d=a.data.richText)!=null&&d.str);super(a,{isRenderable:l})}render(){this.container.className="textAnnotation";const a=document.createElement("img");return a.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",a.alt="[{{type}} Annotation]",a.dataset.l10nId="text_annotation_type",a.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(a,this.data),this.container.append(a),this.container}}class r extends A{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}_getKeyModifier(a){const{isWin:l,isMac:E}=b.FeatureTest.platform;return l&&a.ctrlKey||E&&a.metaKey}_setEventListener(a,l,E,C){l.includes("mouse")?a.addEventListener(l,d=>{var F;(F=this.linkService.eventBus)==null||F.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:E,value:C(d),shift:d.shiftKey,modifier:this._getKeyModifier(d)}})}):a.addEventListener(l,d=>{var F;(F=this.linkService.eventBus)==null||F.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:E,value:C(d)}})})}_setEventListeners(a,l,E){var C;for(const[d,F]of l)(F==="Action"||(C=this.data.actions)!=null&&C[F])&&this._setEventListener(a,d,F,E)}_setBackgroundColor(a){const l=this.data.backgroundColor||null;a.style.backgroundColor=l===null?"transparent":b.Util.makeHexColor(l[0],l[1],l[2])}_setTextStyle(a){const l=["left","center","right"],{fontColor:E}=this.data.defaultAppearanceData,C=this.data.defaultAppearanceData.fontSize||S,d=a.style;let F;const N=2,j=Z=>Math.round(10*Z)/10;if(this.data.multiLine){const Z=Math.abs(this.data.rect[3]-this.data.rect[1]-N),x=Math.round(Z/(b.LINE_FACTOR*C))||1,U=Z/x;F=Math.min(C,j(U/b.LINE_FACTOR))}else{const Z=Math.abs(this.data.rect[3]-this.data.rect[1]-N);F=Math.min(C,j(Z/b.LINE_FACTOR))}d.fontSize=`calc(${F}px * var(--scale-factor))`,d.color=b.Util.makeHexColor(E[0],E[1],E[2]),this.data.textAlignment!==null&&(d.textAlign=l[this.data.textAlignment])}_setRequired(a,l){l?a.setAttribute("required",!0):a.removeAttribute("required"),a.setAttribute("aria-required",l)}}class c extends r{constructor(a){const l=a.renderForms||!a.data.hasAppearance&&!!a.data.fieldValue;super(a,{isRenderable:l})}setPropertyOnSiblings(a,l,E,C){const d=this.annotationStorage;for(const F of this._getElementsByName(a.name,a.id))F.domElement&&(F.domElement[l]=E),d.setValue(F.id,{[C]:E})}render(){var C;const a=this.annotationStorage,l=this.data.id;this.container.className="textWidgetAnnotation";let E=null;if(this.renderForms){const d=a.getValue(l,{value:this.data.fieldValue});let F=d.formattedValue||d.value||"";const N=a.getValue(l,{charLimit:this.data.maxLen}).charLimit;N&&F.length>N&&(F=F.slice(0,N));const j={userValue:F,formattedValue:null,lastCommittedValue:null,commitKey:1};this.data.multiLine?(E=document.createElement("textarea"),E.textContent=F,this.data.doNotScroll&&(E.style.overflowY="hidden")):(E=document.createElement("input"),E.type="text",E.setAttribute("value",F),this.data.doNotScroll&&(E.style.overflowX="hidden")),P.add(E),E.setAttribute("data-element-id",l),E.disabled=this.data.readOnly,E.name=this.data.fieldName,E.tabIndex=B,this._setRequired(E,this.data.required),N&&(E.maxLength=N),E.addEventListener("input",x=>{a.setValue(l,{value:x.target.value}),this.setPropertyOnSiblings(E,"value",x.target.value,"value")}),E.addEventListener("resetform",x=>{const U=this.data.defaultFieldValue??"";E.value=j.userValue=U,j.formattedValue=null});let Z=x=>{const{formattedValue:U}=j;U!=null&&(x.target.value=U),x.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){E.addEventListener("focus",U=>{const{target:I}=U;j.userValue&&(I.value=j.userValue),j.lastCommittedValue=I.value,j.commitKey=1}),E.addEventListener("updatefromsandbox",U=>{const I={value(it){j.userValue=it.detail.value??"",a.setValue(l,{value:j.userValue.toString()}),it.target.value=j.userValue},formattedValue(it){const{formattedValue:dt}=it.detail;j.formattedValue=dt,dt!=null&&it.target!==document.activeElement&&(it.target.value=dt),a.setValue(l,{formattedValue:dt})},selRange(it){it.target.setSelectionRange(...it.detail.selRange)},charLimit:it=>{var _t;const{charLimit:dt}=it.detail,{target:ft}=it;if(dt===0){ft.removeAttribute("maxLength");return}ft.setAttribute("maxLength",dt);let bt=j.userValue;!bt||bt.length<=dt||(bt=bt.slice(0,dt),ft.value=j.userValue=bt,a.setValue(l,{value:bt}),(_t=this.linkService.eventBus)==null||_t.dispatch("dispatcheventinsandbox",{source:this,detail:{id:l,name:"Keystroke",value:bt,willCommit:!0,commitKey:1,selStart:ft.selectionStart,selEnd:ft.selectionEnd}}))}};this._dispatchEventFromSandbox(I,U)}),E.addEventListener("keydown",U=>{var dt;j.commitKey=1;let I=-1;if(U.key==="Escape"?I=0:U.key==="Enter"&&!this.data.multiLine?I=2:U.key==="Tab"&&(j.commitKey=3),I===-1)return;const{value:it}=U.target;j.lastCommittedValue!==it&&(j.lastCommittedValue=it,j.userValue=it,(dt=this.linkService.eventBus)==null||dt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:l,name:"Keystroke",value:it,willCommit:!0,commitKey:I,selStart:U.target.selectionStart,selEnd:U.target.selectionEnd}}))});const x=Z;Z=null,E.addEventListener("blur",U=>{var it;if(!U.relatedTarget)return;const{value:I}=U.target;j.userValue=I,j.lastCommittedValue!==I&&((it=this.linkService.eventBus)==null||it.dispatch("dispatcheventinsandbox",{source:this,detail:{id:l,name:"Keystroke",value:I,willCommit:!0,commitKey:j.commitKey,selStart:U.target.selectionStart,selEnd:U.target.selectionEnd}})),x(U)}),(C=this.data.actions)!=null&&C.Keystroke&&E.addEventListener("beforeinput",U=>{var vt;j.lastCommittedValue=null;const{data:I,target:it}=U,{value:dt,selectionStart:ft,selectionEnd:bt}=it;let _t=ft,yt=bt;switch(U.inputType){case"deleteWordBackward":{const at=dt.substring(0,ft).match(/\w*[^\w]*$/);at&&(_t-=at[0].length);break}case"deleteWordForward":{const at=dt.substring(ft).match(/^[^\w]*\w*/);at&&(yt+=at[0].length);break}case"deleteContentBackward":ft===bt&&(_t-=1);break;case"deleteContentForward":ft===bt&&(yt+=1);break}U.preventDefault(),(vt=this.linkService.eventBus)==null||vt.dispatch("dispatcheventinsandbox",{source:this,detail:{id:l,name:"Keystroke",value:dt,change:I||"",willCommit:!1,selStart:_t,selEnd:yt}})}),this._setEventListeners(E,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],U=>U.target.value)}if(Z&&E.addEventListener("blur",Z),this.data.comb){const U=(this.data.rect[2]-this.data.rect[0])/N;E.classList.add("comb"),E.style.letterSpacing=`calc(${U}px * var(--scale-factor) - 1ch)`}}else E=document.createElement("div"),E.textContent=this.data.fieldValue,E.style.verticalAlign="middle",E.style.display="table-cell";return this._setTextStyle(E),this._setBackgroundColor(E),this._setDefaultPropertiesFromJS(E),this.container.append(E),this.container}}class u extends r{constructor(a){super(a,{isRenderable:a.renderForms})}render(){const a=this.annotationStorage,l=this.data,E=l.id;let C=a.getValue(E,{value:l.exportValue===l.fieldValue}).value;typeof C=="string"&&(C=C!=="Off",a.setValue(E,{value:C})),this.container.className="buttonWidgetAnnotation checkBox";const d=document.createElement("input");return P.add(d),d.setAttribute("data-element-id",E),d.disabled=l.readOnly,this._setRequired(d,this.data.required),d.type="checkbox",d.name=l.fieldName,C&&d.setAttribute("checked",!0),d.setAttribute("exportValue",l.exportValue),d.tabIndex=B,d.addEventListener("change",F=>{const{name:N,checked:j}=F.target;for(const Z of this._getElementsByName(N,E)){const x=j&&Z.exportValue===l.exportValue;Z.domElement&&(Z.domElement.checked=x),a.setValue(Z.id,{value:x})}a.setValue(E,{value:j})}),d.addEventListener("resetform",F=>{const N=l.defaultFieldValue||"Off";F.target.checked=N===l.exportValue}),this.enableScripting&&this.hasJSActions&&(d.addEventListener("updatefromsandbox",F=>{const N={value(j){j.target.checked=j.detail.value!=="Off",a.setValue(E,{value:j.target.checked})}};this._dispatchEventFromSandbox(N,F)}),this._setEventListeners(d,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],F=>F.target.checked)),this._setBackgroundColor(d),this._setDefaultPropertiesFromJS(d),this.container.append(d),this.container}}class i extends r{constructor(a){super(a,{isRenderable:a.renderForms})}render(){this.container.className="buttonWidgetAnnotation radioButton";const a=this.annotationStorage,l=this.data,E=l.id;let C=a.getValue(E,{value:l.fieldValue===l.buttonValue}).value;typeof C=="string"&&(C=C!==l.buttonValue,a.setValue(E,{value:C}));const d=document.createElement("input");if(P.add(d),d.setAttribute("data-element-id",E),d.disabled=l.readOnly,this._setRequired(d,this.data.required),d.type="radio",d.name=l.fieldName,C&&d.setAttribute("checked",!0),d.tabIndex=B,d.addEventListener("change",F=>{const{name:N,checked:j}=F.target;for(const Z of this._getElementsByName(N,E))a.setValue(Z.id,{value:!1});a.setValue(E,{value:j})}),d.addEventListener("resetform",F=>{const N=l.defaultFieldValue;F.target.checked=N!=null&&N===l.buttonValue}),this.enableScripting&&this.hasJSActions){const F=l.buttonValue;d.addEventListener("updatefromsandbox",N=>{const j={value:Z=>{const x=F===Z.detail.value;for(const U of this._getElementsByName(Z.target.name)){const I=x&&U.id===E;U.domElement&&(U.domElement.checked=I),a.setValue(U.id,{value:I})}}};this._dispatchEventFromSandbox(j,N)}),this._setEventListeners(d,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],N=>N.target.checked)}return this._setBackgroundColor(d),this._setDefaultPropertiesFromJS(d),this.container.append(d),this.container}}class n extends g{constructor(a){super(a,{ignoreBorder:a.data.hasAppearance})}render(){const a=super.render();a.className="buttonWidgetAnnotation pushButton",this.data.alternativeText&&(a.title=this.data.alternativeText);const l=a.lastChild;return this.enableScripting&&this.hasJSActions&&l&&(this._setDefaultPropertiesFromJS(l),l.addEventListener("updatefromsandbox",E=>{this._dispatchEventFromSandbox({},E)})),a}}class t extends r{constructor(a){super(a,{isRenderable:a.renderForms})}render(){this.container.className="choiceWidgetAnnotation";const a=this.annotationStorage,l=this.data.id,E=a.getValue(l,{value:this.data.fieldValue}),C=document.createElement("select");P.add(C),C.setAttribute("data-element-id",l),C.disabled=this.data.readOnly,this._setRequired(C,this.data.required),C.name=this.data.fieldName,C.tabIndex=B;let d=this.data.combo&&this.data.options.length>0;this.data.combo||(C.size=this.data.options.length,this.data.multiSelect&&(C.multiple=!0)),C.addEventListener("resetform",x=>{const U=this.data.defaultFieldValue;for(const I of C.options)I.selected=I.value===U});for(const x of this.data.options){const U=document.createElement("option");U.textContent=x.displayValue,U.value=x.exportValue,E.value.includes(x.exportValue)&&(U.setAttribute("selected",!0),d=!1),C.append(U)}let F=null;if(d){const x=document.createElement("option");x.value=" ",x.setAttribute("hidden",!0),x.setAttribute("selected",!0),C.prepend(x),F=()=>{x.remove(),C.removeEventListener("input",F),F=null},C.addEventListener("input",F)}const N=x=>{const U=x?"value":"textContent",{options:I,multiple:it}=C;return it?Array.prototype.filter.call(I,dt=>dt.selected).map(dt=>dt[U]):I.selectedIndex===-1?null:I[I.selectedIndex][U]};let j=N(!1);const Z=x=>{const U=x.target.options;return Array.prototype.map.call(U,I=>({displayValue:I.textContent,exportValue:I.value}))};return this.enableScripting&&this.hasJSActions?(C.addEventListener("updatefromsandbox",x=>{const U={value(I){F==null||F();const it=I.detail.value,dt=new Set(Array.isArray(it)?it:[it]);for(const ft of C.options)ft.selected=dt.has(ft.value);a.setValue(l,{value:N(!0)}),j=N(!1)},multipleSelection(I){C.multiple=!0},remove(I){const it=C.options,dt=I.detail.remove;it[dt].selected=!1,C.remove(dt),it.length>0&&Array.prototype.findIndex.call(it,bt=>bt.selected)===-1&&(it[0].selected=!0),a.setValue(l,{value:N(!0),items:Z(I)}),j=N(!1)},clear(I){for(;C.length!==0;)C.remove(0);a.setValue(l,{value:null,items:[]}),j=N(!1)},insert(I){const{index:it,displayValue:dt,exportValue:ft}=I.detail.insert,bt=C.children[it],_t=document.createElement("option");_t.textContent=dt,_t.value=ft,bt?bt.before(_t):C.append(_t),a.setValue(l,{value:N(!0),items:Z(I)}),j=N(!1)},items(I){const{items:it}=I.detail;for(;C.length!==0;)C.remove(0);for(const dt of it){const{displayValue:ft,exportValue:bt}=dt,_t=document.createElement("option");_t.textContent=ft,_t.value=bt,C.append(_t)}C.options.length>0&&(C.options[0].selected=!0),a.setValue(l,{value:N(!0),items:Z(I)}),j=N(!1)},indices(I){const it=new Set(I.detail.indices);for(const dt of I.target.options)dt.selected=it.has(dt.index);a.setValue(l,{value:N(!0)}),j=N(!1)},editable(I){I.target.disabled=!I.detail.editable}};this._dispatchEventFromSandbox(U,x)}),C.addEventListener("input",x=>{var I;const U=N(!0);a.setValue(l,{value:U}),x.preventDefault(),(I=this.linkService.eventBus)==null||I.dispatch("dispatcheventinsandbox",{source:this,detail:{id:l,name:"Keystroke",value:j,changeEx:U,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(C,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],x=>x.target.value)):C.addEventListener("input",function(x){a.setValue(l,{value:N(!0)})}),this.data.combo&&this._setTextStyle(C),this._setBackgroundColor(C),this._setDefaultPropertiesFromJS(C),this.container.append(C),this.container}}const D=class D extends A{constructor(a){var C,d,F;const{data:l}=a,E=!D.IGNORE_TYPES.has(l.parentType)&&!!((C=l.titleObj)!=null&&C.str||(d=l.contentsObj)!=null&&d.str||(F=l.richText)!=null&&F.str);super(a,{isRenderable:E})}render(){this.container.className="popupAnnotation";const a=this.layer.querySelectorAll(`[data-annotation-id="${this.data.parentId}"]`);if(a.length===0)return this.container;const l=new p({container:this.container,trigger:Array.from(a),color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText}),E=this.page,C=b.Util.normalizeRect([this.data.parentRect[0],E.view[3]-this.data.parentRect[1]+E.view[1],this.data.parentRect[2],E.view[3]-this.data.parentRect[3]+E.view[1]]),d=C[0]+this.data.parentRect[2]-this.data.parentRect[0],F=C[1],{pageWidth:N,pageHeight:j,pageX:Z,pageY:x}=this.viewport.rawDims;return this.container.style.left=`${100*(d-Z)/N}%`,this.container.style.top=`${100*(F-x)/j}%`,this.container.append(l.render()),this.container}};St(D,"IGNORE_TYPES",new Set(["Line","Square","Circle","PolyLine","Polygon","Ink"]));let s=D;class p{constructor(a){this.container=a.container,this.trigger=a.trigger,this.color=a.color,this.titleObj=a.titleObj,this.modificationDate=a.modificationDate,this.contentsObj=a.contentsObj,this.richText=a.richText,this.hideWrapper=a.hideWrapper||!1,this.pinned=!1}render(){var N,j;const l=document.createElement("div");l.className="popupWrapper",this.hideElement=this.hideWrapper?l:this.container,this.hideElement.hidden=!0;const E=document.createElement("div");E.className="popup";const C=this.color;if(C){const Z=.7*(255-C[0])+C[0],x=.7*(255-C[1])+C[1],U=.7*(255-C[2])+C[2];E.style.backgroundColor=b.Util.makeHexColor(Z|0,x|0,U|0)}const d=document.createElement("h1");d.dir=this.titleObj.dir,d.textContent=this.titleObj.str,E.append(d);const F=w.PDFDateString.toDateObject(this.modificationDate);if(F){const Z=document.createElement("span");Z.className="popupDate",Z.textContent="{{date}}, {{time}}",Z.dataset.l10nId="annotation_date_string",Z.dataset.l10nArgs=JSON.stringify({date:F.toLocaleDateString(),time:F.toLocaleTimeString()}),E.append(Z)}if((N=this.richText)!=null&&N.str&&(!((j=this.contentsObj)!=null&&j.str)||this.contentsObj.str===this.richText.str))et.XfaLayer.render({xfaHtml:this.richText.html,intent:"richText",div:E}),E.lastChild.className="richText popupContent";else{const Z=this._formatContents(this.contentsObj);E.append(Z)}Array.isArray(this.trigger)||(this.trigger=[this.trigger]);for(const Z of this.trigger)Z.addEventListener("click",this._toggle.bind(this)),Z.addEventListener("mouseover",this._show.bind(this,!1)),Z.addEventListener("mouseout",this._hide.bind(this,!1));return E.addEventListener("click",this._hide.bind(this,!0)),l.append(E),l}_formatContents({str:a,dir:l}){const E=document.createElement("p");E.className="popupContent",E.dir=l;const C=a.split(/(?:\r\n?|\n)/);for(let d=0,F=C.length;d<F;++d){const N=C[d];E.append(document.createTextNode(N)),d<F-1&&E.append(document.createElement("br"))}return E}_toggle(){this.pinned?this._hide(!0):this._show(!0)}_show(a=!1){a&&(this.pinned=!0),this.hideElement.hidden&&(this.hideElement.hidden=!1,this.container.style.zIndex=parseInt(this.container.style.zIndex)+1e3)}_hide(a=!0){a&&(this.pinned=!1),!this.hideElement.hidden&&!this.pinned&&(this.hideElement.hidden=!0,this.container.style.zIndex=parseInt(this.container.style.zIndex)-1e3)}}class e extends A{constructor(a){var E,C,d;const l=!!(a.data.hasPopup||(E=a.data.titleObj)!=null&&E.str||(C=a.data.contentsObj)!=null&&C.str||(d=a.data.richText)!=null&&d.str);super(a,{isRenderable:l,ignoreBorder:!0}),this.textContent=a.data.textContent}render(){if(this.container.className="freeTextAnnotation",this.textContent){const a=document.createElement("div");a.className="annotationTextContent",a.setAttribute("role","comment");for(const l of this.textContent){const E=document.createElement("span");E.textContent=l,a.append(E)}this.container.append(a)}return this.data.hasPopup||this._createPopup(null,this.data),this.container}}class y extends A{constructor(a){var E,C,d;const l=!!(a.data.hasPopup||(E=a.data.titleObj)!=null&&E.str||(C=a.data.contentsObj)!=null&&C.str||(d=a.data.richText)!=null&&d.str);super(a,{isRenderable:l,ignoreBorder:!0})}render(){this.container.className="lineAnnotation";const a=this.data,{width:l,height:E}=L(a.rect),C=this.svgFactory.create(l,E,!0),d=this.svgFactory.createElement("svg:line");return d.setAttribute("x1",a.rect[2]-a.lineCoordinates[0]),d.setAttribute("y1",a.rect[3]-a.lineCoordinates[1]),d.setAttribute("x2",a.rect[2]-a.lineCoordinates[2]),d.setAttribute("y2",a.rect[3]-a.lineCoordinates[3]),d.setAttribute("stroke-width",a.borderStyle.width||1),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),C.append(d),this.container.append(C),this._createPopup(d,a),this.container}}class O extends A{constructor(a){var E,C,d;const l=!!(a.data.hasPopup||(E=a.data.titleObj)!=null&&E.str||(C=a.data.contentsObj)!=null&&C.str||(d=a.data.richText)!=null&&d.str);super(a,{isRenderable:l,ignoreBorder:!0})}render(){this.container.className="squareAnnotation";const a=this.data,{width:l,height:E}=L(a.rect),C=this.svgFactory.create(l,E,!0),d=a.borderStyle.width,F=this.svgFactory.createElement("svg:rect");return F.setAttribute("x",d/2),F.setAttribute("y",d/2),F.setAttribute("width",l-d),F.setAttribute("height",E-d),F.setAttribute("stroke-width",d||1),F.setAttribute("stroke","transparent"),F.setAttribute("fill","transparent"),C.append(F),this.container.append(C),this._createPopup(F,a),this.container}}class W extends A{constructor(a){var E,C,d;const l=!!(a.data.hasPopup||(E=a.data.titleObj)!=null&&E.str||(C=a.data.contentsObj)!=null&&C.str||(d=a.data.richText)!=null&&d.str);super(a,{isRenderable:l,ignoreBorder:!0})}render(){this.container.className="circleAnnotation";const a=this.data,{width:l,height:E}=L(a.rect),C=this.svgFactory.create(l,E,!0),d=a.borderStyle.width,F=this.svgFactory.createElement("svg:ellipse");return F.setAttribute("cx",l/2),F.setAttribute("cy",E/2),F.setAttribute("rx",l/2-d/2),F.setAttribute("ry",E/2-d/2),F.setAttribute("stroke-width",d||1),F.setAttribute("stroke","transparent"),F.setAttribute("fill","transparent"),C.append(F),this.container.append(C),this._createPopup(F,a),this.container}}class tt extends A{constructor(a){var E,C,d;const l=!!(a.data.hasPopup||(E=a.data.titleObj)!=null&&E.str||(C=a.data.contentsObj)!=null&&C.str||(d=a.data.richText)!=null&&d.str);super(a,{isRenderable:l,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const a=this.data,{width:l,height:E}=L(a.rect),C=this.svgFactory.create(l,E,!0);let d=[];for(const N of a.vertices){const j=N.x-a.rect[0],Z=a.rect[3]-N.y;d.push(j+","+Z)}d=d.join(" ");const F=this.svgFactory.createElement(this.svgElementName);return F.setAttribute("points",d),F.setAttribute("stroke-width",a.borderStyle.width||1),F.setAttribute("stroke","transparent"),F.setAttribute("fill","transparent"),C.append(F),this.container.append(C),this._createPopup(F,a),this.container}}class gt extends tt{constructor(a){super(a),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class rt extends A{constructor(a){var E,C,d;const l=!!(a.data.hasPopup||(E=a.data.titleObj)!=null&&E.str||(C=a.data.contentsObj)!=null&&C.str||(d=a.data.richText)!=null&&d.str);super(a,{isRenderable:l,ignoreBorder:!0})}render(){return this.container.className="caretAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class ct extends A{constructor(a){var E,C,d;const l=!!(a.data.hasPopup||(E=a.data.titleObj)!=null&&E.str||(C=a.data.contentsObj)!=null&&C.str||(d=a.data.richText)!=null&&d.str);super(a,{isRenderable:l,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const a=this.data,{width:l,height:E}=L(a.rect),C=this.svgFactory.create(l,E,!0);for(const d of a.inkLists){let F=[];for(const j of d){const Z=j.x-a.rect[0],x=a.rect[3]-j.y;F.push(`${Z},${x}`)}F=F.join(" ");const N=this.svgFactory.createElement(this.svgElementName);N.setAttribute("points",F),N.setAttribute("stroke-width",a.borderStyle.width||1),N.setAttribute("stroke","transparent"),N.setAttribute("fill","transparent"),this._createPopup(N,a),C.append(N)}return this.container.append(C),this.container}}class K extends A{constructor(a){var E,C,d;const l=!!(a.data.hasPopup||(E=a.data.titleObj)!=null&&E.str||(C=a.data.contentsObj)!=null&&C.str||(d=a.data.richText)!=null&&d.str);super(a,{isRenderable:l,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("highlightAnnotation"):(this.container.className="highlightAnnotation",this.container)}}class H extends A{constructor(a){var E,C,d;const l=!!(a.data.hasPopup||(E=a.data.titleObj)!=null&&E.str||(C=a.data.contentsObj)!=null&&C.str||(d=a.data.richText)!=null&&d.str);super(a,{isRenderable:l,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("underlineAnnotation"):(this.container.className="underlineAnnotation",this.container)}}class G extends A{constructor(a){var E,C,d;const l=!!(a.data.hasPopup||(E=a.data.titleObj)!=null&&E.str||(C=a.data.contentsObj)!=null&&C.str||(d=a.data.richText)!=null&&d.str);super(a,{isRenderable:l,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.className="squigglyAnnotation",this.container)}}class st extends A{constructor(a){var E,C,d;const l=!!(a.data.hasPopup||(E=a.data.titleObj)!=null&&E.str||(C=a.data.contentsObj)!=null&&C.str||(d=a.data.richText)!=null&&d.str);super(a,{isRenderable:l,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.className="strikeoutAnnotation",this.container)}}class ht extends A{constructor(a){var E,C,d;const l=!!(a.data.hasPopup||(E=a.data.titleObj)!=null&&E.str||(C=a.data.contentsObj)!=null&&C.str||(d=a.data.richText)!=null&&d.str);super(a,{isRenderable:l,ignoreBorder:!0})}render(){return this.container.className="stampAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class M extends A{constructor(a){var C;super(a,{isRenderable:!0});const{filename:l,content:E}=this.data.file;this.filename=(0,w.getFilenameFromUrl)(l,!0),this.content=E,(C=this.linkService.eventBus)==null||C.dispatch("fileattachmentannotation",{source:this,filename:l,content:E})}render(){var l,E;this.container.className="fileAttachmentAnnotation";let a;return this.data.hasAppearance?a=document.createElement("div"):(a=document.createElement("img"),a.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(this.data.name)?"paperclip":"pushpin"}.svg`),a.className="popupTriggerArea",a.addEventListener("dblclick",this._download.bind(this)),!this.data.hasPopup&&((l=this.data.titleObj)!=null&&l.str||(E=this.data.contentsObj)!=null&&E.str||this.data.richText)&&this._createPopup(a,this.data),this.container.append(a),this.container}_download(){var a;(a=this.downloadManager)==null||a.openOrDownloadData(this.container,this.content,this.filename)}}const nt=class nt{static render(a){var j,Z;const{annotations:l,div:E,viewport:C,accessibilityManager:d}=a;(0,w.setLayerDimensions)(E,C);const F={data:null,layer:E,page:a.page,viewport:C,linkService:a.linkService,downloadManager:a.downloadManager,imageResourcesPath:a.imageResourcesPath||"",renderForms:a.renderForms!==!1,svgFactory:new w.DOMSVGFactory,annotationStorage:a.annotationStorage||new Y.AnnotationStorage,enableScripting:a.enableScripting===!0,hasJSActions:a.hasJSActions,fieldObjects:a.fieldObjects};let N=0;for(const x of l){if(x.annotationType!==b.AnnotationType.POPUP){const{width:it,height:dt}=L(x.rect);if(it<=0||dt<=0)continue}F.data=x;const U=T.create(F);if(!U.isRenderable)continue;const I=U.render();if(x.hidden&&(I.style.visibility="hidden"),Array.isArray(I))for(const it of I)it.style.zIndex=N++,lt(j=nt,k,be).call(j,it,x.id,E,d);else I.style.zIndex=N++,U instanceof s?E.prepend(I):lt(Z=nt,k,be).call(Z,I,x.id,E,d)}lt(this,k,_e).call(this,E,a.annotationCanvasMap)}static update(a){const{annotationCanvasMap:l,div:E,viewport:C}=a;(0,w.setLayerDimensions)(E,{rotation:C.rotation}),lt(this,k,_e).call(this,E,l),E.hidden=!1}};k=new WeakSet,be=function(a,l,E,C){const d=a.firstChild||a;d.id=`${w.AnnotationPrefix}${l}`,E.append(a),C==null||C.moveElementInDOM(E,a,d,!1)},_e=function(a,l){if(l){for(const[E,C]of l){const d=a.querySelector(`[data-annotation-id="${E}"]`);if(!d)continue;const{firstChild:F}=d;F?F.nodeName==="CANVAS"?F.replaceWith(C):F.before(C):d.append(C)}l.clear()}},ut(nt,k);let h=nt;m.AnnotationLayer=h},(ot,m)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.ColorConverters=void 0;function Q(w){return Math.floor(Math.max(0,Math.min(1,w))*255).toString(16).padStart(2,"0")}class b{static CMYK_G([Y,z,et,B]){return["G",1-Math.min(1,.3*Y+.59*et+.11*z+B)]}static G_CMYK([Y]){return["CMYK",0,0,0,1-Y]}static G_RGB([Y]){return["RGB",Y,Y,Y]}static G_HTML([Y]){const z=Q(Y);return`#${z}${z}${z}`}static RGB_G([Y,z,et]){return["G",.3*Y+.59*z+.11*et]}static RGB_HTML([Y,z,et]){const B=Q(Y),S=Q(z),P=Q(et);return`#${B}${S}${P}`}static T_HTML(){return"#00000000"}static CMYK_RGB([Y,z,et,B]){return["RGB",1-Math.min(1,Y+B),1-Math.min(1,et+B),1-Math.min(1,z+B)]}static CMYK_HTML(Y){const z=this.CMYK_RGB(Y).slice(1);return this.RGB_HTML(z)}static RGB_CMYK([Y,z,et]){const B=1-Y,S=1-z,P=1-et,L=Math.min(B,S,P);return["CMYK",B,S,P,L]}}m.ColorConverters=b},(ot,m,Q)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.XfaLayer=void 0;var b=Q(19);class w{static setupStorage(z,et,B,S,P){const L=S.getValue(et,{value:null});switch(B.name){case"textarea":if(L.value!==null&&(z.textContent=L.value),P==="print")break;z.addEventListener("input",T=>{S.setValue(et,{value:T.target.value})});break;case"input":if(B.attributes.type==="radio"||B.attributes.type==="checkbox"){if(L.value===B.attributes.xfaOn?z.setAttribute("checked",!0):L.value===B.attributes.xfaOff&&z.removeAttribute("checked"),P==="print")break;z.addEventListener("change",T=>{S.setValue(et,{value:T.target.checked?T.target.getAttribute("xfaOn"):T.target.getAttribute("xfaOff")})})}else{if(L.value!==null&&z.setAttribute("value",L.value),P==="print")break;z.addEventListener("input",T=>{S.setValue(et,{value:T.target.value})})}break;case"select":if(L.value!==null)for(const T of B.children)T.attributes.value===L.value&&(T.attributes.selected=!0);z.addEventListener("input",T=>{const A=T.target.options,g=A.selectedIndex===-1?"":A[A.selectedIndex].value;S.setValue(et,{value:g})});break}}static setAttributes({html:z,element:et,storage:B=null,intent:S,linkService:P}){const{attributes:L}=et,T=z instanceof HTMLAnchorElement;L.type==="radio"&&(L.name=`${L.name}-${S}`);for(const[A,g]of Object.entries(L))if(g!=null)switch(A){case"class":g.length&&z.setAttribute(A,g.join(" "));break;case"dataId":break;case"id":z.setAttribute("data-element-id",g);break;case"style":Object.assign(z.style,g);break;case"textContent":z.textContent=g;break;default:(!T||A!=="href"&&A!=="newWindow")&&z.setAttribute(A,g)}T&&P.addLinkAttributes(z,L.href,L.newWindow),B&&L.dataId&&this.setupStorage(z,L.dataId,et,B)}static render(z){var f;const et=z.annotationStorage,B=z.linkService,S=z.xfaHtml,P=z.intent||"display",L=document.createElement(S.name);S.attributes&&this.setAttributes({html:L,element:S,intent:P,linkService:B});const T=[[S,-1,L]],A=z.div;if(A.append(L),z.viewport){const r=`matrix(${z.viewport.transform.join(",")})`;A.style.transform=r}P!=="richText"&&A.setAttribute("class","xfaLayer xfaFont");const g=[];for(;T.length>0;){const[r,c,u]=T.at(-1);if(c+1===r.children.length){T.pop();continue}const i=r.children[++T.at(-1)[1]];if(i===null)continue;const{name:n}=i;if(n==="#text"){const s=document.createTextNode(i.value);g.push(s),u.append(s);continue}let t;if((f=i==null?void 0:i.attributes)!=null&&f.xmlns?t=document.createElementNS(i.attributes.xmlns,n):t=document.createElement(n),u.append(t),i.attributes&&this.setAttributes({html:t,element:i,storage:et,intent:P,linkService:B}),i.children&&i.children.length>0)T.push([i,-1,t]);else if(i.value){const s=document.createTextNode(i.value);b.XfaText.shouldBuildText(n)&&g.push(s),t.append(s)}}for(const r of A.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))r.setAttribute("readOnly",!0);return{textDivs:g}}static update(z){const et=`matrix(${z.viewport.transform.join(",")})`;z.div.style.transform=et,z.div.hidden=!1}}m.XfaLayer=w},(ot,m,Q)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.SVGGraphics=void 0;var b=Q(6),w=Q(1),Y=Q(10);let z=class{constructor(){(0,w.unreachable)("Not implemented: SVGGraphics")}};m.SVGGraphics=z;{let f=function(t){let s=[];const p=[];for(const e of t){if(e.fn==="save"){s.push({fnId:92,fn:"group",items:[]}),p.push(s),s=s.at(-1).items;continue}e.fn==="restore"?s=p.pop():s.push(e)}return s},r=function(t){if(Number.isInteger(t))return t.toString();const s=t.toFixed(10);let p=s.length-1;if(s[p]!=="0")return s;do p--;while(s[p]==="0");return s.substring(0,s[p]==="."?p:p+1)},c=function(t){if(t[4]===0&&t[5]===0){if(t[1]===0&&t[2]===0)return t[0]===1&&t[3]===1?"":`scale(${r(t[0])} ${r(t[3])})`;if(t[0]===t[3]&&t[1]===-t[2]){const s=Math.acos(t[0])*180/Math.PI;return`rotate(${r(s)})`}}else if(t[0]===1&&t[1]===0&&t[2]===0&&t[3]===1)return`translate(${r(t[4])} ${r(t[5])})`;return`matrix(${r(t[0])} ${r(t[1])} ${r(t[2])} ${r(t[3])} ${r(t[4])} ${r(t[5])})`};const et={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},B="http://www.w3.org/XML/1998/namespace",S="http://www.w3.org/1999/xlink",P=["butt","round","square"],L=["miter","round","bevel"],T=function(t,s="",p=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!p)return URL.createObjectURL(new Blob([t],{type:s}));const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let y=`data:${s};base64,`;for(let O=0,W=t.length;O<W;O+=3){const tt=t[O]&255,gt=t[O+1]&255,rt=t[O+2]&255,ct=tt>>2,K=(tt&3)<<4|gt>>4,H=O+1<W?(gt&15)<<2|rt>>6:64,G=O+2<W?rt&63:64;y+=e[ct]+e[K]+e[H]+e[G]}return y},A=function(){const t=new Uint8Array([137,80,78,71,13,10,26,10]),s=12,p=new Int32Array(256);for(let rt=0;rt<256;rt++){let ct=rt;for(let K=0;K<8;K++)ct&1?ct=3988292384^ct>>1&2147483647:ct=ct>>1&2147483647;p[rt]=ct}function e(rt,ct,K){let H=-1;for(let G=ct;G<K;G++){const st=(H^rt[G])&255,ht=p[st];H=H>>>8^ht}return H^-1}function y(rt,ct,K,H){let G=H;const st=ct.length;K[G]=st>>24&255,K[G+1]=st>>16&255,K[G+2]=st>>8&255,K[G+3]=st&255,G+=4,K[G]=rt.charCodeAt(0)&255,K[G+1]=rt.charCodeAt(1)&255,K[G+2]=rt.charCodeAt(2)&255,K[G+3]=rt.charCodeAt(3)&255,G+=4,K.set(ct,G),G+=ct.length;const ht=e(K,H+4,G);K[G]=ht>>24&255,K[G+1]=ht>>16&255,K[G+2]=ht>>8&255,K[G+3]=ht&255}function O(rt,ct,K){let H=1,G=0;for(let st=ct;st<K;++st)H=(H+(rt[st]&255))%65521,G=(G+H)%65521;return G<<16|H}function W(rt){if(!Y.isNodeJS)return tt(rt);try{let ct;parseInt(process.versions.node)>=8?ct=rt:ct=Buffer.from(rt);const K=require$$5.deflateSync(ct,{level:9});return K instanceof Uint8Array?K:new Uint8Array(K)}catch(ct){(0,w.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+ct)}return tt(rt)}function tt(rt){let ct=rt.length;const K=65535,H=Math.ceil(ct/K),G=new Uint8Array(2+ct+H*5+4);let st=0;G[st++]=120,G[st++]=156;let ht=0;for(;ct>K;)G[st++]=0,G[st++]=255,G[st++]=255,G[st++]=0,G[st++]=0,G.set(rt.subarray(ht,ht+K),st),st+=K,ht+=K,ct-=K;G[st++]=1,G[st++]=ct&255,G[st++]=ct>>8&255,G[st++]=~ct&65535&255,G[st++]=(~ct&65535)>>8&255,G.set(rt.subarray(ht),st),st+=rt.length-ht;const M=O(rt,0,rt.length);return G[st++]=M>>24&255,G[st++]=M>>16&255,G[st++]=M>>8&255,G[st++]=M&255,G}function gt(rt,ct,K,H){const G=rt.width,st=rt.height;let ht,M,h;const o=rt.data;switch(ct){case w.ImageKind.GRAYSCALE_1BPP:M=0,ht=1,h=G+7>>3;break;case w.ImageKind.RGB_24BPP:M=2,ht=8,h=G*3;break;case w.ImageKind.RGBA_32BPP:M=6,ht=8,h=G*4;break;default:throw new Error("invalid format")}const v=new Uint8Array((1+h)*st);let R=0,D=0;for(let a=0;a<st;++a)v[R++]=0,v.set(o.subarray(D,D+h),R),D+=h,R+=h;if(ct===w.ImageKind.GRAYSCALE_1BPP&&H){R=0;for(let a=0;a<st;a++){R++;for(let l=0;l<h;l++)v[R++]^=255}}const k=new Uint8Array([G>>24&255,G>>16&255,G>>8&255,G&255,st>>24&255,st>>16&255,st>>8&255,st&255,ht,M,0,0,0]),q=W(v),J=t.length+s*3+k.length+q.length,nt=new Uint8Array(J);let $=0;return nt.set(t,$),$+=t.length,y("IHDR",k,nt,$),$+=s+k.length,y("IDATA",q,nt,$),$+=s+q.length,y("IEND",new Uint8Array(0),nt,$),T(nt,"image/png",K)}return function(ct,K,H){const G=ct.kind===void 0?w.ImageKind.GRAYSCALE_1BPP:ct.kind;return gt(ct,G,K,H)}}();class g{constructor(){this.fontSizeScale=1,this.fontWeight=et.fontWeight,this.fontSize=0,this.textMatrix=w.IDENTITY_MATRIX,this.fontMatrix=w.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=w.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=et.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(s,p){this.x=s,this.y=p}}let u=0,i=0,n=0;m.SVGGraphics=z=class{constructor(t,s,p=!1){(0,b.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new b.DOMSVGFactory,this.current=new g,this.transformMatrix=w.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=t,this.objs=s,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!p,this._operatorIdMapping=[];for(const e in w.OPS)this._operatorIdMapping[w.OPS[e]]=e}getObject(t,s=null){return typeof t=="string"?t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t):s}save(){this.transformStack.push(this.transformMatrix);const t=this.current;this.extraStack.push(t),this.current=t.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(t){this.save(),this.executeOpTree(t),this.restore()}loadDependencies(t){const s=t.fnArray,p=t.argsArray;for(let e=0,y=s.length;e<y;e++)if(s[e]===w.OPS.dependency)for(const O of p[e]){const W=O.startsWith("g_")?this.commonObjs:this.objs,tt=new Promise(gt=>{W.get(O,gt)});this.current.dependencies.push(tt)}return Promise.all(this.current.dependencies)}transform(t,s,p,e,y,O){const W=[t,s,p,e,y,O];this.transformMatrix=w.Util.transform(this.transformMatrix,W),this.tgrp=null}getSVG(t,s){this.viewport=s;const p=this._initialize(s);return this.loadDependencies(t).then(()=>(this.transformMatrix=w.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(t)),p))}convertOpList(t){const s=this._operatorIdMapping,p=t.argsArray,e=t.fnArray,y=[];for(let O=0,W=e.length;O<W;O++){const tt=e[O];y.push({fnId:tt,fn:s[tt],args:p[O]})}return f(y)}executeOpTree(t){for(const s of t){const p=s.fn,e=s.fnId,y=s.args;switch(e|0){case w.OPS.beginText:this.beginText();break;case w.OPS.dependency:break;case w.OPS.setLeading:this.setLeading(y);break;case w.OPS.setLeadingMoveText:this.setLeadingMoveText(y[0],y[1]);break;case w.OPS.setFont:this.setFont(y);break;case w.OPS.showText:this.showText(y[0]);break;case w.OPS.showSpacedText:this.showText(y[0]);break;case w.OPS.endText:this.endText();break;case w.OPS.moveText:this.moveText(y[0],y[1]);break;case w.OPS.setCharSpacing:this.setCharSpacing(y[0]);break;case w.OPS.setWordSpacing:this.setWordSpacing(y[0]);break;case w.OPS.setHScale:this.setHScale(y[0]);break;case w.OPS.setTextMatrix:this.setTextMatrix(y[0],y[1],y[2],y[3],y[4],y[5]);break;case w.OPS.setTextRise:this.setTextRise(y[0]);break;case w.OPS.setTextRenderingMode:this.setTextRenderingMode(y[0]);break;case w.OPS.setLineWidth:this.setLineWidth(y[0]);break;case w.OPS.setLineJoin:this.setLineJoin(y[0]);break;case w.OPS.setLineCap:this.setLineCap(y[0]);break;case w.OPS.setMiterLimit:this.setMiterLimit(y[0]);break;case w.OPS.setFillRGBColor:this.setFillRGBColor(y[0],y[1],y[2]);break;case w.OPS.setStrokeRGBColor:this.setStrokeRGBColor(y[0],y[1],y[2]);break;case w.OPS.setStrokeColorN:this.setStrokeColorN(y);break;case w.OPS.setFillColorN:this.setFillColorN(y);break;case w.OPS.shadingFill:this.shadingFill(y[0]);break;case w.OPS.setDash:this.setDash(y[0],y[1]);break;case w.OPS.setRenderingIntent:this.setRenderingIntent(y[0]);break;case w.OPS.setFlatness:this.setFlatness(y[0]);break;case w.OPS.setGState:this.setGState(y[0]);break;case w.OPS.fill:this.fill();break;case w.OPS.eoFill:this.eoFill();break;case w.OPS.stroke:this.stroke();break;case w.OPS.fillStroke:this.fillStroke();break;case w.OPS.eoFillStroke:this.eoFillStroke();break;case w.OPS.clip:this.clip("nonzero");break;case w.OPS.eoClip:this.clip("evenodd");break;case w.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case w.OPS.paintImageXObject:this.paintImageXObject(y[0]);break;case w.OPS.paintInlineImageXObject:this.paintInlineImageXObject(y[0]);break;case w.OPS.paintImageMaskXObject:this.paintImageMaskXObject(y[0]);break;case w.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(y[0],y[1]);break;case w.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case w.OPS.closePath:this.closePath();break;case w.OPS.closeStroke:this.closeStroke();break;case w.OPS.closeFillStroke:this.closeFillStroke();break;case w.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case w.OPS.nextLine:this.nextLine();break;case w.OPS.transform:this.transform(y[0],y[1],y[2],y[3],y[4],y[5]);break;case w.OPS.constructPath:this.constructPath(y[0],y[1]);break;case w.OPS.endPath:this.endPath();break;case 92:this.group(s.items);break;default:(0,w.warn)(`Unimplemented operator ${p}`);break}}}setWordSpacing(t){this.current.wordSpacing=t}setCharSpacing(t){this.current.charSpacing=t}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(t,s,p,e,y,O){const W=this.current;W.textMatrix=W.lineMatrix=[t,s,p,e,y,O],W.textMatrixScale=Math.hypot(t,s),W.x=W.lineX=0,W.y=W.lineY=0,W.xcoords=[],W.ycoords=[],W.tspan=this.svgFactory.createElement("svg:tspan"),W.tspan.setAttributeNS(null,"font-family",W.fontFamily),W.tspan.setAttributeNS(null,"font-size",`${r(W.fontSize)}px`),W.tspan.setAttributeNS(null,"y",r(-W.y)),W.txtElement=this.svgFactory.createElement("svg:text"),W.txtElement.append(W.tspan)}beginText(){const t=this.current;t.x=t.lineX=0,t.y=t.lineY=0,t.textMatrix=w.IDENTITY_MATRIX,t.lineMatrix=w.IDENTITY_MATRIX,t.textMatrixScale=1,t.tspan=this.svgFactory.createElement("svg:tspan"),t.txtElement=this.svgFactory.createElement("svg:text"),t.txtgrp=this.svgFactory.createElement("svg:g"),t.xcoords=[],t.ycoords=[]}moveText(t,s){const p=this.current;p.x=p.lineX+=t,p.y=p.lineY+=s,p.xcoords=[],p.ycoords=[],p.tspan=this.svgFactory.createElement("svg:tspan"),p.tspan.setAttributeNS(null,"font-family",p.fontFamily),p.tspan.setAttributeNS(null,"font-size",`${r(p.fontSize)}px`),p.tspan.setAttributeNS(null,"y",r(-p.y))}showText(t){const s=this.current,p=s.font,e=s.fontSize;if(e===0)return;const y=s.fontSizeScale,O=s.charSpacing,W=s.wordSpacing,tt=s.fontDirection,gt=s.textHScale*tt,rt=p.vertical,ct=rt?1:-1,K=p.defaultVMetrics,H=e*s.fontMatrix[0];let G=0;for(const M of t){if(M===null){G+=tt*W;continue}else if(typeof M=="number"){G+=ct*M*e/1e3;continue}const h=(M.isSpace?W:0)+O,o=M.fontChar;let v,R,D=M.width;if(rt){let q;const J=M.vmetric||K;q=M.vmetric?J[1]:D*.5,q=-q*H;const nt=J[2]*H;D=J?-J[0]:D,v=q/y,R=(G+nt)/y}else v=G/y,R=0;(M.isInFont||p.missingFile)&&(s.xcoords.push(s.x+v),rt&&s.ycoords.push(-s.y+R),s.tspan.textContent+=o);let k;rt?k=D*H-h*tt:k=D*H+h*tt,G+=k}s.tspan.setAttributeNS(null,"x",s.xcoords.map(r).join(" ")),rt?s.tspan.setAttributeNS(null,"y",s.ycoords.map(r).join(" ")):s.tspan.setAttributeNS(null,"y",r(-s.y)),rt?s.y-=G:s.x+=G*gt,s.tspan.setAttributeNS(null,"font-family",s.fontFamily),s.tspan.setAttributeNS(null,"font-size",`${r(s.fontSize)}px`),s.fontStyle!==et.fontStyle&&s.tspan.setAttributeNS(null,"font-style",s.fontStyle),s.fontWeight!==et.fontWeight&&s.tspan.setAttributeNS(null,"font-weight",s.fontWeight);const st=s.textRenderingMode&w.TextRenderingMode.FILL_STROKE_MASK;if(st===w.TextRenderingMode.FILL||st===w.TextRenderingMode.FILL_STROKE?(s.fillColor!==et.fillColor&&s.tspan.setAttributeNS(null,"fill",s.fillColor),s.fillAlpha<1&&s.tspan.setAttributeNS(null,"fill-opacity",s.fillAlpha)):s.textRenderingMode===w.TextRenderingMode.ADD_TO_PATH?s.tspan.setAttributeNS(null,"fill","transparent"):s.tspan.setAttributeNS(null,"fill","none"),st===w.TextRenderingMode.STROKE||st===w.TextRenderingMode.FILL_STROKE){const M=1/(s.textMatrixScale||1);this._setStrokeAttributes(s.tspan,M)}let ht=s.textMatrix;s.textRise!==0&&(ht=ht.slice(),ht[5]+=s.textRise),s.txtElement.setAttributeNS(null,"transform",`${c(ht)} scale(${r(gt)}, -1)`),s.txtElement.setAttributeNS(B,"xml:space","preserve"),s.txtElement.append(s.tspan),s.txtgrp.append(s.txtElement),this._ensureTransformGroup().append(s.txtElement)}setLeadingMoveText(t,s){this.setLeading(-s),this.moveText(t,s)}addFontStyle(t){if(!t.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const s=T(t.data,t.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${t.loadedName}"; src: url(${s}); }
`}setFont(t){const s=this.current,p=this.commonObjs.get(t[0]);let e=t[1];s.font=p,this.embedFonts&&!p.missingFile&&!this.embeddedFonts[p.loadedName]&&(this.addFontStyle(p),this.embeddedFonts[p.loadedName]=p),s.fontMatrix=p.fontMatrix||w.FONT_IDENTITY_MATRIX;let y="normal";p.black?y="900":p.bold&&(y="bold");const O=p.italic?"italic":"normal";e<0?(e=-e,s.fontDirection=-1):s.fontDirection=1,s.fontSize=e,s.fontFamily=p.loadedName,s.fontWeight=y,s.fontStyle=O,s.tspan=this.svgFactory.createElement("svg:tspan"),s.tspan.setAttributeNS(null,"y",r(-s.y)),s.xcoords=[],s.ycoords=[]}endText(){var s;const t=this.current;t.textRenderingMode&w.TextRenderingMode.ADD_TO_PATH_FLAG&&((s=t.txtElement)!=null&&s.hasChildNodes())&&(t.element=t.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(t){t>0&&(this.current.lineWidth=t)}setLineCap(t){this.current.lineCap=P[t]}setLineJoin(t){this.current.lineJoin=L[t]}setMiterLimit(t){this.current.miterLimit=t}setStrokeAlpha(t){this.current.strokeAlpha=t}setStrokeRGBColor(t,s,p){this.current.strokeColor=w.Util.makeHexColor(t,s,p)}setFillAlpha(t){this.current.fillAlpha=t}setFillRGBColor(t,s,p){this.current.fillColor=w.Util.makeHexColor(t,s,p),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(t){this.current.strokeColor=this._makeColorN_Pattern(t)}setFillColorN(t){this.current.fillColor=this._makeColorN_Pattern(t)}shadingFill(t){const s=this.viewport.width,p=this.viewport.height,e=w.Util.inverseTransform(this.transformMatrix),y=w.Util.applyTransform([0,0],e),O=w.Util.applyTransform([0,p],e),W=w.Util.applyTransform([s,0],e),tt=w.Util.applyTransform([s,p],e),gt=Math.min(y[0],O[0],W[0],tt[0]),rt=Math.min(y[1],O[1],W[1],tt[1]),ct=Math.max(y[0],O[0],W[0],tt[0]),K=Math.max(y[1],O[1],W[1],tt[1]),H=this.svgFactory.createElement("svg:rect");H.setAttributeNS(null,"x",gt),H.setAttributeNS(null,"y",rt),H.setAttributeNS(null,"width",ct-gt),H.setAttributeNS(null,"height",K-rt),H.setAttributeNS(null,"fill",this._makeShadingPattern(t)),this.current.fillAlpha<1&&H.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(H)}_makeColorN_Pattern(t){return t[0]==="TilingPattern"?this._makeTilingPattern(t):this._makeShadingPattern(t)}_makeTilingPattern(t){const s=t[1],p=t[2],e=t[3]||w.IDENTITY_MATRIX,[y,O,W,tt]=t[4],gt=t[5],rt=t[6],ct=t[7],K=`shading${n++}`,[H,G,st,ht]=w.Util.normalizeRect([...w.Util.applyTransform([y,O],e),...w.Util.applyTransform([W,tt],e)]),[M,h]=w.Util.singularValueDecompose2dScale(e),o=gt*M,v=rt*h,R=this.svgFactory.createElement("svg:pattern");R.setAttributeNS(null,"id",K),R.setAttributeNS(null,"patternUnits","userSpaceOnUse"),R.setAttributeNS(null,"width",o),R.setAttributeNS(null,"height",v),R.setAttributeNS(null,"x",`${H}`),R.setAttributeNS(null,"y",`${G}`);const D=this.svg,k=this.transformMatrix,q=this.current.fillColor,J=this.current.strokeColor,nt=this.svgFactory.create(st-H,ht-G);if(this.svg=nt,this.transformMatrix=e,ct===2){const $=w.Util.makeHexColor(...s);this.current.fillColor=$,this.current.strokeColor=$}return this.executeOpTree(this.convertOpList(p)),this.svg=D,this.transformMatrix=k,this.current.fillColor=q,this.current.strokeColor=J,R.append(nt.childNodes[0]),this.defs.append(R),`url(#${K})`}_makeShadingPattern(t){switch(typeof t=="string"&&(t=this.objs.get(t)),t[0]){case"RadialAxial":const s=`shading${n++}`,p=t[3];let e;switch(t[1]){case"axial":const y=t[4],O=t[5];e=this.svgFactory.createElement("svg:linearGradient"),e.setAttributeNS(null,"id",s),e.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),e.setAttributeNS(null,"x1",y[0]),e.setAttributeNS(null,"y1",y[1]),e.setAttributeNS(null,"x2",O[0]),e.setAttributeNS(null,"y2",O[1]);break;case"radial":const W=t[4],tt=t[5],gt=t[6],rt=t[7];e=this.svgFactory.createElement("svg:radialGradient"),e.setAttributeNS(null,"id",s),e.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),e.setAttributeNS(null,"cx",tt[0]),e.setAttributeNS(null,"cy",tt[1]),e.setAttributeNS(null,"r",rt),e.setAttributeNS(null,"fx",W[0]),e.setAttributeNS(null,"fy",W[1]),e.setAttributeNS(null,"fr",gt);break;default:throw new Error(`Unknown RadialAxial type: ${t[1]}`)}for(const y of p){const O=this.svgFactory.createElement("svg:stop");O.setAttributeNS(null,"offset",y[0]),O.setAttributeNS(null,"stop-color",y[1]),e.append(O)}return this.defs.append(e),`url(#${s})`;case"Mesh":return(0,w.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${t[0]}`)}}setDash(t,s){this.current.dashArray=t,this.current.dashPhase=s}constructPath(t,s){const p=this.current;let e=p.x,y=p.y,O=[],W=0;for(const tt of t)switch(tt|0){case w.OPS.rectangle:e=s[W++],y=s[W++];const gt=s[W++],rt=s[W++],ct=e+gt,K=y+rt;O.push("M",r(e),r(y),"L",r(ct),r(y),"L",r(ct),r(K),"L",r(e),r(K),"Z");break;case w.OPS.moveTo:e=s[W++],y=s[W++],O.push("M",r(e),r(y));break;case w.OPS.lineTo:e=s[W++],y=s[W++],O.push("L",r(e),r(y));break;case w.OPS.curveTo:e=s[W+4],y=s[W+5],O.push("C",r(s[W]),r(s[W+1]),r(s[W+2]),r(s[W+3]),r(e),r(y)),W+=6;break;case w.OPS.curveTo2:O.push("C",r(e),r(y),r(s[W]),r(s[W+1]),r(s[W+2]),r(s[W+3])),e=s[W+2],y=s[W+3],W+=4;break;case w.OPS.curveTo3:e=s[W+2],y=s[W+3],O.push("C",r(s[W]),r(s[W+1]),r(e),r(y),r(e),r(y)),W+=4;break;case w.OPS.closePath:O.push("Z");break}O=O.join(" "),p.path&&t.length>0&&t[0]!==w.OPS.rectangle&&t[0]!==w.OPS.moveTo?O=p.path.getAttributeNS(null,"d")+O:(p.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(p.path)),p.path.setAttributeNS(null,"d",O),p.path.setAttributeNS(null,"fill","none"),p.element=p.path,p.setCurrentPoint(e,y)}endPath(){const t=this.current;if(t.path=null,!this.pendingClip)return;if(!t.element){this.pendingClip=null;return}const s=`clippath${u++}`,p=this.svgFactory.createElement("svg:clipPath");p.setAttributeNS(null,"id",s),p.setAttributeNS(null,"transform",c(this.transformMatrix));const e=t.element.cloneNode(!0);if(this.pendingClip==="evenodd"?e.setAttributeNS(null,"clip-rule","evenodd"):e.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,p.append(e),this.defs.append(p),t.activeClipUrl){t.clipGroup=null;for(const y of this.extraStack)y.clipGroup=null;p.setAttributeNS(null,"clip-path",t.activeClipUrl)}t.activeClipUrl=`url(#${s})`,this.tgrp=null}clip(t){this.pendingClip=t}closePath(){const t=this.current;if(t.path){const s=`${t.path.getAttributeNS(null,"d")}Z`;t.path.setAttributeNS(null,"d",s)}}setLeading(t){this.current.leading=-t}setTextRise(t){this.current.textRise=t}setTextRenderingMode(t){this.current.textRenderingMode=t}setHScale(t){this.current.textHScale=t/100}setRenderingIntent(t){}setFlatness(t){}setGState(t){for(const[s,p]of t)switch(s){case"LW":this.setLineWidth(p);break;case"LC":this.setLineCap(p);break;case"LJ":this.setLineJoin(p);break;case"ML":this.setMiterLimit(p);break;case"D":this.setDash(p[0],p[1]);break;case"RI":this.setRenderingIntent(p);break;case"FL":this.setFlatness(p);break;case"Font":this.setFont(p);break;case"CA":this.setStrokeAlpha(p);break;case"ca":this.setFillAlpha(p);break;default:(0,w.warn)(`Unimplemented graphic state operator ${s}`);break}}fill(){const t=this.current;t.element&&(t.element.setAttributeNS(null,"fill",t.fillColor),t.element.setAttributeNS(null,"fill-opacity",t.fillAlpha),this.endPath())}stroke(){const t=this.current;t.element&&(this._setStrokeAttributes(t.element),t.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(t,s=1){const p=this.current;let e=p.dashArray;s!==1&&e.length>0&&(e=e.map(function(y){return s*y})),t.setAttributeNS(null,"stroke",p.strokeColor),t.setAttributeNS(null,"stroke-opacity",p.strokeAlpha),t.setAttributeNS(null,"stroke-miterlimit",r(p.miterLimit)),t.setAttributeNS(null,"stroke-linecap",p.lineCap),t.setAttributeNS(null,"stroke-linejoin",p.lineJoin),t.setAttributeNS(null,"stroke-width",r(s*p.lineWidth)+"px"),t.setAttributeNS(null,"stroke-dasharray",e.map(r).join(" ")),t.setAttributeNS(null,"stroke-dashoffset",r(s*p.dashPhase)+"px")}eoFill(){var t;(t=this.current.element)==null||t.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){var t;(t=this.current.element)==null||t.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const t=this.svgFactory.createElement("svg:rect");t.setAttributeNS(null,"x","0"),t.setAttributeNS(null,"y","0"),t.setAttributeNS(null,"width","1px"),t.setAttributeNS(null,"height","1px"),t.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(t)}paintImageXObject(t){const s=this.getObject(t);if(!s){(0,w.warn)(`Dependent image with object ID ${t} is not ready yet`);return}this.paintInlineImageXObject(s)}paintInlineImageXObject(t,s){const p=t.width,e=t.height,y=A(t,this.forceDataSchema,!!s),O=this.svgFactory.createElement("svg:rect");O.setAttributeNS(null,"x","0"),O.setAttributeNS(null,"y","0"),O.setAttributeNS(null,"width",r(p)),O.setAttributeNS(null,"height",r(e)),this.current.element=O,this.clip("nonzero");const W=this.svgFactory.createElement("svg:image");W.setAttributeNS(S,"xlink:href",y),W.setAttributeNS(null,"x","0"),W.setAttributeNS(null,"y",r(-e)),W.setAttributeNS(null,"width",r(p)+"px"),W.setAttributeNS(null,"height",r(e)+"px"),W.setAttributeNS(null,"transform",`scale(${r(1/p)} ${r(-1/e)})`),s?s.append(W):this._ensureTransformGroup().append(W)}paintImageMaskXObject(t){const s=this.getObject(t.data,t);if(s.bitmap){(0,w.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const p=this.current,e=s.width,y=s.height,O=p.fillColor;p.maskId=`mask${i++}`;const W=this.svgFactory.createElement("svg:mask");W.setAttributeNS(null,"id",p.maskId);const tt=this.svgFactory.createElement("svg:rect");tt.setAttributeNS(null,"x","0"),tt.setAttributeNS(null,"y","0"),tt.setAttributeNS(null,"width",r(e)),tt.setAttributeNS(null,"height",r(y)),tt.setAttributeNS(null,"fill",O),tt.setAttributeNS(null,"mask",`url(#${p.maskId})`),this.defs.append(W),this._ensureTransformGroup().append(tt),this.paintInlineImageXObject(s,W)}paintFormXObjectBegin(t,s){if(Array.isArray(t)&&t.length===6&&this.transform(t[0],t[1],t[2],t[3],t[4],t[5]),s){const p=s[2]-s[0],e=s[3]-s[1],y=this.svgFactory.createElement("svg:rect");y.setAttributeNS(null,"x",s[0]),y.setAttributeNS(null,"y",s[1]),y.setAttributeNS(null,"width",r(p)),y.setAttributeNS(null,"height",r(e)),this.current.element=y,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(t){const s=this.svgFactory.create(t.width,t.height),p=this.svgFactory.createElement("svg:defs");s.append(p),this.defs=p;const e=this.svgFactory.createElement("svg:g");return e.setAttributeNS(null,"transform",c(t.transform)),s.append(e),this.svg=e,s}_ensureClipGroup(){if(!this.current.clipGroup){const t=this.svgFactory.createElement("svg:g");t.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(t),this.current.clipGroup=t}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",c(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}}}],__webpack_module_cache__={};function __w_pdfjs_require__(ot){var m=__webpack_module_cache__[ot];if(m!==void 0)return m.exports;var Q=__webpack_module_cache__[ot]={exports:{}};return __webpack_modules__[ot](Q,Q.exports,__w_pdfjs_require__),Q.exports}var __webpack_exports__={};return(()=>{var ot=__webpack_exports__;Object.defineProperty(ot,"__esModule",{value:!0}),Object.defineProperty(ot,"AbortException",{enumerable:!0,get:function(){return m.AbortException}}),Object.defineProperty(ot,"AnnotationEditorLayer",{enumerable:!0,get:function(){return Y.AnnotationEditorLayer}}),Object.defineProperty(ot,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return m.AnnotationEditorParamsType}}),Object.defineProperty(ot,"AnnotationEditorType",{enumerable:!0,get:function(){return m.AnnotationEditorType}}),Object.defineProperty(ot,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return z.AnnotationEditorUIManager}}),Object.defineProperty(ot,"AnnotationLayer",{enumerable:!0,get:function(){return et.AnnotationLayer}}),Object.defineProperty(ot,"AnnotationMode",{enumerable:!0,get:function(){return m.AnnotationMode}}),Object.defineProperty(ot,"CMapCompressionType",{enumerable:!0,get:function(){return m.CMapCompressionType}}),Object.defineProperty(ot,"FeatureTest",{enumerable:!0,get:function(){return m.FeatureTest}}),Object.defineProperty(ot,"GlobalWorkerOptions",{enumerable:!0,get:function(){return B.GlobalWorkerOptions}}),Object.defineProperty(ot,"InvalidPDFException",{enumerable:!0,get:function(){return m.InvalidPDFException}}),Object.defineProperty(ot,"MissingPDFException",{enumerable:!0,get:function(){return m.MissingPDFException}}),Object.defineProperty(ot,"OPS",{enumerable:!0,get:function(){return m.OPS}}),Object.defineProperty(ot,"PDFDataRangeTransport",{enumerable:!0,get:function(){return Q.PDFDataRangeTransport}}),Object.defineProperty(ot,"PDFDateString",{enumerable:!0,get:function(){return b.PDFDateString}}),Object.defineProperty(ot,"PDFWorker",{enumerable:!0,get:function(){return Q.PDFWorker}}),Object.defineProperty(ot,"PasswordResponses",{enumerable:!0,get:function(){return m.PasswordResponses}}),Object.defineProperty(ot,"PermissionFlag",{enumerable:!0,get:function(){return m.PermissionFlag}}),Object.defineProperty(ot,"PixelsPerInch",{enumerable:!0,get:function(){return b.PixelsPerInch}}),Object.defineProperty(ot,"RenderingCancelledException",{enumerable:!0,get:function(){return b.RenderingCancelledException}}),Object.defineProperty(ot,"SVGGraphics",{enumerable:!0,get:function(){return S.SVGGraphics}}),Object.defineProperty(ot,"UNSUPPORTED_FEATURES",{enumerable:!0,get:function(){return m.UNSUPPORTED_FEATURES}}),Object.defineProperty(ot,"UnexpectedResponseException",{enumerable:!0,get:function(){return m.UnexpectedResponseException}}),Object.defineProperty(ot,"Util",{enumerable:!0,get:function(){return m.Util}}),Object.defineProperty(ot,"VerbosityLevel",{enumerable:!0,get:function(){return m.VerbosityLevel}}),Object.defineProperty(ot,"XfaLayer",{enumerable:!0,get:function(){return P.XfaLayer}}),Object.defineProperty(ot,"build",{enumerable:!0,get:function(){return Q.build}}),Object.defineProperty(ot,"createPromiseCapability",{enumerable:!0,get:function(){return m.createPromiseCapability}}),Object.defineProperty(ot,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return m.createValidAbsoluteUrl}}),Object.defineProperty(ot,"getDocument",{enumerable:!0,get:function(){return Q.getDocument}}),Object.defineProperty(ot,"getFilenameFromUrl",{enumerable:!0,get:function(){return b.getFilenameFromUrl}}),Object.defineProperty(ot,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return b.getPdfFilenameFromUrl}}),Object.defineProperty(ot,"getXfaPageViewport",{enumerable:!0,get:function(){return b.getXfaPageViewport}}),Object.defineProperty(ot,"isDataScheme",{enumerable:!0,get:function(){return b.isDataScheme}}),Object.defineProperty(ot,"isPdfFile",{enumerable:!0,get:function(){return b.isPdfFile}}),Object.defineProperty(ot,"loadScript",{enumerable:!0,get:function(){return b.loadScript}}),Object.defineProperty(ot,"renderTextLayer",{enumerable:!0,get:function(){return w.renderTextLayer}}),Object.defineProperty(ot,"setLayerDimensions",{enumerable:!0,get:function(){return b.setLayerDimensions}}),Object.defineProperty(ot,"shadow",{enumerable:!0,get:function(){return m.shadow}}),Object.defineProperty(ot,"updateTextLayer",{enumerable:!0,get:function(){return w.updateTextLayer}}),Object.defineProperty(ot,"version",{enumerable:!0,get:function(){return Q.version}});var m=__w_pdfjs_require__(1),Q=__w_pdfjs_require__(2),b=__w_pdfjs_require__(6),w=__w_pdfjs_require__(26),Y=__w_pdfjs_require__(27),z=__w_pdfjs_require__(5),et=__w_pdfjs_require__(32),B=__w_pdfjs_require__(14),S=__w_pdfjs_require__(35),P=__w_pdfjs_require__(34)})(),__webpack_exports__})())})(pdf$2);var pdfExports=pdf$2.exports;const pdf=getDefaultExportFromCjs(pdfExports),pdf$1=_mergeNamespaces({__proto__:null,default:pdf},[pdfExports]);export{pdf$1 as p};
